<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="canonical" href="https://sigmaexacta.com/vave" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VAVE Analysis Tool - Value Analysis & Value Engineering | Sigma Exacta</title>
    <meta name="description"
        content="Free Online Value Analysis (VAVE) analysis tool to optimize product value by analyzing functions and costs. Improve value index with our interactive Value Analysis and Value Engineering calculator. Export to Excel.">
    <meta name="keywords"
        content="Open source, Free Software, SigmaExacta, VAVE, Value Analysis, Value Engineering, function analysis, cost reduction, value index, product design, engineering tool, free VAVE tool, VA-VE">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="sigma-exacta-icon.jpg" type="image/jpeg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">

    <style>
        /* Estilos específicos de la página VAVE */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #27ae60;
            font-size: 16px;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Nunito', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            color: #333;
            background-color: #f5f7fa;
            line-height: 1.6;
        }

        img {
            max-width: 100%;
            height: auto;
        }

        .main-content-wrapper {
            max-width: 100%;
            margin: 0;
            padding: 0;
            width: 100%;
        }

        .main-header {
            text-align: center;
            padding: 1rem 1.25rem;
            margin-bottom: 0;
            border-bottom: 1px solid #ddd;
            width: 100%;
            box-sizing: border-box;
        }

        .main-header h1 {
            color: #2c3e50;
            font-size: clamp(1.5rem, 4vw, 1.8rem);
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 800;
        }

        .main-header p {
            color: #7f8c8d;
            font-weight: 400;
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
        }

        /* ESTILOS DEL SISTEMA DE PESTAÑAS (WIZARD) - Igual que en pugh.html */
        .tabs-nav {
            display: flex;
            background-color: #f1f5f9;
            border-radius: 8px 8px 0 0;
            overflow-x: auto;
            border-bottom: 2px solid #3498db;
            margin-bottom: 0;
            margin-top: 0;
            scrollbar-width: none;
            -ms-overflow-style: none;
            width: 100%;
        }

        .tabs-nav::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 1rem 1.5rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 700;
            color: #64748b;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            flex: 1;
            justify-content: center;
        }

        .tab-btn:hover {
            background-color: #e2e8f0;
            color: #2c3e50;
        }

        .tab-btn.active {
            background-color: #fff;
            color: #3498db;
            border-bottom-color: #3498db;
            border-radius: 8px 8px 0 0;
            margin-bottom: -2px;
            border-left: 1px solid #e1e5e9;
            border-right: 1px solid #e1e5e9;
            border-top: 1px solid #e1e5e9;
        }

        .tabs-container {
            background: #fff;
            border: 1px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
            position: relative;
            margin-bottom: 2rem;
            box-sizing: border-box;
        }

        .wizard-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        .wizard-tab-content.active {
            display: block;
            width: 100%;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tab-content-wrapper {
            padding: 2rem;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        /* CONTENEDORES DE CONTENIDO - Similar a pugh.html */
        .container {
            background-color: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            box-sizing: border-box;
        }

        .container h2 {
            color: #2c3e50;
            margin-top: 0;
            border-bottom: 2px solid #3498db;
            padding-bottom: 0.6rem;
            font-weight: 800;
        }

        .container p,
        .container ol,
        .container ul {
            line-height: 1.8;
        }

        .container ol,
        .container ul {
            padding-left: 1.25rem;
        }

        /* ESTILOS ESPECÍFICOS DE VAVE DENTRO DE LAS TABS */
        .calculator-section {
            margin-top: 0;
            width: 100%;
        }

        .calculation-block {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.25rem;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            width: 100%;
            box-sizing: border-box;
        }

        .calculation-title {
            font-weight: 800;
            font-size: 1.2em;
            margin-bottom: 1rem;
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 0.6rem;
        }

        label {
            display: block;
            margin-bottom: 0.6rem;
            color: #2c3e50;
            font-weight: 600;
        }

        input[type="text"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            margin-bottom: 1rem;
            transition: border 0.3s, box-shadow 0.3s;
            font-family: 'Nunito', sans-serif;
            box-sizing: border-box;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        textarea:focus,
        select:focus,
        button:focus-visible {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
        }

        button {
            background-color: #3498db;
            color: white;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 1rem;
            transition: background-color 0.3s, box-shadow 0.3s;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
        }

        button:hover {
            background-color: #2980b9;
        }

        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }

        .example-btn {
            background-color: #27ae60;
        }

        .example-btn:hover {
            background-color: #229954;
        }

        .tab-nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
            width: 100%;
            box-sizing: border-box;
        }

        .btn-next-tab {
            background-color: #3498db;
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn-next-tab:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        .btn-next-tab.btn-prev {
            background-color: #95a5a6;
        }

        .btn-next-tab.btn-prev:hover {
            background-color: #7f8c8d;
        }

        .btn-next-tab.btn-success {
            background-color: #27ae60;
        }

        .btn-next-tab.btn-success:hover {
            background-color: #229954;
        }

        /* Estilos específicos del contenido VAVE */
        .infographic-flow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1.5rem;
            text-align: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .flow-step {
            flex: 1;
            min-width: 150px;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #f8f9fa;
            margin: 5px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .flow-step:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }

        .flow-step .fas {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 0.6rem;
        }

        .flow-step strong {
            display: block;
            font-size: 1.1rem;
            color: #2c3e50;
            font-weight: 600;
        }

        .flow-arrow {
            font-size: 2rem;
            color: #3498db;
            margin: 0 0.6rem;
        }

        #resultsTable,
        #functionListTable {
            border-collapse: collapse;
            width: 100%;
            margin-top: 1.25rem;
            background: white;
            border: 1px solid #ddd;
            display: block;
            overflow-x: auto;
            white-space: nowrap;
        }

        #resultsTable th,
        #resultsTable td,
        #functionListTable th,
        #functionListTable td {
            border: 1px solid #ddd;
            padding: 0.75rem;
            text-align: center;
            white-space: normal;
        }

        #resultsTable th,
        #functionListTable th {
            background-color: #2c3e50;
            color: white;
            font-weight: 600;
        }

        #resultsTable tr:nth-child(even),
        #functionListTable tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .result-value {
            font-weight: bold;
            color: #2c3e50;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
        }

        .badge-success {
            background-color: #27ae60;
        }

        .badge-warning {
            background-color: #f39c12;
        }

        .badge-danger {
            background-color: #e74c3c;
        }

        #loadExampleBtn {
            background-color: #27ae60;
        }

        #resetBtn {
            background-color: #f39c12;
        }

        #function-input-grid {
            display: grid;
            grid-template-columns: 3fr 2fr 2fr auto;
            gap: 1.25rem;
            align-items: flex-end;
            margin-bottom: 1.25rem;
        }

        .slider-container {
            display: flex;
            flex-direction: column;
        }

        .slider-value {
            font-weight: bold;
            color: #3498db;
            text-align: center;
            margin-top: -0.6rem;
            margin-bottom: 0.6rem;
        }

        input[type="range"] {
            width: 100%;
            cursor: pointer;
        }

        #addFunctionBtn {
            background-color: #27ae60;
            width: 100%;
            padding: 0.6rem;
        }

        #addFunctionBtn:hover {
            background-color: #219653;
        }

        .remove-btn {
            background-color: #e74c3c;
            padding: 5px 10px;
        }

        .remove-btn:hover {
            background-color: #c0392b;
        }

        /* Ajustes responsivos */
        @media (max-width: 992px) {
            #function-input-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }

        @media (max-width: 768px) {
            .tab-content-wrapper {
                padding: 1rem;
            }

            .tab-btn {
                padding: 0.75rem 0.5rem;
                font-size: 0.9rem;
            }

            .infographic-flow {
                flex-direction: column;
                align-items: stretch;
            }

            .flow-arrow {
                transform: rotate(90deg);
                margin: 1rem 0;
            }
        }

        @media (max-width: 480px) {
            .tab-content-wrapper {
                padding: 0.75rem;
            }

            .tab-btn {
                padding: 0.6rem 0.3rem;
                font-size: 0.8rem;
            }
        }

        /* Estilo para el icono en el header */
        .header-icon-vave {
            background-color: #9013fe;
            color: white;
            padding: 5px 8px;
            border-radius: 6px;
            margin-right: 10px;
            font-size: 1.2em;
        }
    </style>
</head>

<body>

    <!-- Contenedor donde se cargará el header dinámicamente -->
    <div id="header-container"></div>

    <noscript>
        <nav>
            <a href="/">Home</a> |
            <a href="/8d">8D Tool</a> |
            <a href="/taguchi_doe">Taguchi DOE</a> |
            <a href="/swot">SWOT Analysis</a> |
            <a href="/balancedcard">Balanced Scorecard</a> |
            <a href="/qfd">QFD</a> |
            <a href="/apqp-ppap">APQP/PPAP</a> |
            <a href="/ishikawa">Ishikawa</a> |
            <a href="/fmea">FMEA</a> |
            <a href="/vave">VAVE</a> |
            <a href="/eisenhower">Eisenhower Matrix</a> |
            <a href="/triz">TRIZ</a> |
            <a href="/weibull">Weibull</a> |
            <a href="/stack_up_analysis">Tolerance Stack-Up</a> |
            <a href="/pdca">PDCA</a> |
            <a href="/design_thinking">Design Thinking</a> |
            <a href="/pugh">Pugh Matrix</a> |
            <a href="/cpk_calculator">CpK Calculator</a> |
            <a href="/control-plan">Control Plan</a>
        </nav>
    </noscript>

    <main class="main-content-wrapper">
        <header class="main-header">
            <h1>
                <i class="fas fa-cogs header-icon-vave"></i>
                Free Online Value Analysis / Value Engineering (VAVE) Tool
            </h1>
            <p>A Systematic Method for Improving Product Value</p>
        </header>

        <!-- CONTENEDOR DE TABS CON FONDO BLANCO -->
        <div class="tabs-container">
            <!-- NAVEGACIÓN DE PESTAÑAS (WIZARD) -->
            <nav class="tabs-nav">
                <button class="tab-btn active" onclick="switchWizardTab('tab-theory')">
                    <i class="fas fa-book"></i> Theory & Info
                </button>
                <button class="tab-btn" onclick="switchWizardTab('tab-input')">
                    <i class="fas fa-edit"></i> VAVE Analysis Tool
                </button>
                <button class="tab-btn" onclick="switchWizardTab('tab-results')">
                    <i class="fas fa-chart-bar"></i> Results
                </button>
            </nav>

            <!-- PESTAÑA 1: TEORÍA -->
            <div id="tab-theory" class="wizard-tab-content active">
                <div class="tab-content-wrapper">
                    <div class="container">
                        <h2><i class="fas fa-question-circle"></i> What is VAVE?</h2>
                        <p><strong>Value Analysis and Value Engineering (VAVE)</strong> is a powerful, systematic
                            methodology used
                            to analyze and improve the value of products, projects, or services. "Value" is defined by
                            the ratio of
                            function to cost. The goal is to achieve the required functions at the lowest possible
                            lifecycle cost
                            without compromising quality, reliability, or customer satisfaction.</p>
                        <p>The core principle is expressed in the value equation: <strong>Value = Function /
                                Cost</strong></p>
                        <ul>
                            <li><strong>Value Analysis (VA):</strong> Typically applied to <em>existing</em> products to
                                reduce
                                their cost or improve their function. It's a reactive approach to enhance value.</li>
                            <li><strong>Value Engineering (VE):</strong> Applied during the <em>design and development
                                    phase</em> of
                                a new product. It's a proactive approach to build value in from the start.</li>
                        </ul>
                        <p>VAVE combines both approaches into a unified process for continuous value improvement.</p>
                        <div class="infographic-flow">
                            <div class="flow-step"><i class="fas fa-list-ul"></i><strong>1. Identify
                                    Functions</strong><span>What
                                    does it do?</span></div>
                            <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                            <div class="flow-step"><i class="fas fa-dollar-sign"></i><strong>2. Assign
                                    Costs</strong><span>What does
                                    it cost?</span></div>
                            <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                            <div class="flow-step"><i class="fas fa-star"></i><strong>3. Assign Value</strong><span>How
                                    important is
                                    it?</span></div>
                            <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                            <div class="flow-step"><i class="fas fa-balance-scale"></i><strong>4. Analyze &
                                    Improve</strong><span>Where is the opportunity?</span></div>
                        </div>
                    </div>

                    <div class="container">
                        <h2><i class="fas fa-history"></i> Brief History & Purpose</h2>
                        <p>The concept of Value Analysis was pioneered by <strong>Lawrence D. Miles</strong> at General
                            Electric
                            (GE) during World War II. Faced with material shortages, Miles developed a systematic
                            approach to find
                            less expensive substitute materials and designs without sacrificing the function of a
                            product. The
                            success of this method led to its formalization and widespread adoption after the war. Value
                            Engineering
                            evolved from this, applying the same principles proactively during the design phase.</p>
                        <p>The primary purpose of VAVE is to eliminate unnecessary costs while ensuring or improving
                            function and
                            quality, thereby maximizing the value delivered to the customer and the organization.</p>
                    </div>

                    <div class="container">
                        <h2><i class="fas fa-tools"></i> How to Use This Tool</h2>
                        <div class="instructions-box">
                            <ul>
                                <li>Enter the overall <strong>Product Name</strong>.</li>
                                <li>In the "Add New Function" section:
                                    <ul>
                                        <li>Type a clear <strong>Function Description</strong>.</li>
                                        <li>Use the <strong>Cost Slider</strong> to set the cost for that function.</li>
                                        <li>Use the <strong>Value Score Slider</strong> to rate its importance (1-10).
                                        </li>
                                        <li>Click the <strong><i class="fas fa-plus"></i> Add</strong> button to add the
                                            function to
                                            the list below.</li>
                                    </ul>
                                </li>
                                <li>Continue adding all relevant functions for your product. You can remove any function
                                    using the
                                    <strong><i class="fas fa-minus-circle"></i></strong> button in its row.
                                </li>
                                <li>Click <strong><i class="fas fa-calculator"></i> Analyze Value</strong> to perform
                                    the
                                    calculation on the current list of functions.</li>
                                <li>Use <strong><i class="fas fa-plus"></i> Add to History</strong> to save the result
                                    for
                                    comparison.</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-input')">Go to VAVE Analysis Tool <i
                                class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA 2: VAVE ANALYSIS TOOL -->
            <div id="tab-input" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <div class="calculator-section">
                        <div class="calculation-block">
                            <div class="calculation-title">VAVE Analysis Tool</div>

                            <div style="text-align: center; margin-bottom: 20px;">
                                <button id="loadExampleBtn" class="example-btn"><i class="fas fa-file-alt"></i> Load
                                    Example</button>
                                <button id="resetBtn" style="background-color: #f39c12;"><i class="fas fa-sync-alt"></i>
                                    Reset Data</button>
                            </div>

                            <form id="vaveForm">
                                <label for="itemName"><i class="fas fa-tag"></i> Item/Product Name:</label>
                                <input type="text" id="itemName" placeholder="e.g., Product X" required />

                                <hr style="margin: 30px 0; border: 1px solid #eee;">

                                <h3><i class="fas fa-tasks"></i> Product Functions</h3>

                                <div id="function-input-grid">
                                    <div>
                                        <label for="functionDescription">Function Description</label>
                                        <input type="text" id="functionDescription"
                                            placeholder="e.g., Provide structural support">
                                    </div>
                                    <div class="slider-container">
                                        <label for="functionCost">Cost ($)</label>
                                        <span id="costValueDisplay" class="slider-value">100</span>
                                        <input type="range" id="functionCost" min="0" max="500" value="100" step="1">
                                    </div>
                                    <div class="slider-container">
                                        <label for="functionValue">Value Score (1-10)</label>
                                        <span id="valueScoreDisplay" class="slider-value">5</span>
                                        <input type="range" id="functionValue" min="1" max="10" value="5" step="1">
                                    </div>
                                    <div>
                                        <label>&nbsp;</label>
                                        <button type="button" id="addFunctionBtn" title="Add Function"><i
                                                class="fas fa-plus"></i>
                                            Add</button>
                                    </div>
                                </div>

                                <table id="functionListTable">
                                    <thead>
                                        <tr>
                                            <th>Function Description</th>
                                            <th>Cost</th>
                                            <th>Value Score</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>

                                <div style="text-align: center; margin-top: 25px;">
                                    <button type="submit"><i class="fas fa-calculator"></i> Analyze Value</button>
                                </div>
                            </form>

                            <div id="analysis-results" style="display:none; margin-top: 25px;">
                                <h3>Analysis Results</h3>
                                <p><i class="fas fa-money-bill-wave"></i> Total Current Cost: <span id="totalCost"
                                        class="result-value">-</span></p>
                                <p><i class="fas fa-star"></i> Total Value Score: <span id="totalValue"
                                        class="result-value">-</span>
                                </p>
                                <p><i class="fas fa-balance-scale"></i> Value Index (Total Value / Total Cost): <span
                                        id="valueIndex" class="result-value">-</span></p>

                                <button type="button" id="addBtn" disabled><i class="fas fa-plus"></i> Add to
                                    History</button>
                            </div>
                        </div>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab btn-prev" onclick="switchWizardTab('tab-theory')"><i
                                class="fas fa-arrow-left"></i> Back to Theory</button>
                        <button class="btn-next-tab btn-success" onclick="goToResults()" id="go-to-results-btn"
                            disabled>Go to Results <i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA 3: RESULTADOS -->
            <div id="tab-results" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <div class="calculation-block">
                        <div class="calculation-title">Results & History</div>

                        <div id="results-container">
                            <p style="color: #7f8c8d; text-align: center; padding: 2rem;">
                                <i class="fas fa-info-circle"
                                    style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                                Complete the analysis in the "VAVE Analysis Tool" tab to see results here.
                            </p>
                        </div>

                        <div id="results-summary" style="display: none;">
                            <h3
                                style="margin-top: 2rem; color: #2c3e50; border-bottom: 1px solid #eee; padding-bottom: 0.6rem;">
                                <i class="fas fa-history"></i> Analysis History
                            </h3>
                            <table id="resultsTable">
                                <thead>
                                    <tr>
                                        <th><i class="fas fa-tag"></i> Item/Product</th>
                                        <th><i class="fas fa-list"></i> Functions Analyzed</th>
                                        <th><i class="fas fa-money-bill-wave"></i> Total Cost</th>
                                        <th><i class="fas fa-star"></i> Total Value</th>
                                        <th><i class="fas fa-balance-scale"></i> Value Index</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>

                            <div class="matrix-actions" style="margin-top: 2rem;">
                                <button id="exportBtn" disabled><i class="fas fa-file-excel"></i> Export to
                                    Excel</button>
                                <button onclick="switchWizardTab('tab-input')" style="background-color: #6c757d;"><i
                                        class="fas fa-edit"></i> Edit Analysis</button>
                            </div>
                        </div>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab btn-prev" onclick="switchWizardTab('tab-input')"><i
                                class="fas fa-arrow-left"></i> Back to VAVE Analysis Tool</button>
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-theory')">Back to Theory <i
                                class="fas fa-book"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer role="contentinfo">
        <div class="disclaimer-note">
            <p><strong>Disclaimer:</strong> The tools and information provided on Sigma Exacta are for informational and
                educational purposes only. This tool is based on the Value Analysis / Value Engineering (VAVE)
                methodology, pioneered by Lawrence D. Miles. The tools on this site are independent implementations and
                are not affiliated with, sponsored by, or endorsed by the original creators or any specific institution.
                While we strive for accuracy, we make no warranty or guarantee regarding the results. All decisions
                related to product design, cost reduction, or value improvement based on the output of this tool are the
                sole responsibility of the user. Sigma Exacta and its creators are not liable for any damages or losses
                resulting from the use of this website.</p>
        </div>
    </footer>

    <script>
        // ============================================
        // FUNCIONES GLOBALES PARA LAS TABS
        // ============================================

        // Variables globales para VAVE
        let lastResult = null;
        let functionsList = [];
        let analysisCompleted = false;

        // Función para cambiar entre tabs
        function switchWizardTab(tabId) {
            // Quitar clase active de todos los botones y contenidos de wizard
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.wizard-tab-content').forEach(content => content.classList.remove('active'));

            // Activar el contenido seleccionado
            document.getElementById(tabId).classList.add('active');

            // Activar botón correspondiente
            const activeBtn = document.querySelector(`button[onclick="switchWizardTab('${tabId}')"]`);
            if (activeBtn) activeBtn.classList.add('active');

            // Scroll al top suavemente
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Si vamos a la pestaña de resultados, actualizar la vista
            if (tabId === 'tab-results' && analysisCompleted) {
                updateResultsView();
            }
        }

        // Función para ir a Results
        function goToResults() {
            if (analysisCompleted) {
                switchWizardTab('tab-results');
                updateResultsView();
            } else {
                alert('Please complete the analysis first in the "VAVE Analysis Tool" tab.');
            }
        }

        // Función para actualizar la vista de resultados
        function updateResultsView() {
            if (!analysisCompleted) return;

            const resultsContainer = document.getElementById('results-container');
            const resultsSummary = document.getElementById('results-summary');
            const exportBtn = document.getElementById('exportBtn');

            if (resultsContainer) {
                resultsContainer.innerHTML = '';
                resultsContainer.innerHTML = `
                    <div style="background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
                        <h3 style="margin-top: 0; color: #155724;"><i class="fas fa-chart-line"></i> Latest Analysis</h3>
                        <p><strong>Product:</strong> ${document.getElementById('itemName').value || 'Not specified'}</p>
                        <p><strong>Total Cost:</strong> $<span id="display-total-cost">${lastResult?.totalCost?.toFixed(2) || '0.00'}</span></p>
                        <p><strong>Total Value Score:</strong> <span id="display-total-value">${lastResult?.totalValue?.toFixed(0) || '0'}</span></p>
                        <p><strong>Value Index:</strong> <span class="badge ${getBadgeClass(lastResult?.valueIndex)}">${lastResult?.valueIndex || '0.0000'}</span></p>
                    </div>
                `;
            }

            // Mostrar resumen de resultados
            if (resultsSummary) {
                resultsSummary.style.display = 'block';
            }

            // Habilitar botón de exportación
            if (exportBtn) {
                exportBtn.disabled = false;
            }
        }

        // Función para determinar la clase del badge según el valor
        function getBadgeClass(valueIndex) {
            if (!valueIndex) return 'badge-warning';
            const numValue = parseFloat(valueIndex);
            if (numValue >= 0.25) return 'badge-success';
            if (numValue < 0.1) return 'badge-danger';
            return 'badge-warning';
        }

        // ============================================
        // CÓDIGO PRINCIPAL CUANDO EL DOM ESTÁ LISTO
        // ============================================
        document.addEventListener('DOMContentLoaded', function () {
            // Cargar el header desde header.html
            fetch('header.html')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(data => {
                    document.getElementById('header-container').innerHTML = data;
                    // Inicializar el menú después de cargar el header
                    initMenu();
                })
                .catch(error => {
                    console.error('Error loading header:', error);
                });

            // Inicializar controles deslizantes
            const costSlider = document.getElementById("functionCost");
            const valueSlider = document.getElementById("functionValue");
            const costDisplay = document.getElementById("costValueDisplay");
            const valueDisplay = document.getElementById("valueScoreDisplay");

            if (costSlider && costDisplay) {
                costSlider.addEventListener('input', () => costDisplay.textContent = costSlider.value);
            }

            if (valueSlider && valueDisplay) {
                valueSlider.addEventListener('input', () => valueDisplay.textContent = valueSlider.value);
            }

            // Manejar agregar funciones
            const addFunctionBtn = document.getElementById("addFunctionBtn");
            if (addFunctionBtn) {
                addFunctionBtn.addEventListener('click', () => {
                    const description = document.getElementById("functionDescription").value.trim();
                    if (!description) {
                        alert("Please enter a function description.");
                        return;
                    }
                    functionsList.push({
                        id: Date.now(),
                        description: description,
                        cost: parseFloat(costSlider.value),
                        value: parseInt(valueSlider.value)
                    });
                    renderFunctionList();
                    document.getElementById("functionDescription").value = "";
                    document.getElementById("functionDescription").focus();
                });
            }

            // Manejar el formulario de análisis
            const vaveForm = document.getElementById("vaveForm");
            if (vaveForm) {
                vaveForm.addEventListener("submit", function (event) {
                    event.preventDefault();
                    analyzeVAVE();
                });
            }

            // Botón de ejemplo
            const loadExampleBtn = document.getElementById("loadExampleBtn");
            if (loadExampleBtn) {
                loadExampleBtn.addEventListener("click", function () {
                    document.getElementById("itemName").value = "Gizmo 5000";
                    functionsList = [
                        { id: 1, description: 'Provide power', cost: 120.00, value: 9 },
                        { id: 2, description: 'Control user input', cost: 75.50, value: 8 },
                        { id: 3, description: 'Display information', cost: 60.00, value: 7 },
                        { id: 4, description: 'House components', cost: 40.00, value: 6 },
                        { id: 5, description: 'Ensure safety', cost: 30.00, value: 9 }
                    ];
                    renderFunctionList();
                });
            }

            // Botón de reset
            const resetBtn = document.getElementById("resetBtn");
            if (resetBtn) {
                resetBtn.addEventListener("click", function () {
                    document.getElementById("itemName").value = "";
                    functionsList = [];
                    renderFunctionList();
                    document.getElementById("analysis-results").style.display = "none";
                    document.getElementById("addBtn").disabled = true;
                    analysisCompleted = false;
                    const goToResultsBtn = document.getElementById('go-to-results-btn');
                    if (goToResultsBtn) goToResultsBtn.disabled = true;
                });
            }

            // Botón para agregar a la tabla de historia
            const addBtn = document.getElementById("addBtn");
            if (addBtn) {
                addBtn.addEventListener("click", addToTable);
            }

            // Botón de exportación
            const exportBtn = document.getElementById("exportBtn");
            if (exportBtn) {
                exportBtn.addEventListener("click", exportExcel);
            }
        });

        // Función para renderizar la lista de funciones
        function renderFunctionList() {
            const tbody = document.querySelector("#functionListTable tbody");
            if (tbody) {
                tbody.innerHTML = "";
                functionsList.forEach(func => {
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td style="text-align: left;">${func.description}</td>
                        <td>$${func.cost.toFixed(2)}</td>
                        <td>${func.value}</td>
                        <td><button type="button" class="remove-btn" onclick="removeFunction(${func.id})"><i class="fas fa-minus-circle"></i></button></td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        // Función para eliminar una función
        function removeFunction(id) {
            functionsList = functionsList.filter(func => func.id !== id);
            renderFunctionList();
        }

        // Función para analizar VAVE
        function analyzeVAVE() {
            const itemName = document.getElementById("itemName").value;
            if (functionsList.length === 0) {
                alert("Please add at least one function to the list before analyzing.");
                return;
            }

            let totalCost = 0;
            let totalValue = 0;
            functionsList.forEach(func => {
                totalCost += func.cost;
                totalValue += func.value;
            });

            const valueIndex = totalCost > 0 ? (totalValue / totalCost) : 0;

            // Mostrar resultados en la pestaña actual
            const analysisResults = document.getElementById("analysis-results");
            if (analysisResults) {
                document.getElementById("totalCost").textContent = '$' + totalCost.toFixed(2);
                document.getElementById("totalValue").textContent = totalValue.toFixed(0);
                document.getElementById("valueIndex").textContent = valueIndex.toFixed(4);
                analysisResults.style.display = "block";
                document.getElementById("addBtn").disabled = false;
            }

            // Guardar el resultado para la pestaña de resultados
            lastResult = {
                itemName,
                functionsAnalyzed: functionsList.map(f => f.description).join('; '),
                totalCost,
                totalValue,
                valueIndex: valueIndex.toFixed(4)
            };

            analysisCompleted = true;

            // Habilitar botón para ir a resultados
            const goToResultsBtn = document.getElementById('go-to-results-btn');
            if (goToResultsBtn) goToResultsBtn.disabled = false;
        }

        // Función para agregar a la tabla de historia
        function addToTable() {
            if (!lastResult) return;
            const tbody = document.querySelector("#resultsTable tbody");
            if (tbody) {
                const row = document.createElement("tr");
                const badgeClass = getBadgeClass(lastResult.valueIndex);
                row.innerHTML = ` 
                    <td>${lastResult.itemName}</td> 
                    <td style="text-align: left;">${lastResult.functionsAnalyzed}</td> 
                    <td>$${lastResult.totalCost.toFixed(2)}</td> 
                    <td>${lastResult.totalValue.toFixed(0)}</td> 
                    <td><span class="badge ${badgeClass}">${lastResult.valueIndex}</span></td> 
                `;
                tbody.appendChild(row);
                document.getElementById("addBtn").disabled = true;
            }
        }

        // Función para exportar a Excel
        function exportExcel() {
            const wb = XLSX.utils.book_new();

            // Hoja de historia
            const historyTable = document.getElementById("resultsTable");
            if (historyTable.rows.length > 1) {
                const historySheet = XLSX.utils.table_to_sheet(historyTable, { sheet: "History" });
                XLSX.utils.book_append_sheet(wb, historySheet, "Analysis History");
            }

            // Hoja de funciones actuales
            if (functionsList.length > 0) {
                const functionsData = functionsList.map(f => ({
                    Item: document.getElementById("itemName").value,
                    Function: f.description,
                    Cost: f.cost,
                    'Value Score': f.value
                }));
                const functionsSheet = XLSX.utils.json_to_sheet(functionsData);
                XLSX.utils.book_append_sheet(wb, functionsSheet, "Current Functions");
            }

            XLSX.writeFile(wb, "VAVE_Analysis_Sigma_Exacta.xlsx");
        }

        // Función para inicializar el menú
        function initMenu() {
            const navToggle = document.getElementById('nav-toggle');
            const navMenu = document.getElementById('nav-menu');
            const toolsDropdownToggle = document.getElementById('tools-dropdown-toggle');
            const toolsDropdownMenu = document.getElementById('tools-dropdown-menu');
            const toolsDropdownContainer = document.getElementById('tools-dropdown-container');

            if (navToggle && navMenu) {
                navToggle.addEventListener('click', () => {
                    navMenu.classList.toggle('show-menu');
                    const icon = navToggle.querySelector('i');
                    if (icon) {
                        icon.classList.toggle('fa-bars');
                        icon.classList.toggle('fa-times');
                    }

                    if (!navMenu.classList.contains('show-menu')) {
                        if (toolsDropdownMenu) toolsDropdownMenu.classList.remove('show-submenu');
                        if (toolsDropdownContainer) toolsDropdownContainer.classList.remove('active');
                    }
                });
            }

            if (toolsDropdownToggle && toolsDropdownMenu) {
                toolsDropdownToggle.addEventListener('click', (event) => {
                    if (window.innerWidth <= 992) {
                        event.preventDefault();
                        toolsDropdownMenu.classList.toggle('show-submenu');
                        if (toolsDropdownContainer) toolsDropdownContainer.classList.toggle('active');
                    }
                });
            }
        }
    </script>

</body>

</html>