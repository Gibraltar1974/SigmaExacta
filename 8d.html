<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="canonical" href="https://sigmaexacta.com/8d" />

  <title>Free 8D Problem Solving Tool & Report Generator | Sigma Exacta</title>
  <meta name="description"
    content="Free 8D Problem Solving tool. Systematically identify root causes, implement corrective actions, and generate professional 8D reports instantly. Perfect for manufacturing, engineering, and quality teams.">
  <meta name="keywords"
    content="Opensource, Free software, 8d problem solving, 8 disciplines, 8d report, 8d report template, free 8d tool, root cause analysis, corrective action, quality management, problem solving tool, ford 8d process, 8 disciplines of problem solving, quality engineering tools, SigmExacta">
  <link rel="icon" href="sigma-exacta-icon.jpg" type="image/jpeg">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Free 8D Problem Solving Tool & Report Generator",
    "description": "A comprehensive online tool to guide users through the 8 Disciplines of problem-solving, from team formation to generating a full downloadable report.",
    "url": "https://www.sigmaexacta.com/8d.html",
    "mainEntity": {
      "@type": "SoftwareApplication",
      "name": "8D Problem Solving Tool",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Web-based",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "provider": {
        "@type": "Organization",
        "name": "Sigma Exacta"
      }
    },
    "hasPart": {
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is the 8D Methodology?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The 8D (Eight Disciplines) methodology is a structured, team-based approach to problem-solving, designed to identify, correct, and eliminate the recurrence of complex problems. It guides teams through eight key steps to ensure the root cause is addressed, not just the symptoms."
          }
        },
        {
          "@type": "Question",
          "name": "What is the history of the 8D process?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The 8D methodology was developed by Ford Motor Company in the 1980s, initially known as 'Team Oriented Problem Solving' (TOPS). Its success in improving quality and resolving issues led to its widespread adoption in the automotive, electronics, and healthcare industries, becoming a staple of modern quality management."
          }
        },
        {
          "@type": "Question",
          "name": "How do you use this 8D tool?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "To use the tool, you systematically fill out the form for each of the 8 Disciplines, starting with team information (D0) and ending with team recognition (D7). You can load an example to see how it works. Once complete, click 'Generate Report Summary' to see the results, which you can then print or export as a detailed Excel file."
          }
        }
      ]
    }
  }
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">

  <!-- Usar el mismo approach que eisenhower.html -->
  <link rel="stylesheet" href="styles.css">

  <style>
    /* Specific styles for the 8D page. */
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #e74c3c;
      --light-color: #ecf0f1;
      --dark-color: #2c3e50;
      --success-color: #27ae60;
      --warning-color: #f39c12;
      font-size: 16px;
    }

    body {
      background-color: #f5f7fa;
      font-family: 'Nunito', sans-serif;
      width: 100%;
      overflow-x: hidden;
      margin: 0;
      padding: 0;
    }

    .main-content-wrapper {
      width: 100%;
      max-width: 100%;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      margin-top: 60px;
    }

    .content-container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1.25rem;
      box-sizing: border-box;
    }

    .header {
      margin-bottom: 1.25rem;
      padding: 1.25rem;
      border-bottom: 1px solid #ddd;
      text-align: center;
      background-color: white;
    }

    .header h1 {
      color: var(--primary-color);
      font-size: clamp(1.5rem, 4vw, 1.8rem);
      margin: 0.5rem 0;
      font-weight: 800;
    }

    .header .header-subtitle {
      font-size: 1.1rem;
      color: #7f8c8d;
      margin: 0 auto;
      font-weight: 400;
      max-width: 700px;
    }

    .calculation-block {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      background-color: white;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 100%;
      box-sizing: border-box;
    }

    .calculation-block h2 {
      color: var(--primary-color);
      margin-top: 0;
      margin-bottom: 1rem;
      font-size: 1.5em;
      font-weight: 800;
    }

    .calculation-block ul,
    .calculation-block ol {
      padding-left: 1.25rem;
      line-height: 1.8;
    }

    .calculation-title {
      font-weight: 800;
      font-size: 1.2em;
      margin-bottom: 1rem;
      color: var(--primary-color);
      border-bottom: 1px solid #eee;
      padding-bottom: 0.6rem;
    }

    label {
      display: block;
      margin-bottom: 0.6rem;
      color: var(--primary-color);
      font-weight: 600;
    }

    input[type="text"],
    textarea,
    select {
      width: 100%;
      padding: 0.6rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 1rem;
      margin-bottom: 1rem;
      transition: border 0.3s, box-shadow 0.3s;
      line-height: 1.5;
      font-family: 'Nunito', sans-serif;
      box-sizing: border-box;
    }

    input:focus,
    textarea:focus,
    select:focus,
    button:focus-visible {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
    }

    textarea {
      resize: none;
      overflow-y: hidden;
      min-height: 40px;
    }

    button {
      background-color: var(--secondary-color);
      color: white;
      padding: 0.7rem 1.25rem;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.3s;
      font-family: 'Nunito', sans-serif;
      font-weight: 600;
    }

    button:hover {
      background-color: #2980b9;
    }

    button:disabled {
      background-color: #95a5a6;
      cursor: not-allowed;
    }

    .btn-example {
      background-color: var(--success-color);
    }

    .btn-example:hover {
      background-color: #219653;
    }

    .btn-export {
      background-color: var(--success-color);
    }

    .btn-export:hover {
      background-color: #219653;
    }

    .btn-reset {
      background-color: var(--warning-color);
    }

    .btn-reset:hover {
      background-color: #e67e22;
    }

    .top-button-group {
      display: flex;
      justify-content: flex-start;
      margin-bottom: 1.25rem;
      gap: 0.6rem;
      flex-wrap: wrap;
    }

    .results-actions-group {
      margin-top: 1.25rem;
      display: flex;
      gap: 0.6rem;
      flex-wrap: wrap;
    }

    #results {
      padding: 1.25rem;
      border-radius: 8px;
      border: 1px solid #ddd;
      width: 100%;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      box-sizing: border-box;
      display: none;
    }

    #results p {
      margin-bottom: 0.75rem;
      color: var(--primary-color);
      word-wrap: break-word;
    }

    .discipline-section {
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px dashed #ddd;
    }

    .discipline-title {
      font-weight: 800;
      color: var(--primary-color);
      margin-bottom: 0.6rem;
      display: flex;
      align-items: center;
    }

    .discipline-title i {
      margin-right: 0.6rem;
      color: var(--secondary-color);
    }

    footer {
      padding: 2rem 1.25rem;
      text-align: center;
      width: 100%;
      box-sizing: border-box;
      background-color: #f5f7fa;
    }

    .disclaimer-note {
      margin-top: 2rem;
      padding: 0 1rem;
      font-size: 0.8rem;
      color: #777;
      max-width: 100%;
      margin-left: auto;
      margin-right: auto;
      box-sizing: border-box;
    }

    @media (max-width: 768px) {
      .header {
        padding: 1rem;
      }

      .calculation-block {
        padding: 1rem;
        margin-bottom: 1rem;
      }

      .top-button-group,
      .results-actions-group {
        flex-direction: column;
        align-items: stretch;
      }

      .top-button-group button,
      .results-actions-group button {
        width: 100%;
        margin: 0.25rem 0;
      }
    }

    /* Print styles */
    @media print {
      body * {
        visibility: hidden;
      }

      #printable-report,
      #printable-report * {
        visibility: visible;
      }

      #printable-report {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
      }

      .no-print {
        display: none !important;
      }
    }
  </style>
</head>

<body>

  <!-- Header container for dynamic content -->
  <div id="header-container"></div>

  <main class="main-content-wrapper">
    <div class="content-container">
      <header class="header">
        <h1>
          <div style="
          display: inline-flex;
          justify-content: center;
          align-items: center;
          width: 40px;
          height: 40px;
          border-radius: 8px;
          background-color: #f5a623;
          color: white;
          font-size: 1.5rem;
          margin-right: 0.5rem;
          vertical-align: middle;
        ">
            <i class="fas fa-clipboard-list"></i>
          </div>
          Free Online 8D Problem Solving Tool
        </h1>
        <p class="header-subtitle">A structured methodology for Problem Solving Analysis in 8 Disciplines.</p>
      </header>

      <div class="calculation-block">
        <h2><i class="fas fa-question-circle"></i> What is the 8D Methodology?</h2>
        <p>The <strong>8D (Eight Disciplines) methodology</strong> is a structured, team-based approach to
          problem-solving, designed to identify, correct, and eliminate the recurrence of complex problems. Originally
          used in the manufacturing industry, its effectiveness has extended it to a wide variety of sectors.</p>
        <p>The process guides teams through eight key steps, ensuring that the root cause of the problem is addressed
          rather than just treating the symptoms. The disciplines are:</p>
        <ul>
          <li><strong>D0:</strong> Plan and Prepare.</li>
          <li><strong>D1:</strong> Form a Team.</li>
          <li><strong>D2:</strong> Describe the Problem.</li>
          <li><strong>D3:</strong> Implement Containment Actions.</li>
          <li><strong>D4:</strong> Identify and Verify the Root Cause.</li>
          <li><strong>D5:</strong> Develop Permanent Corrective Actions.</li>
          <li><strong>D6:</strong> Implement and Validate Corrective Actions.</li>
          <li><strong>D7:</strong> Prevent Recurrence.</li>
          <li><strong>D8:</strong> Recognize the Team.</li>
        </ul>
      </div>

      <div class="calculation-block">
        <h2><i class="fas fa-history"></i> Brief History of 8D</h2>
        <p>The 8D methodology was developed by <strong>Ford Motor Company</strong> during the 1980s. Initially, it was
          known as "Team Oriented Problem Solving" (TOPS) and was officially documented in their 1987 manual of the same
          name. The U.S. government was one of the first to adopt it, referring to it as a military standard.</p>
        <p>The purpose was to create a standardized method for analyzing and resolving quality and production issues.
          Ford found that a cross-functional team approach, following a disciplined process, was far more effective at
          finding robust and permanent solutions than individual efforts. The method's success at Ford led to its
          widespread adoption in the automotive industry and, subsequently, in the electronics, healthcare, and general
          manufacturing sectors, becoming a pillar of modern quality management.</p>
      </div>

      <div class="calculation-block">
        <h2><i class="fas fa-cogs"></i> How to Use This Tool</h2>
        <ol>
          <li><strong>Complete Team Information (D0):</strong> Enter the team leader's name, members, and date to
            document who is in charge of the analysis.</li>
          <li><strong>Describe the Problem (D1):</strong> Be specific about what the problem is, where and when it
            occurs, and its magnitude. The more information, the better.</li>
          <li><strong>Detail Containment Actions (D2):</strong> Document the immediate measures taken to protect the
            customer and isolate the problem while the root cause is being investigated.</li>
          <li><strong>Analyze the Root Cause (D3):</strong> List potential causes and describe how they were verified to
            confirm the definitive root cause(s).</li>
          <li><strong>Define Corrective Actions (D4):</strong> Propose solutions that will directly address the root
            cause.</li>
          <li><strong>Verify Effectiveness (D5):</strong> Enter the data and date that demonstrate the corrective
            actions have solved the problem.</li>
          <li><strong>Establish Preventive Actions (D6):</strong> Define what will be done to prevent this or similar
            problems from recurring in the future.</li>
          <li><strong>Recognize the Team (D7):</strong> Document how the team's effort was recognized and the lessons
            learned to share the knowledge.</li>
          <li><strong>Generate and Export the Report:</strong> Click "Generate Report Summary" to see a summary. You can
            then print it or export a complete, detailed report to Excel for your documentation.</li>
        </ol>
      </div>

      <div class="calculation-block">
        <div class="calculation-title">8D Problem Solving Form</div>

        <div class="top-button-group">
          <button type="button" id="loadExampleBtn" class="btn-example"><i class="fas fa-lightbulb"></i> Load
            Example</button>
          <button type="button" id="resetBtn" class="btn-reset"><i class="fas fa-undo"></i> Reset Form</button>
        </div>

        <form id="eightDForm" onsubmit="event.preventDefault();">
          <div class="discipline-section">
            <div class="discipline-title"><i class="fas fa-users"></i> D0: Team Information</div>
            <label for="teamLeader"><i class="fas fa-user-tie"></i> Team Leader:</label>
            <input type="text" id="teamLeader" required />

            <label for="teamMembers"><i class="fas fa-users"></i> Team Members (comma separated):</label>
            <input type="text" id="teamMembers" required />

            <label for="date"><i class="fas fa-calendar-alt"></i> Date:</label>
            <input type="text" id="date" required />
          </div>

          <div class="discipline-section">
            <div class="discipline-title"><i class="fas fa-exclamation-triangle"></i> D1: Problem Description</div>
            <label for="problemStatement"><i class="fas fa-question-circle"></i> Problem Statement:</label>
            <textarea id="problemStatement" required rows="1"></textarea>

            <label for="issueDescription"><i class="fas fa-bullseye"></i> What is the issue?</label>
            <textarea id="issueDescription" required rows="1"></textarea>

            <label for="location"><i class="fas fa-map-marker-alt"></i> Where does it occur?</label>
            <textarea id="location" required rows="1"></textarea>

            <label for="timing"><i class="fas fa-clock"></i> When was it first noticed?</label>
            <textarea id="timing" required rows="1"></textarea>

            <label for="magnitude"><i class="fas fa-ruler-combined"></i> How big is the problem? (Quantity, % affected,
              etc.)</label>
            <textarea id="magnitude" required rows="1"></textarea>
          </div>

          <div class="discipline-section">
            <div class="discipline-title"><i class="fas fa-shield-alt"></i> D2: Containment Actions</div>
            <label for="containmentActions"><i class="fas fa-ban"></i> Immediate containment actions:</label>
            <textarea id="containmentActions" required rows="1"></textarea>

            <label for="containmentDate"><i class="fas fa-calendar-check"></i> Implementation date:</label>
            <input type="text" id="containmentDate" required />

            <label for="containmentResponsible"><i class="fas fa-user-check"></i> Responsible person:</label>
            <input type="text" id="containmentResponsible" required />

            <label for="containmentVerification"><i class="fas fa-check-circle"></i> Effectiveness verification:</label>
            <textarea id="containmentVerification" required rows="1"></textarea>
          </div>

          <div class="discipline-section">
            <div class="discipline-title"><i class="fas fa-search"></i> D3: Root Cause Analysis</div>
            <label for="potentialCauses"><i class="fas fa-project-diagram"></i> Potential causes (use 5 Whys, Fishbone,
              etc.):</label>
            <textarea id="potentialCauses" required rows="1"></textarea>

            <label for="rootCauseVerification"><i class="fas fa-flask"></i> Root cause verification (tests, data
              analysis):</label>
            <textarea id="rootCauseVerification" required rows="1"></textarea>

            <label for="rootCause"><i class="fas fa-check-double"></i> Confirmed root cause(s):</label>
            <textarea id="rootCause" required rows="1"></textarea>
          </div>

          <div class="discipline-section">
            <div class="discipline-title"><i class="fas fa-wrench"></i> D4: Corrective Actions</div>
            <label for="correctiveActions"><i class="fas fa-lightbulb"></i> Proposed corrective actions:</label>
            <textarea id="correctiveActions" required rows="1"></textarea>

            <label for="correctiveResponsible"><i class="fas fa-user-tie"></i> Responsible person:</label>
            <input type="text" id="correctiveResponsible" required />

            <label for="correctiveDeadline"><i class="fas fa-calendar-alt"></i> Implementation deadline:</label>
            <input type="text" id="correctiveDeadline" required />

            <label for="correctiveVerification"><i class="fas fa-check-square"></i> Verification method:</label>
            <textarea id="correctiveVerification" required rows="1"></textarea>
          </div>

          <div class="discipline-section">
            <div class="discipline-title"><i class="fas fa-check-circle"></i> D5: Effectiveness Verification</div>
            <label for="effectivenessData"><i class="fas fa-chart-line"></i> Data showing effectiveness:</label>
            <textarea id="effectivenessData" required rows="1"></textarea>

            <label for="verificationDate"><i class="fas fa-calendar-times"></i> Date verified:</label>
            <input type="text" id="verificationDate" required />

            <label for="verifiedBy"><i class="fas fa-user-check"></i> Verified by:</label>
            <input type="text" id="verifiedBy" required />
          </div>

          <div class="discipline-section">
            <div class="discipline-title"><i class="fas fa-cogs"></i> D6: Preventive Actions</div>
            <label for="preventiveActions"><i class="fas fa-shield-virus"></i> Actions to prevent recurrence:</label>
            <textarea id="preventiveActions" required rows="1"></textarea>

            <label for="preventiveResponsible"><i class="fas fa-user-tie"></i> Responsible person:</label>
            <input type="text" id="preventiveResponsible" required />

            <label for="preventiveDeadline"><i class="fas fa-calendar-alt"></i> Implementation deadline:</label>
            <input type="text" id="preventiveDeadline" required />

            <label for="preventiveVerification"><i class="fas fa-check-square"></i> Verification method:</label>
            <textarea id="preventiveVerification" required rows="1"></textarea>
          </div>

          <div class="discipline-section">
            <div class="discipline-title"><i class="fas fa-trophy"></i> D7: Congratulate the Team</div>
            <label for="teamRecognition"><i class="fas fa-award"></i> Team recognition:</label>
            <textarea id="teamRecognition" required rows="1"></textarea>

            <label for="lessonsLearned"><i class="fas fa-lightbulb"></i> Lessons learned:</label>
            <textarea id="lessonsLearned" required rows="1"></textarea>

            <label for="knowledgeSharing"><i class="fas fa-share-alt"></i> Knowledge sharing plan:</label>
            <textarea id="knowledgeSharing" required rows="1"></textarea>
          </div>

          <button type="button" id="generateReportBtn"
            style="background-color: var(--primary-color); width: 100%; padding: 12px; font-size: 1rem;"><i
              class="fas fa-cogs"></i> Generate Report Summary</button>
        </form>
      </div>

      <div class="calculation-block" id="results">
        <div class="calculation-title">8D Report Summary</div>
        <div id="reportSummary"></div>

        <div class="results-actions-group">
          <button type="button" id="exportBtn" class="btn-export"><i class="fas fa-file-excel"></i> Export Full Report
            to Excel</button>
          <button type="button" id="printBtn"><i class="fas fa-print"></i> Print Summary</button>
        </div>
      </div>

      <!-- Hidden printable report section -->
      <div id="printable-report" style="display: none;"></div>
    </div>
  </main>

  <footer>
    <div class="content-container">
      <div class="disclaimer-note">
        <p><strong>Disclaimer:</strong> The tools and information provided on Sigma Exacta are for informational and
          educational purposes only. Some tools, like this one, are based on established methodologies (e.g., the 8D
          methodology as developed by Ford Motor Company), which may be the intellectual property of their respective
          owners. The tools on this site are independent implementations and are not affiliated with, sponsored by, or
          endorsed by the original creators of these methodologies. While we strive for accuracy, we make no warranty or
          guarantee regarding the results. All calculations and decisions based on the output of these tools are the
          sole responsibility of the user. Sigma Exacta and its creators are not liable for any damages or losses
          resulting from the use of this website.</p>
      </div>
    </div>
  </footer>

  <script>
    // === MODIFICACIÓN: Cargar el header dinámicamente usando el mismo approach que eisenhower.html ===
    fetch('header.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('header-container').innerHTML = data;
        // Inicializar el menú después de cargar el header
        initializeMenu();
      })
      .catch(error => console.error('Error loading header:', error));

    function initializeMenu() {
      // --- JAVASCRIPT PARA LA NAVEGACIÓN ---
      const navToggle = document.getElementById('nav-toggle');
      const navMenu = document.getElementById('nav-menu');
      const toolsDropdownToggle = document.getElementById('tools-dropdown-toggle');
      const toolsDropdownMenu = document.getElementById('tools-dropdown-menu');
      const toolsDropdownContainer = document.getElementById('tools-dropdown-container');

      navToggle.addEventListener('click', () => {
        navMenu.classList.toggle('show-menu');
        const icon = navToggle.querySelector('i');
        icon.classList.toggle('fa-bars');
        icon.classList.toggle('fa-times');

        if (!navMenu.classList.contains('show-menu')) {
          toolsDropdownMenu.classList.remove('show-submenu');
          toolsDropdownContainer.classList.remove('active');
        }
      });

      toolsDropdownToggle.addEventListener('click', (event) => {
        if (window.innerWidth <= 992) {
          event.preventDefault();
          toolsDropdownMenu.classList.toggle('show-submenu');
          toolsDropdownContainer.classList.toggle('active');
        }
      });
    }

    document.addEventListener('DOMContentLoaded', function () {
      // --- Auto-growing textarea logic ---
      const textareas = document.querySelectorAll('textarea');
      function autoGrow(textarea) {
        textarea.style.height = 'auto';
        textarea.style.height = (textarea.scrollHeight) + 'px';
      }
      textareas.forEach(textarea => {
        textarea.addEventListener('input', function () { autoGrow(textarea); }, false);
        if (textarea.value) autoGrow(textarea);
      });

      // --- Main 8D tool application logic ---
      const loadExampleBtn = document.getElementById("loadExampleBtn");
      const resetBtn = document.getElementById("resetBtn");
      const generateReportBtn = document.getElementById("generateReportBtn");
      const exportBtn = document.getElementById("exportBtn");
      const printBtn = document.getElementById("printBtn");
      const resultsDiv = document.getElementById("results");
      const reportSummaryDiv = document.getElementById("reportSummary");
      const printableReportDiv = document.getElementById("printable-report");

      if (loadExampleBtn) {
        loadExampleBtn.addEventListener("click", function () {
          const today = new Date().toLocaleDateString('en-CA');

          document.getElementById("teamLeader").value = "John Doe";
          document.getElementById("teamMembers").value = "Jane Smith, Mike Johnson, Sarah Williams, Robert Brown";
          document.getElementById("date").value = today;
          document.getElementById("problemStatement").value = "High defect rate in Model X circuit boards during final testing";
          document.getElementById("issueDescription").value = "Approximately 12% of Model X circuit boards are failing final electrical testing due to short circuits in the power supply section";
          document.getElementById("location").value = "Production Line 3, Final Testing Station";
          document.getElementById("timing").value = `First noticed on ${new Date(new Date().setDate(new Date().getDate() - 20)).toLocaleDateString('en-CA')}, defect rate increased over the past 2 weeks`;
          document.getElementById("magnitude").value = "12% defect rate (120 out of 1000 units), affecting all batches from lot #X2305 onward";
          document.getElementById("containmentActions").value = "1. Quarantine all affected lots (from lot #X2305 to present).\n2. Implement 100% visual and electrical inspection for the power supply section on all new production.\n3. Stop all shipments of Model X until further notice.";
          document.getElementById("containmentDate").value = today;
          document.getElementById("containmentResponsible").value = "Maria Garcia (Quality Manager)";
          document.getElementById("containmentVerification").value = "Daily audit confirmed that 100% of affected lots are quarantined and no affected product has been shipped since the action was implemented.";
          document.getElementById("potentialCauses").value = "1. New solder paste formulation.\n2. Reflow oven temperature profile change.\n3. Component supplier change.\n4. Operator training issue.\n\n5 Whys Analysis:\nWhy? -> Short circuits in power section.\nWhy? -> Solder bridges between pins.\nWhy? -> Excessive solder paste application.\nWhy? -> New stencil with larger apertures was used.\nWhy? -> Engineering change was not properly validated before production use.";
          document.getElementById("rootCauseVerification").value = "1. Process change logs confirm new stencil was introduced on the date the defects started.\n2. Solder paste volume measurements showed a 15% increase compared to the previous stencil.\n3. X-ray inspection of defective units confirmed solder bridges in 90% of cases, consistent with excess solder.";
          document.getElementById("rootCause").value = "The primary root cause is the implementation of a new stencil design with larger apertures without proper validation. This led to excessive solder paste deposition, causing solder bridges between component pins in the power supply section during the reflow process.";
          document.getElementById("correctiveActions").value = "1. Immediately revert to the previous, validated stencil design for all Model X production.\n2. Implement a mandatory, cross-functional Engineering Change Control (ECC) procedure for any process or material change.\n3. Update the process validation protocol to include solder paste volume analysis for any stencil changes.\n4. Retrain all process engineers and technicians on the new ECC procedure.";
          document.getElementById("correctiveResponsible").value = "David Wilson (Process Engineer)";
          document.getElementById("correctiveDeadline").value = `${new Date(new Date().setDate(new Date().getDate() + 15)).toLocaleDateString('en-CA')}`;
          document.getElementById("correctiveVerification").value = "1. Monitor final testing defect rate daily for 30 days.\n2. Perform random X-ray sample inspections on 5 units per shift.\n3. Conduct a new Process Capability (Cpk) study on solder paste volume after implementation.";
          document.getElementById("effectivenessData").value = "After implementing corrective actions:\n- Defect rate dropped from 12% to 0.5% within 3 days and has remained stable.\n- X-ray inspections show no solder bridges in the last 50 sampled units.\n- Process capability (Cpk) for solder paste volume improved to 1.67, indicating a stable and capable process.";
          document.getElementById("verificationDate").value = `${new Date(new Date().setDate(new Date().getDate() + 20)).toLocaleDateString('en-CA')}`;
          document.getElementById("verifiedBy").value = "Emma Thompson (Quality Director)";
          document.getElementById("preventiveActions").value = "1. The new Engineering Change Control (ECC) procedure has been rolled out to all production lines, not just Line 3.\n2. Solder paste volume measurement has been added as a standard in-process check for all product families.\n3. The FMEA for the soldering process has been updated to include 'improper stencil validation' as a potential failure mode with a high RPN, triggering mandatory mitigation actions.\n4. Schedule quarterly process audits to ensure compliance with the new ECC procedure.";
          document.getElementById("preventiveResponsible").value = "Carlos Rodriguez (Quality Systems Manager)";
          document.getElementById("preventiveDeadline").value = `${new Date(new Date().setDate(new Date().getDate() + 60)).toLocaleDateString('en-CA')}`;
          document.getElementById("preventiveVerification").value = "1. Review ECC records monthly to ensure 100% compliance.\n2. Monitor process stability metrics (SPC) for solder paste volume across all lines.\n3. Track defect rates for similar products to ensure the problem does not migrate.";
          document.getElementById("teamRecognition").value = "The team was publicly recognized in the company-wide monthly meeting for their swift and effective problem-solving. A 'Quality Champion' award was given to the team leader, John Doe.";
          document.getElementById("lessonsLearned").value = "1. Rigorous validation is non-negotiable for ANY engineering change, regardless of how minor it seems.\n2. Cross-functional review (involving Quality, Production, and Engineering) is essential before implementing any process change.\n3. In-process monitoring systems are key to detecting deviations before they result in a large volume of defective products.";
          document.getElementById("knowledgeSharing").value = "1. A detailed case study of this 8D was created and added to the company's knowledge base.\n2. The findings were presented to the global engineering team.\n3. The updated FMEA and control plan were shared with other production sites as a best practice.";

          // Update textarea heights
          textareas.forEach(textarea => autoGrow(textarea));
        });
      }

      if (resetBtn) {
        resetBtn.addEventListener("click", function () {
          document.getElementById("eightDForm").reset();
          textareas.forEach(textarea => {
            textarea.style.height = 'auto';
          });
          resultsDiv.style.display = "none";
        });
      }

      function getReportData() {
        const ids = ["teamLeader", "teamMembers", "date", "problemStatement", "issueDescription", "location", "timing", "magnitude", "containmentActions", "containmentDate", "containmentResponsible", "containmentVerification", "potentialCauses", "rootCauseVerification", "rootCause", "correctiveActions", "correctiveResponsible", "correctiveDeadline", "correctiveVerification", "effectivenessData", "verificationDate", "verifiedBy", "preventiveActions", "preventiveResponsible", "preventiveDeadline", "preventiveVerification", "teamRecognition", "lessonsLearned", "knowledgeSharing"];
        const data = {};
        ids.forEach(id => data[id] = document.getElementById(id).value);
        return data;
      }

      function generateReportSummary() {
        if (!document.getElementById('eightDForm').checkValidity()) {
          document.getElementById('eightDForm').reportValidity();
          return;
        }
        const reportData = getReportData();
        const nl2br = (str) => str.replace(/\n/g, '<br>');
        let summaryHTML = `
        <div class="discipline-section"><div class="discipline-title"><i class="fas fa-users"></i> D0: Team Information</div><p><strong>Team Leader:</strong> ${reportData.teamLeader}</p><p><strong>Team Members:</strong> ${reportData.teamMembers}</p><p><strong>Date:</strong> ${reportData.date}</p></div>
        <div class="discipline-section"><div class="discipline-title"><i class="fas fa-exclamation-triangle"></i> D1: Problem Description</div><p><strong>Problem Statement:</strong> ${nl2br(reportData.problemStatement)}</p></div>
        <div class="discipline-section"><div class="discipline-title"><i class="fas fa-shield-alt"></i> D2: Containment Actions</div><p><strong>Immediate containment actions:</strong> ${nl2br(reportData.containmentActions)}</p></div>
        <div class="discipline-section"><div class="discipline-title"><i class="fas fa-search"></i> D3: Root Cause Analysis</div><p><strong>Confirmed root cause(s):</strong> ${nl2br(reportData.rootCause)}</p></div>
        <div class="discipline-section"><div class="discipline-title"><i class="fas fa-wrench"></i> D4: Corrective Actions</div><p><strong>Proposed corrective actions:</strong> ${nl2br(reportData.correctiveActions)}</p></div>
        <div class="discipline-section"><div class="discipline-title"><i class="fas fa-check-circle"></i> D5: Effectiveness Verification</div><p><strong>Data showing effectiveness:</strong> ${nl2br(reportData.effectivenessData)}</p></div>
        <div class="discipline-section"><div class="discipline-title"><i class="fas fa-cogs"></i> D6: Preventive Actions</div><p><strong>Actions to prevent recurrence:</strong> ${nl2br(reportData.preventiveActions)}</p></div>
        <div class="discipline-section" style="border-bottom: none;"><div class="discipline-title"><i class="fas fa-trophy"></i> D7: Congratulate the Team</div><p><strong>Team recognition:</strong> ${nl2br(reportData.teamRecognition)}</p></div>`;

        if (reportSummaryDiv) {
          reportSummaryDiv.innerHTML = summaryHTML;
        }

        if (resultsDiv) {
          resultsDiv.style.display = "block";
          resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // Also update printable report
        if (printableReportDiv) {
          const headerTitle = document.querySelector('.header h1').innerText;
          printableReportDiv.innerHTML = `<h1>${headerTitle} - Report Summary</h1>${summaryHTML}`;
        }
      }

      if (generateReportBtn) {
        generateReportBtn.addEventListener("click", generateReportSummary);
      }

      if (printBtn) {
        printBtn.addEventListener("click", function () {
          if (!document.getElementById('eightDForm').checkValidity()) {
            document.getElementById('eightDForm').reportValidity();
            return;
          }

          // Ensure printable report is updated
          generateReportSummary();

          // Print using the printable report div
          window.print();
        });
      }

      if (exportBtn) {
        exportBtn.addEventListener("click", function () {
          if (!document.getElementById('eightDForm').checkValidity()) {
            document.getElementById('eightDForm').reportValidity();
            return;
          }

          const reportData = getReportData();
          const dataMap = [
            { d: "D0: Team Information", items: [["Team Leader", reportData.teamLeader], ["Team Members", reportData.teamMembers], ["Date", reportData.date]] },
            { d: "D1: Problem Description", items: [["Problem Statement", reportData.problemStatement], ["What is the issue?", reportData.issueDescription], ["Where does it occur?", reportData.location], ["When was it first noticed?", reportData.timing], ["How big is the problem?", reportData.magnitude]] },
            { d: "D2: Containment Actions", items: [["Immediate containment actions", reportData.containmentActions], ["Implementation date", reportData.containmentDate], ["Responsible person", reportData.containmentResponsible], ["Effectiveness verification", reportData.containmentVerification]] },
            { d: "D3: Root Cause Analysis", items: [["Potential causes", reportData.potentialCauses], ["Root cause verification", reportData.rootCauseVerification], ["Confirmed root cause(s)", reportData.rootCause]] },
            { d: "D4: Corrective Actions", items: [["Proposed corrective actions", reportData.correctiveActions], ["Responsible person", reportData.correctiveResponsible], ["Implementation deadline", reportData.correctiveDeadline], ["Verification method", reportData.correctiveVerification]] },
            { d: "D5: Effectiveness Verification", items: [["Data showing effectiveness", reportData.effectivenessData], ["Date verified", reportData.verificationDate], ["Verified by", reportData.verifiedBy]] },
            { d: "D6: Preventive Actions", items: [["Actions to prevent recurrence", reportData.preventiveActions], ["Responsible person", reportData.preventiveResponsible], ["Implementation deadline", reportData.preventiveDeadline], ["Verification method", reportData.preventiveVerification]] },
            { d: "D7: Congratulate the Team", items: [["Team recognition", reportData.teamRecognition], ["Lessons learned", reportData.lessonsLearned], ["Knowledge sharing plan", reportData.knowledgeSharing]] }
          ];

          const excelData = [["Discipline", "Item", "Details"]];
          dataMap.forEach(section => {
            excelData.push([section.d, "", ""]);
            section.items.forEach(item => excelData.push(["", item[0], item[1]]));
            excelData.push([]);
          });

          const wb = XLSX.utils.book_new();
          const ws = XLSX.utils.aoa_to_sheet(excelData);
          ws['!cols'] = [{ wch: 30 }, { wch: 30 }, { wch: 80 }];
          XLSX.utils.book_append_sheet(wb, ws, "8D Report");
          XLSX.writeFile(wb, "8D_Report_Sigma_Exacta.xlsx");
        });
      }
    });
  </script>

</body>

</html>