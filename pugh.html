<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pugh Matrix Creator | Sigma Exacta</title>
    <link rel="canonical" href="https://sigmaexacta.com/pugh" />
    <meta name="description"
        content="Free online Pugh Matrix (Decision Matrix) tool to systematically evaluate and select the best concept from a list of alternatives based on weighted criteria. An essential tool for product design, engineering, and decision-making.">
    <meta name="keywords"
        content="Open source, Free Software, SigmaExacta, pugh matrix, decision matrix, concept selection, criteria rating, weighted decision matrix, pew matrix, product design tool, engineering tool, six sigma, qfd">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" defer></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="sigma-exacta-icon.jpg" type="image/jpeg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">

    <style>
        :root {
            --performance-color: #2ecc71;
            --danger-color: #c0392b;
        }

        body {
            background-color: #f5f7fa;
            margin: 0;
            padding: 0;
            width: 100%;
            overflow-x: hidden;
        }

        .main-content-wrapper {
            max-width: 100%;
            margin: 0;
            padding: 0;
            width: 100%;
        }

        .main-header {
            text-align: center;
            padding: 1rem 1.25rem;
            margin-bottom: 0;
            border-bottom: 1px solid #ddd;
            width: 100%;
            box-sizing: border-box;
        }

        .main-header h1 {
            color: #2c3e50;
            font-size: clamp(1.5rem, 4vw, 1.8rem);
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .tool-logo {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 1.8rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            background-color: #27ae60;
        }

        .main-header p {
            color: #7f8c8d;
            font-weight: 400;
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
        }

        /* --- BOTONES PRINCIPALES SOBRE LAS TABS --- */
        .main-action-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1.5rem auto;
            flex-wrap: wrap;
            max-width: 800px;
        }

        .main-action-buttons button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        .main-action-buttons .btn-example {
            background-color: var(--performance-color);
            color: white;
        }

        .main-action-buttons .btn-example:hover {
            background-color: #27ad60;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        .main-action-buttons .btn-reset {
            background-color: var(--danger-color);
            color: white;
        }

        .main-action-buttons .btn-reset:hover {
            background-color: #a5281c;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        .container {
            background-color: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            box-sizing: border-box;
        }

        .container h2 {
            color: #2c3e50;
            margin-top: 0;
            border-bottom: 2px solid #3498db;
            padding-bottom: 0.6rem;
            font-weight: 800;
        }

        .container p,
        .container ol,
        .container ul {
            line-height: 1.8;
        }

        .container ol,
        .container ul {
            padding-left: 1.25rem;
        }

        /* ===== ESTILOS DEL SISTEMA DE PESTAÑAS (WIZARD) ===== */
        .tabs-nav {
            display: flex;
            background-color: #f1f5f9;
            border-radius: 8px 8px 0 0;
            overflow-x: auto;
            border-bottom: 2px solid #3498db;
            margin-bottom: 0;
            margin-top: 0;
            scrollbar-width: none;
            -ms-overflow-style: none;
            width: 100%;
        }

        .tabs-nav::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 1rem 1.5rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 700;
            color: #64748b;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            flex: 1;
            justify-content: center;
        }

        .tab-btn:hover {
            background-color: #e2e8f0;
            color: #2c3e50;
        }

        .tab-btn.active {
            background-color: #fff;
            color: #3498db;
            border-bottom-color: #3498db;
            border-radius: 8px 8px 0 0;
            margin-bottom: -2px;
            border-left: 1px solid #e1e5e9;
            border-right: 1px solid #e1e5e9;
            border-top: 1px solid #e1e5e9;
        }

        /* CONTENEDOR PRINCIPAL DE TABS - FONDO BLANCO */
        .tabs-container {
            background: #fff;
            border: 1px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
            position: relative;
            margin-bottom: 2rem;
            box-sizing: border-box;
        }

        /* PESTAÑAS - Todas con el mismo ancho */
        .wizard-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        .wizard-tab-content.active {
            display: block;
            width: 100%;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* CONTENIDO DE TODAS LAS TABS - Mismo padding */
        .tab-content-wrapper {
            padding: 2rem;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        /* Ajuste para pantallas móviles */
        @media (max-width: 768px) {
            .tab-content-wrapper {
                padding: 1rem;
            }

            .tab-btn {
                padding: 0.75rem 0.5rem;
                font-size: 0.9rem;
            }

            .main-action-buttons {
                gap: 0.75rem;
                margin: 1rem auto;
            }

            .main-action-buttons button {
                padding: 0.7rem 1.2rem;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .tab-content-wrapper {
                padding: 0.75rem;
            }

            .tab-btn {
                padding: 0.6rem 0.3rem;
                font-size: 0.8rem;
            }

            .main-action-buttons {
                flex-direction: column;
                align-items: stretch;
                gap: 0.5rem;
            }

            .main-action-buttons button {
                width: 100%;
                justify-content: center;
            }
        }

        .calculator-section {
            margin-top: 0;
            width: 100%;
        }

        .calculation-block {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.25rem;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            width: 100%;
            box-sizing: border-box;
        }

        .calculation-title {
            font-weight: 800;
            font-size: 1.2em;
            margin-bottom: 1rem;
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 0.6rem;
        }

        label {
            display: block;
            margin-bottom: 0.6rem;
            color: #2c3e50;
            font-weight: 600;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            box-sizing: border-box;
            transition: border 0.3s, box-shadow 0.3s;
            font-family: 'Nunito', sans-serif;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus,
        button:focus-visible {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
        }

        button {
            background-color: #3498db;
            color: white;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 1rem;
            transition: background-color 0.3s, box-shadow 0.3s;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
        }

        button:hover {
            background-color: #2980b9;
        }

        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }

        .example-btn {
            background-color: #27ae60;
        }

        .example-btn:hover {
            background-color: #229954;
        }

        .input-list-label {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1rem;
        }

        .action-button {
            padding: 0;
            width: 30px;
            height: 30px;
            min-width: 30px;
            font-size: 1.2rem;
            line-height: 30px;
            text-align: center;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0;
            margin: 0;
            background-color: #27ae60;
        }

        .action-button:hover {
            background-color: #229954;
        }

        .action-button.remove-btn {
            background-color: #e74c3c;
        }

        .action-button.remove-btn:hover {
            background-color: #c0392b;
        }

        .input-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            width: 100%;
        }

        .input-item input {
            flex-grow: 1;
            min-width: 0;
        }

        #matrix-container {
            overflow-x: auto;
            margin-top: 1rem;
            display: grid;
            grid-template-columns: minmax(0, 1fr);
            width: 100%;
        }

        .pugh-matrix {
            border-collapse: collapse;
            white-space: nowrap;
            font-size: 0.95rem;
            width: 100%;
            min-width: 600px;
        }

        .pugh-matrix th,
        .pugh-matrix td {
            border: 1px solid #ddd;
            padding: 0.75rem;
            text-align: center;
            vertical-align: middle;
        }

        .pugh-matrix th {
            background-color: #2c3e50;
            color: white;
            font-weight: 600;
            min-width: 120px;
        }

        .pugh-matrix .criterion-cell {
            text-align: left;
            font-weight: 600;
            min-width: 180px;
        }

        .pugh-matrix .weight-input {
            width: 100%;
            box-sizing: border-box;
            padding: 0.4rem;
            text-align: center;
            margin-bottom: 0;
        }

        .pugh-matrix .score-select {
            width: 100%;
            box-sizing: border-box;
            padding: 0.4rem;
            margin-bottom: 0;
        }

        .pugh-matrix .baseline-cell {
            background-color: #dfeef8;
            font-weight: bold;
        }

        .pugh-matrix th.baseline-cell {
            color: #2c3e50;
        }

        .pugh-matrix .total-row td {
            font-weight: 800;
            background-color: #fdfdfd;
            border-top: 3px solid #3498db;
        }

        .pugh-matrix .winning-column {
            background-color: rgba(39, 174, 96, 0.1);
        }

        .pugh-matrix .winning-column-header {
            background-color: #27ae60;
        }

        .tab-nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
            width: 100%;
            box-sizing: border-box;
        }

        .btn-next-tab {
            background-color: #3498db;
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn-next-tab:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        .btn-next-tab.btn-prev {
            background-color: #95a5a6;
        }

        .btn-next-tab.btn-prev:hover {
            background-color: #7f8c8d;
        }

        .btn-next-tab.btn-success {
            background-color: #27ae60;
        }

        .btn-next-tab.btn-success:hover {
            background-color: #229954;
        }

        .data-summary {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            width: 100%;
            box-sizing: border-box;
        }

        .data-summary h3 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }

        .data-summary ul {
            padding-left: 1.5rem;
            margin: 0;
        }

        .data-summary li {
            margin-bottom: 0.5rem;
        }

        .matrix-actions {
            display: flex;
            gap: 10px;
            margin-top: 1rem;
            flex-wrap: wrap;
            width: 100%;
        }

        /* Estilos para la sección de matriz en Data Input */
        .matrix-section {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px solid #3498db;
            width: 100%;
        }
    </style>
</head>

<body>

    <!-- Contenedor donde se cargará el header dinámicamente -->
    <div id="header-container"></div>

    <noscript>
        <nav>
            <a href="/">Home</a> |
            <a href="/8d">8D Tool</a> |
            <a href="/taguchi_doe">Taguchi DOE</a> |
            <a href="/swot">SWOT Analysis</a> |
            <a href="/balancedcard">Balanced Scorecard</a> |
            <a href="/qfd">QFD</a> |
            <a href="/apqp-ppap">APQP/PPAP</a> |
            <a href="/ishikawa">Ishikawa</a> |
            <a href="/fmea">FMEA</a> |
            <a href="/vave">VAVE</a> |
            <a href="/eisenhower">Eisenhower Matrix</a> |
            <a href="/triz">TRIZ</a> |
            <a href="/weibull">Weibull</a> |
            <a href="/stack_up_analysis">Tolerance Stack-Up</a> |
            <a href="/pdca">PDCA</a> |
            <a href="/design_thinking">Design Thinking</a> |
            <a href="/pugh">Pugh Matrix</a> |
            <a href="/cpk_calculator">CpK Calculator</a> |
            <a href="/control-plan">Control Plan</a>
        </nav>
    </noscript>

    <main class="main-content-wrapper">
        <header class="main-header">
            <h1>
                <div class="tool-logo" title="Pugh Matrix">
                    <i class="fas fa-project-diagram"></i>
                </div>
                Free Online Pugh Matrix Evaluating Tool (Decision Matrix)
            </h1>
            <p>Systematically evaluate and select the best concept from a list of alternatives.</p>

            <!-- BOTONES PRINCIPALES (AGREGADOS) -->
            <div class="main-action-buttons">
                <button id="globalLoadExampleBtn" class="btn-example">
                    <i class="fas fa-play-circle"></i> Load Example
                </button>
                <button id="globalResetBtn" class="btn-reset">
                    <i class="fas fa-sync-alt"></i> Reset All
                </button>
            </div>
        </header>

        <!-- CONTENEDOR DE TABS CON FONDO BLANCO -->
        <div class="tabs-container">
            <!-- NAVEGACIÓN DE PESTAÑAS (WIZARD) -->
            <nav class="tabs-nav">
                <button class="tab-btn active" onclick="switchWizardTab('tab-theory')">
                    <i class="fas fa-book"></i> Theory & Info
                </button>
                <button class="tab-btn" onclick="switchWizardTab('tab-input')">
                    <i class="fas fa-edit"></i> Data Input & Matrix
                </button>
                <button class="tab-btn" onclick="switchWizardTab('tab-results')">
                    <i class="fas fa-chart-bar"></i> Results
                </button>
            </nav>

            <!-- PESTAÑA 1: TEORÍA -->
            <div id="tab-theory" class="wizard-tab-content active">
                <div class="tab-content-wrapper">
                    <div class="container">
                        <h2><i class="fas fa-question-circle"></i> What is a Pugh Matrix?</h2>
                        <p>A <strong>Pugh Matrix</strong>, also known as a decision matrix or concept selection matrix,
                            is a
                            qualitative tool used to evaluate multiple concepts or alternatives against a set of
                            criteria. It was
                            developed by Stuart Pugh as a method for making more objective decisions during the product
                            design
                            process.</p>
                        <p>The core idea is to establish a "baseline" or "datum" concept, which can be the current
                            standard or one
                            of the new ideas. All other concepts are then compared to this baseline for each criterion,
                            scoring them
                            as "Better" (+), "Same" (S), or "Worse" (-). By summing the scores, the team can identify
                            the most
                            promising concept(s) for further development.</p>
                    </div>

                    <div class="container">
                        <h2><i class="fas fa-history"></i> Brief History of the Pugh Matrix</h2>
                        <p>The Pugh Matrix was developed by <strong>Stuart Pugh</strong>, a British product designer and
                            professor
                            at the University of Strathclyde, in the 1980s. He introduced it as part of his "Total
                            Design"
                            methodology. Pugh recognized that design teams often struggled with making objective choices
                            between
                            multiple viable concepts early in the design process. Existing methods were often
                            unstructured or overly
                            complex.</p>
                        <p>His solution was a simple, disciplined, and team-oriented matrix that replaced vague
                            discussions with a
                            structured evaluation. The tool's focus on comparing everything against a common baseline
                            (the "datum")
                            made it highly effective for identifying not just the best concept, but also for creating
                            hybrid
                            concepts by combining the best features of several ideas. It quickly became a staple in
                            engineering and
                            product development worldwide.</p>
                    </div>

                    <div class="container">
                        <h2><i class="fas fa-cogs"></i> How to Use This Tool</h2>
                        <ol>
                            <li><strong>Add Criteria:</strong> In the "Data Input & Matrix" tab, add evaluation criteria
                                (e.g.,
                                Cost, Weight, Durability).</li>
                            <li><strong>Add Concepts:</strong> Add your different ideas or alternatives (e.g., Plastic
                                Case, Aluminum Case).</li>
                            <li><strong>Generate Matrix:</strong> Click "Generate Matrix" to create an interactive
                                table.</li>
                            <li><strong>Set Baseline:</strong> Select which concept will be your baseline for
                                comparison.</li>
                            <li><strong>Set Weights:</strong> For each criterion, enter a weight (e.g., from 1 to 5) to
                                signify its importance.</li>
                            <li><strong>Score Concepts:</strong> For each concept and criterion, compare it to the
                                baseline using +, S, or -.</li>
                            <li><strong>Analyze Results:</strong> Go to the "Results" tab to see the calculated scores
                                and the winning concept.</li>
                            <li><strong>Export:</strong> Export the final matrix to an Excel file for your reports.</li>
                        </ol>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-input')">Go to Data Input & Matrix <i
                                class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA 2: ENTRADA DE DATOS Y MATRIZ -->
            <div id="tab-input" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <div class="calculator-section">
                        <div class="calculation-block">
                            <div class="calculation-title">Data Input</div>
                            <form id="pughForm">
                                <div class="input-list-label">
                                    <label for="criteria-list"><i class="fas fa-list-check"></i> Criteria</label>
                                    <button type="button" id="add-criterion-btn" class="action-button"
                                        title="Add Criterion">+</button>
                                </div>
                                <div id="criteria-list"></div>

                                <div class="input-list-label" style="margin-top: 2rem;">
                                    <label for="concepts-list"><i class="fas fa-lightbulb"></i> Concepts /
                                        Alternatives</label>
                                    <button type="button" id="add-concept-btn" class="action-button"
                                        title="Add Concept">+</button>
                                </div>
                                <div id="concepts-list"></div>

                                <div style="margin-top: 2rem;">
                                    <button type="button" id="fillExampleBtn" class="example-btn"><i
                                            class="fas fa-magic"></i> Fill
                                        Example</button>
                                    <button type="button" id="clearDataBtn" style="background-color: #e74c3c;"><i
                                            class="fas fa-trash"></i> Clear Data</button>
                                </div>
                            </form>

                            <!-- Sección de la matriz en la misma pestaña -->
                            <div class="matrix-section">
                                <div class="calculation-title">Matrix Builder</div>

                                <div class="matrix-actions">
                                    <button type="button" id="generateMatrixBtn"><i class="fas fa-table-cells"></i>
                                        Generate
                                        Matrix</button>
                                </div>

                                <div id="matrix-container" style="margin-top: 2rem;">
                                    <p style="color: #7f8c8d; text-align: center; padding: 2rem;">
                                        <i class="fas fa-info-circle"
                                            style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                                        Click "Generate Matrix" to create your Pugh Matrix.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="data-summary" id="data-summary" style="display: none;">
                            <h3><i class="fas fa-clipboard-check"></i> Data Summary</h3>
                            <p><strong>Criteria:</strong> <span id="criteria-count">0</span> items</p>
                            <p><strong>Concepts:</strong> <span id="concepts-count">0</span> items</p>
                            <p style="margin-top: 1rem; color: #27ae60; font-weight: 600;">
                                <i class="fas fa-check-circle"></i> Ready to generate matrix
                            </p>
                        </div>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab btn-prev" onclick="switchWizardTab('tab-theory')"><i
                                class="fas fa-arrow-left"></i> Back to Theory</button>
                        <button class="btn-next-tab btn-success" onclick="goToResults()" id="go-to-results-btn"
                            disabled>Go to Results <i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA 3: RESULTADOS -->
            <div id="tab-results" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <div class="calculation-block">
                        <div class="calculation-title">Results</div>

                        <div id="results-matrix-container">
                            <p style="color: #7f8c8d; text-align: center; padding: 2rem;">
                                <i class="fas fa-info-circle"
                                    style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                                Complete the matrix in the "Data Input & Matrix" tab to see results here.
                            </p>
                        </div>

                        <div id="results-summary" style="display: none;">
                            <div class="calculation-title" style="margin-top: 2rem;">Results Summary</div>
                            <div id="winning-concept"
                                style="background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 8px; padding: 1rem; margin-top: 1rem;">
                                <h3 style="margin-top: 0; color: #155724;"><i class="fas fa-trophy"></i> Winning Concept
                                </h3>
                                <p id="winning-concept-name"
                                    style="font-size: 1.2rem; font-weight: 800; color: #155724;">-</p>
                                <p id="winning-concept-score" style="color: #0c5460;">Score: <span
                                        id="score-value">1</span></p>
                            </div>
                        </div>

                        <div class="matrix-actions" style="margin-top: 2rem;">
                            <button id="exportBtn" disabled><i class="fas fa-file-excel"></i> Export to Excel</button>
                            <button onclick="switchWizardTab('tab-input')" style="background-color: #6c757d;"><i
                                    class="fas fa-edit"></i> Edit Matrix</button>
                        </div>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab btn-prev" onclick="switchWizardTab('tab-input')"><i
                                class="fas fa-arrow-left"></i> Back to Data Input & Matrix</button>
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-theory')">Back to Theory <i
                                class="fas fa-book"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer role="contentinfo">
        <div class="disclaimer-note">
            <p><strong>Disclaimer:</strong> The tools and information provided on Sigma Exacta are for informational and
                educational purposes only. This tool is based on established methodologies in product design and
                decision theory. The tools on this site are independent implementations and are not affiliated with,
                sponsored by, or endorsed by the original creators of these methodologies. While we strive for accuracy,
                we make no warranty or guarantee regarding the results. All decisions and actions based on the output of
                this tool are the sole responsibility of the user. Sigma Exacta and its creators are not liable for any
                damages or losses resulting from the use of this website.</p>
        </div>
    </footer>

    <script>
        // ============================================
        // VARIABLES GLOBALES Y FUNCIONES GLOBALES
        // ============================================

        // Variables globales para almacenar datos
        let criteriaData = [];
        let conceptsData = [];
        let matrixGenerated = false;
        let matrixData = null;

        // Función para obtener valores de una lista de inputs
        function getValuesFromList(list) {
            if (!list) return [];
            return Array.from(list.querySelectorAll('input')).map(input => input.value.trim()).filter(val => val !== '');
        }

        // Función para cambiar entre tabs
        function switchWizardTab(tabId) {
            // Quitar clase active de todos los botones y contenidos de wizard
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.wizard-tab-content').forEach(content => content.classList.remove('active'));

            // Activar el contenido seleccionado
            document.getElementById(tabId).classList.add('active');

            // Activar botón correspondiente
            const activeBtn = document.querySelector(`button[onclick="switchWizardTab('${tabId}')"]`);
            if (activeBtn) activeBtn.classList.add('active');

            // Scroll al top suavemente
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Función para guardar datos de entrada
        function saveInputData() {
            const criteriaList = document.getElementById('criteria-list');
            const conceptsList = document.getElementById('concepts-list');

            if (criteriaList) {
                criteriaData = getValuesFromList(criteriaList);
            }

            if (conceptsList) {
                conceptsData = getValuesFromList(conceptsList);
            }

            // Actualizar contadores en Data Input tab
            const criteriaCount = document.getElementById('criteria-count');
            const conceptsCount = document.getElementById('concepts-count');
            if (criteriaCount) criteriaCount.textContent = criteriaData.length;
            if (conceptsCount) conceptsCount.textContent = conceptsData.length;

            // Mostrar/ocultar resumen de datos
            const dataSummary = document.getElementById('data-summary');
            if (dataSummary) {
                if (criteriaData.length > 0 || conceptsData.length > 0) {
                    dataSummary.style.display = 'block';
                } else {
                    dataSummary.style.display = 'none';
                }
            }
        }

        // Función para validar datos de entrada
        function validateDataInput() {
            const criteriaList = document.getElementById('criteria-list');
            const conceptsList = document.getElementById('concepts-list');

            if (!criteriaList || !conceptsList) return;

            const criteria = getValuesFromList(criteriaList);
            const concepts = getValuesFromList(conceptsList);

            // Habilitar/deshabilitar botón para ir a Results
            const goToResultsBtn = document.getElementById('go-to-results-btn');
            if (goToResultsBtn) {
                if (criteria.length >= 1 && concepts.length >= 2) {
                    goToResultsBtn.disabled = false;
                } else {
                    goToResultsBtn.disabled = true;
                }
            }
        }

        // Función para ir a Results
        function goToResults() {
            if (matrixGenerated) {
                switchWizardTab('tab-results');
                updateResultsView();
            } else {
                alert('Please generate the matrix first in the Data Input & Matrix tab.');
            }
        }

        // Función para actualizar la vista de resultados
        function updateResultsView() {
            if (!matrixGenerated) return;

            const resultsContainer = document.getElementById('results-matrix-container');
            const resultsSummary = document.getElementById('results-summary');
            const exportBtn = document.getElementById('exportBtn');

            // Clonar la matriz para la vista de resultados
            const table = document.getElementById('interactiveMatrix');
            if (!table) return;

            const tableClone = table.cloneNode(true);

            // Hacer la matriz de solo lectura
            tableClone.querySelectorAll('input, select').forEach(el => {
                if (el.tagName === 'SELECT') {
                    const optionText = el.options[el.selectedIndex].text;
                    const cell = el.closest('td') || el.closest('th');
                    cell.innerHTML = `<strong>${optionText}</strong>`;
                } else if (el.tagName === 'INPUT') {
                    const value = el.value;
                    const cell = el.closest('td') || el.closest('th');
                    cell.innerHTML = `<strong>${value}</strong>`;
                }
            });

            if (resultsContainer) {
                resultsContainer.innerHTML = '';
                resultsContainer.appendChild(tableClone);
            }

            // Mostrar resumen de resultados
            if (resultsSummary) {
                resultsSummary.style.display = 'block';
            }

            // Encontrar el concepto ganador
            const totalCells = table.querySelectorAll('.total-row td[data-concept-index]');
            let maxScore = -Infinity;
            let winningIndex = -1;
            let winningScore = 0;
            const baselineSelector = document.getElementById('baseline-selector');
            let baselineIndex = 0;

            if (baselineSelector) {
                baselineIndex = parseInt(baselineSelector.value);
            }

            totalCells.forEach((cell, index) => {
                if (index !== baselineIndex) {
                    const score = parseInt(cell.textContent) || 0;
                    if (score > maxScore) {
                        maxScore = score;
                        winningIndex = index;
                        winningScore = score;
                    }
                }
            });

            // Mostrar concepto ganador
            const winningConceptName = document.getElementById('winning-concept-name');
            const scoreValue = document.getElementById('score-value');
            const winningConceptDiv = document.getElementById('winning-concept');

            if (winningConceptName && scoreValue && winningConceptDiv) {
                if (winningIndex !== -1 && maxScore > 0) {
                    const winningConcept = conceptsData[winningIndex];
                    winningConceptName.textContent = winningConcept;
                    scoreValue.textContent = winningScore;
                } else {
                    winningConceptName.textContent = 'No clear winner';
                    scoreValue.textContent = '0';
                    winningConceptDiv.style.backgroundColor = '#f8d7da';
                    winningConceptDiv.style.borderColor = '#f5c6cb';
                    winningConceptDiv.querySelector('h3').style.color = '#721c24';
                }
            }

            // Habilitar botón de exportación
            if (exportBtn) {
                exportBtn.disabled = false;
            }
        }

        // Función para inicializar el menú de navegación
        function initializeNavigationMenu() {
            const navToggle = document.getElementById('nav-toggle');
            const navMenu = document.getElementById('nav-menu');
            const toolsDropdownToggle = document.getElementById('tools-dropdown-toggle');
            const toolsDropdownMenu = document.getElementById('tools-dropdown-menu');
            const toolsDropdownContainer = document.getElementById('tools-dropdown-container');

            if (navToggle && navMenu) {
                navToggle.addEventListener('click', () => {
                    navMenu.classList.toggle('show-menu');
                    const icon = navToggle.querySelector('i');
                    icon.classList.toggle('fa-bars');
                    icon.classList.toggle('fa-times');

                    if (!navMenu.classList.contains('show-menu')) {
                        toolsDropdownMenu.classList.remove('show-submenu');
                        toolsDropdownContainer.classList.remove('active');
                    }
                });
            }

            if (toolsDropdownToggle && toolsDropdownMenu) {
                toolsDropdownToggle.addEventListener('click', (event) => {
                    if (window.innerWidth <= 992) {
                        event.preventDefault();
                        toolsDropdownMenu.classList.toggle('show-submenu');
                        toolsDropdownContainer.classList.toggle('active');
                    }
                });
            }
        }

        // Funciones para los botones globales
        function loadExampleData() {
            const criteriaList = document.getElementById('criteria-list');
            const conceptsList = document.getElementById('concepts-list');

            if (!criteriaList || !conceptsList) return;

            // Cambiar a la pestaña de entrada de datos
            switchWizardTab('tab-input');

            // Cargar datos de ejemplo
            const exampleCriteria = ['Manufacturing Cost', 'Weight', 'Durability & Strength', 'Appearance', 'Ease of Assembly'];
            const exampleConcepts = ['Standard Plastic Case', 'Machined Aluminum Case', '3D Printed Case'];

            // Limpiar listas existentes
            criteriaList.innerHTML = '';
            conceptsList.innerHTML = '';

            // Agregar criterios de ejemplo
            exampleCriteria.forEach((criterion, i) => {
                const div = document.createElement('div');
                div.className = 'input-item';
                div.innerHTML = `
                    <input type="text" placeholder="Criterion ${i + 1}" value="${criterion}" required>
                    <button type="button" class="action-button remove-btn" title="Remove Item">-</button>
                `;
                criteriaList.appendChild(div);
            });

            // Agregar conceptos de ejemplo
            exampleConcepts.forEach((concept, i) => {
                const div = document.createElement('div');
                div.className = 'input-item';
                div.innerHTML = `
                    <input type="text" placeholder="Concept ${i + 1}" value="${concept}" required>
                    <button type="button" class="action-button remove-btn" title="Remove Item">-</button>
                `;
                conceptsList.appendChild(div);
            });

            // Actualizar datos
            validateDataInput();
            saveInputData();

            // Mostrar notificación
            showNotification("Example data loaded successfully!");
        }

        function resetAllData() {
            if (confirm('Are you sure you want to reset all data? This will clear all criteria, concepts, and the matrix.')) {
                const criteriaList = document.getElementById('criteria-list');
                const conceptsList = document.getElementById('concepts-list');

                if (criteriaList) criteriaList.innerHTML = '';
                if (conceptsList) conceptsList.innerHTML = '';

                criteriaData = [];
                conceptsData = [];
                matrixGenerated = false;
                matrixData = null;

                validateDataInput();
                saveInputData();

                // Limpiar matriz
                const matrixContainer = document.getElementById('matrix-container');
                if (matrixContainer) {
                    matrixContainer.innerHTML = `<p style="color: #7f8c8d; text-align: center; padding: 2rem;">
                        <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                        Click "Generate Matrix" to create your Pugh Matrix.
                    </p>`;
                }

                // Limpiar resultados
                const resultsContainer = document.getElementById('results-matrix-container');
                if (resultsContainer) {
                    resultsContainer.innerHTML = `<p style="color: #7f8c8d; text-align: center; padding: 2rem;">
                        <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                        Complete the matrix in the "Data Input & Matrix" tab to see results here.
                    </p>`;
                }

                const resultsSummary = document.getElementById('results-summary');
                if (resultsSummary) resultsSummary.style.display = 'none';

                // Deshabilitar botón de exportación
                const exportBtn = document.getElementById('exportBtn');
                if (exportBtn) exportBtn.disabled = true;

                // Cambiar a pestaña de entrada
                switchWizardTab('tab-input');

                showNotification("All data has been reset.");
            }
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background-color: var(--performance-color);
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                animation: slideIn 0.3s ease;
                max-width: 300px;
                font-weight: 600;
            `;

            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes fadeOut {
                    from { opacity: 1; }
                    to { opacity: 0; }
                }
            `;
            document.head.appendChild(style);

            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.5s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 500);
            }, 3000);
        }

        // ============================================
        // CÓDIGO PRINCIPAL CUANDO EL DOM ESTÁ LISTO
        // ============================================
        document.addEventListener("DOMContentLoaded", function () {
            // Cargar el header desde header.html
            fetch('header.html')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(data => {
                    const headerContainer = document.getElementById('header-container');
                    if (headerContainer) {
                        headerContainer.innerHTML = data;
                    }
                    // Inicializar el menú después de cargar el header
                    initializeNavigationMenu();
                })
                .catch(error => {
                    console.error('Error loading header:', error);
                });

            // Configurar botones globales
            const globalLoadExampleBtn = document.getElementById('globalLoadExampleBtn');
            const globalResetBtn = document.getElementById('globalResetBtn');

            if (globalLoadExampleBtn) {
                globalLoadExampleBtn.addEventListener('click', loadExampleData);
            }

            if (globalResetBtn) {
                globalResetBtn.addEventListener('click', resetAllData);
            }

            // LÓGICA DE LA MATRIZ DE PUGH
            const criteriaList = document.getElementById('criteria-list');
            const conceptsList = document.getElementById('concepts-list');
            const addCriterionBtn = document.getElementById('add-criterion-btn');
            const addConceptBtn = document.getElementById('add-concept-btn');
            const fillExampleBtn = document.getElementById('fillExampleBtn');
            const clearDataBtn = document.getElementById('clearDataBtn');
            const generateMatrixBtn = document.getElementById('generateMatrixBtn');
            const exportBtn = document.getElementById('exportBtn');

            const createInputItem = (placeholder) => {
                const div = document.createElement('div');
                div.className = 'input-item';
                div.innerHTML = `
      <input type="text" placeholder="${placeholder}" required>
      <button type="button" class="action-button remove-btn" title="Remove Item">-</button>
    `;
                return div;
            };

            const addInputToList = (list, placeholder) => {
                if (!list) return;
                const newItem = createInputItem(placeholder);
                list.appendChild(newItem);
                newItem.querySelector('input').focus();
                validateDataInput();
                saveInputData();
            };

            if (addCriterionBtn && criteriaList) {
                addCriterionBtn.addEventListener('click', () => addInputToList(criteriaList, `Criterion ${criteriaList.children.length + 1}`));
            }

            if (addConceptBtn && conceptsList) {
                addConceptBtn.addEventListener('click', () => addInputToList(conceptsList, `Concept ${conceptsList.children.length + 1}`));
            }

            const handleRemove = (e) => {
                if (e.target.classList.contains('remove-btn')) {
                    e.target.parentElement.remove();
                    validateDataInput();
                    saveInputData();
                }
            };

            if (criteriaList) {
                criteriaList.addEventListener('click', handleRemove);
            }

            if (conceptsList) {
                conceptsList.addEventListener('click', handleRemove);
            }

            const populateList = (list, items, placeholderPrefix) => {
                if (!list) return;
                list.innerHTML = '';
                items.forEach((itemText, i) => {
                    const item = createInputItem(`${placeholderPrefix} ${i + 1}`);
                    item.querySelector('input').value = itemText;
                    list.appendChild(item);
                });
                validateDataInput();
                saveInputData();
            };

            const initInputs = () => {
                if (criteriaList && conceptsList) {
                    populateList(criteriaList, ['Criterion 1', 'Criterion 2', 'Criterion 3'], 'Criterion');
                    populateList(conceptsList, ['Concept A', 'Concept B'], 'Concept');
                }
            };

            if (fillExampleBtn) {
                fillExampleBtn.addEventListener('click', () => {
                    if (criteriaList && conceptsList) {
                        populateList(criteriaList, ['Manufacturing Cost', 'Weight', 'Durability & Strength', 'Appearance', 'Ease of Assembly'], 'Criterion');
                        populateList(conceptsList, ['Standard Plastic Case', 'Machined Aluminum Case', '3D Printed Case'], 'Concept');
                    }
                });
            }

            if (clearDataBtn) {
                clearDataBtn.addEventListener('click', resetAllData);
            }

            if (generateMatrixBtn) {
                generateMatrixBtn.addEventListener('click', function () {
                    if (criteriaData.length < 1 || conceptsData.length < 2) {
                        alert('⚠️ Please enter at least 1 criterion and 2 concepts.');
                        return;
                    }

                    generateMatrix();
                });
            }

            function generateMatrix() {
                const matrixContainer = document.getElementById('matrix-container');
                if (!matrixContainer) return;

                const now = new Date();
                const day = now.getDate();
                const month = now.getMonth() + 1;
                const year = now.getFullYear();
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');

                const timestamp = `${day}/${month}/${year}, ${hours}:${minutes}:${seconds}`;

                let tableHTML = `<div style="display: flex; align-items: center; gap: 15px; margin-bottom: 1rem; flex-wrap: wrap; color: #7f8c8d; font-size: 0.9em;">
            <img src="sigma-exacta-icon.jpg" alt="SigmaExacta Logo" style="height: 35px; width: 35px; border-radius: 5px;">
            <span>Generated on: ${timestamp}</span>
        </div>`;

                tableHTML += `<table class="pugh-matrix" id="interactiveMatrix"><thead><tr>`;
                let baselineOptions = conceptsData.map((con, i) => `<option value="${i}">${con}</option>`).join('');
                tableHTML += `
          <th class="criterion-cell">
              Criteria
              <div style="margin-top:10px;">
                <label for="baseline-selector" style="font-size: 0.8em; color: white; margin: 0; display:inline-block;">Baseline:</label>
                <select id="baseline-selector" class="score-select" style="width:auto; min-width:100px; display:inline-block; vertical-align:middle;">${baselineOptions}</select>
              </div>
          </th>
          <th>Weight</th>`;
                conceptsData.forEach((concept, index) => {
                    tableHTML += `<th data-concept-index="${index}">${concept}</th>`;
                });
                tableHTML += `</tr></thead><tbody>`;
                criteriaData.forEach((criterion, critIndex) => {
                    tableHTML += `<tr data-criterion-index="${critIndex}">`;
                    tableHTML += `<td class="criterion-cell">${criterion}</td>`;
                    tableHTML += `<td><input type="number" class="weight-input" value="1" min="1"></td>`;
                    conceptsData.forEach((concept, conIndex) => {
                        tableHTML += `<td data-concept-index="${conIndex}">
                  <select class="score-select">
                      <option value="1">+</option><option value="0" selected>S</option><option value="-1">-</option>
                  </select>
              </td>`;
                    });
                    tableHTML += `</tr>`;
                });
                tableHTML += `</tbody><tfoot><tr class="total-row"><td><strong>TOTALS</strong></td><td></td>`;
                conceptsData.forEach((concept, index) => {
                    tableHTML += `<td data-concept-index="${index}">0</td>`;
                });
                tableHTML += `</tr></tfoot></table>`;

                matrixContainer.innerHTML = tableHTML;

                matrixGenerated = true;
                const goToResultsBtn = document.getElementById('go-to-results-btn');
                if (goToResultsBtn) goToResultsBtn.disabled = false;

                const baselineSelector = document.getElementById('baseline-selector');
                if (baselineSelector) {
                    baselineSelector.addEventListener('change', updateScores);
                }

                document.querySelectorAll('.weight-input, .score-select').forEach(el => el.addEventListener('change', updateScores));

                updateScores();
            }

            function updateScores() {
                const table = document.getElementById('interactiveMatrix');
                if (!table) return;

                const baselineSelector = document.getElementById('baseline-selector');
                if (!baselineSelector) return;

                const baselineIndex = parseInt(baselineSelector.value);
                const concepts = Array.from(table.querySelectorAll('thead th[data-concept-index]'));
                const criteriaRows = table.querySelectorAll('tbody tr');
                const totals = Array(concepts.length).fill(0);

                concepts.forEach((th, index) => {
                    const cells = table.querySelectorAll(`td[data-concept-index="${index}"]`);
                    if (index === baselineIndex) {
                        th.classList.add('baseline-cell');
                        cells.forEach(cell => {
                            cell.classList.add('baseline-cell');
                            cell.innerHTML = '<strong>B</strong>';
                        });
                        const totalCell = table.querySelector(`.total-row td[data-concept-index="${index}"]`);
                        if (totalCell) totalCell.classList.add('baseline-cell');
                    } else {
                        th.classList.remove('baseline-cell');
                        cells.forEach(cell => {
                            if (!cell.querySelector('select')) {
                                cell.innerHTML = `<select class="score-select"><option value="1">+</option><option value="0" selected>S</option><option value="-1">-</option></select>`;
                                cell.querySelector('select').addEventListener('change', updateScores);
                            }
                            cell.classList.remove('baseline-cell');
                        });
                        const totalCell = table.querySelector(`.total-row td[data-concept-index="${index}"]`);
                        if (totalCell) totalCell.classList.remove('baseline-cell');
                    }
                });

                criteriaRows.forEach(row => {
                    const weightInput = row.querySelector('.weight-input');
                    const weight = weightInput ? parseInt(weightInput.value) || 0 : 0;
                    concepts.forEach((th, conIndex) => {
                        if (conIndex !== baselineIndex) {
                            const scoreSelect = row.querySelector(`td[data-concept-index="${conIndex}"] select`);
                            if (scoreSelect) {
                                const score = parseInt(scoreSelect.value);
                                totals[conIndex] += score * weight;
                            }
                        }
                    });
                });

                const totalCells = table.querySelectorAll('.total-row td[data-concept-index]');
                totalCells.forEach((cell, index) => {
                    cell.textContent = (index === baselineIndex) ? '0' : totals[index];
                });

                highlightWinner(totals, baselineIndex);
            }

            function highlightWinner(totals, baselineIndex) {
                const table = document.getElementById('interactiveMatrix');
                if (!table) return;

                let maxScore = -Infinity;
                let winnerIndex = -1;

                table.querySelectorAll('.winning-column, .winning-column-header').forEach(el => {
                    el.classList.remove('winning-column', 'winning-column-header');
                });

                totals.forEach((score, index) => {
                    if (index !== baselineIndex && score > maxScore) {
                        maxScore = score;
                        winnerIndex = index;
                    }
                });

                const isDraw = totals.filter((score, index) => index !== baselineIndex && score === maxScore).length > 1;

                if (winnerIndex !== -1 && maxScore > 0 && !isDraw) {
                    const winnerHeader = table.querySelector(`thead th[data-concept-index="${winnerIndex}"]`);
                    if (winnerHeader) winnerHeader.classList.add('winning-column-header');
                    table.querySelectorAll(`tbody td[data-concept-index="${winnerIndex}"], tfoot td[data-concept-index="${winnerIndex}"]`).forEach(cell => {
                        cell.classList.add('winning-column');
                    });
                }
            }

            if (exportBtn) {
                exportBtn.addEventListener('click', function () {
                    const table = document.getElementById('interactiveMatrix');
                    if (!table) {
                        alert("No matrix to export.");
                        return;
                    }
                    const tableClone = table.cloneNode(true);

                    tableClone.querySelectorAll('input, select').forEach(el => {
                        const cell = el.closest('td') || el.closest('th');
                        if (el.id === 'baseline-selector') {
                            cell.querySelector('label').remove();
                            cell.querySelector('select').remove();
                            cell.innerHTML += `<br>Baseline: ${el.options[el.selectedIndex].text}`;
                        } else if (el.classList.contains('score-select')) {
                            cell.textContent = el.options[el.selectedIndex].text;
                        }
                        else {
                            cell.textContent = el.value;
                        }
                    });

                    const wb = XLSX.utils.table_to_book(tableClone, { sheet: "Pugh Matrix" });
                    XLSX.writeFile(wb, "Pugh_Matrix_Sigma_Exacta.xlsx");
                });
            }

            // Inicializar con campos por defecto
            initInputs();
        });
    </script>

</body>

</html>
