<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDCA Cycle (Plan-Do-Check-Act) | Deming Wheel | Sigma Exacta</title>
    <link rel="canonical" href="https://sigmaexacta.com/pdca" />
    <meta name="description" content="Free online interactive PDCA (Plan-Do-Check-Act) tool to implement continuous improvement. Follow the Deming Wheel methodology for structured problem-solving and process optimization.">
    <meta name="keywords" content="SigmaExacta, Opensource, Free software, PDCA, Plan-Do-Check-Act, Deming Wheel, Deming Cycle, Shewhart Cycle, continuous improvement, quality management, free tool, W. Edwards Deming">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="sigma-exacta-icon.jpg" type="image/jpeg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css">

    <style>
        /* --- Estilos base para la barra de navegación --- */
        .top-bar {
            /* === MODIFICACIÓN: Header fijo al hacer scroll === */
            position: sticky; /* Cambiado de 'relative' para que la barra se fije en la parte superior */
            top: 0;           /* Se posiciona en el borde superior de la ventana */
            z-index: 1001;    /* Se asegura que esté por encima de otro contenido al hacer scroll */
            /* === FIN DE LA MODIFICACIÓN === */
            
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background-color: #222; /* Un negro suave, puedes cambiarlo por #000 */
        }
        .logo-text, .navigation .nav-link, .nav-toggle {
            color: #fff; /* Color blanco para el texto y el icono */
        }

        .nav-toggle {
            display: none; 
            font-size: 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
        }

        .navigation .nav-menu {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
            align-items: center;
        }

        .navigation .nav-link {
            padding: 10px 15px;
            text-decoration: none;
            font-weight: 600;
            display: block;
        }
        
        .navigation .nav-link i {
            margin-left: 5px;
            transition: transform 0.3s ease;
        }
        
        /* --- Estilos para el menú desplegable (escritorio) --- */
        .nav-item-dropdown {
            position: relative;
        }
        
        .dropdown-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background-color: #fff; /* Fondo blanco para el desplegable */
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
            border-radius: 5px;
            z-index: 1000;
            min-width: 600px;
            padding: 20px;
        }
        
        /* === CORRECCIÓN: Asegura que el texto dentro del desplegable sea oscuro === */
        .dropdown-menu a, .dropdown-menu h4 {
            color: #333;
        }
        .dropdown-link:hover {
            background-color: #f1f1f1;
        }


        .dropdown-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }

        .nav-item-dropdown:hover > .dropdown-menu {
            display: block;
        }

        /* --- ESTILOS PARA MÓVIL (LA PARTE IMPORTANTE) --- */
        @media (max-width: 992px) {
            .nav-toggle {
                display: block;
            }

            .navigation .nav-menu {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background-color: #fff; /* Fondo blanco para el menú desplegado */
                border-top: 1px solid #eee;
            }
            
            /* === CORRECCIÓN: Asegura que los enlaces sean oscuros sobre el fondo blanco del menú móvil === */
            .navigation .nav-menu .nav-link {
                color: #333; 
            }

            .navigation .nav-menu.show-menu {
                display: flex;
            }
            
            .navigation .nav-item {
                width: 100%;
                text-align: left;
            }

            .nav-item-dropdown > .nav-link {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .dropdown-menu {
                display: none; 
                position: static; 
                width: 100%;
                box-shadow: none;
                border-top: 1px solid #f0f0f0;
                padding: 10px 0 10px 30px;
                min-width: unset;
                background-color: #f9f9f9;
            }

            .dropdown-menu.show-submenu {
                display: block;
            }
            
            .dropdown-grid {
                grid-template-columns: 1fr;
            }

            .nav-item-dropdown:hover > .dropdown-menu {
                display: none;
            }
            .nav-item-dropdown.active:hover > .dropdown-menu {
                display: block;
            }
            
            .nav-item-dropdown.active > .nav-link i {
                transform: rotate(180deg);
            }
        }
        /* --- FIN CSS DEL HEADER --- */

        /* Estilo AÑADIDO para el icono PDCA: tamaño y forma definidos */
        .main-tool-logo {
            width: 50px; 
            height: 50px; 
            border-radius: 18px; 
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff; 
            font-size: 1.8rem; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); 
            flex-shrink: 0; 
            margin-right: 15px; /* Espacio entre el icono y el texto */
        }
        .main-tool-logo[data-color='9'] { 
            background-color: #7ed321; 
        }

        /* Estilos específicos para PDCA */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            font-size: 16px;
        }
        
        body {
            background-color: #f5f7fa;
            font-family: 'Nunito', sans-serif;
            color: #333;
            margin: 0;
        }
        
        .main-content-wrapper { max-width: 1000px; margin: 20px auto; padding: 1.25rem; }

        .header { margin-bottom: 1.25rem; padding-bottom: 1rem; border-bottom: 1px solid #ddd; text-align: center; }
        /* REGLA MODIFICADA para incluir la alineación flex */
        .header h1 { 
            color: var(--primary-color); 
            font-size: clamp(1.5rem, 4vw, 1.8rem); 
            margin: 0.5rem 0; 
            font-weight: 800;
            /* Nuevas propiedades para alinear el icono: */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .header .header-subtitle { font-size: 1.1rem; color: #7f8c8d; margin: 0; font-weight: 400; }

        .content-block {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            background-color: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .content-block h2 {
            font-size: 1.5em; margin-top: 0; margin-bottom: 1.25rem;
            color: var(--primary-color); border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.6rem; font-weight: 800;
        }
        .content-block h2 .fas { margin-right: 0.75rem; }
        
        .infographic-flow { 
            display: flex; 
            justify-content: space-between; 
            align-items: stretch; 
            margin-top: 1.5rem; 
            text-align: center; 
            flex-wrap: wrap; 
            gap: 0.6rem;
        }
        .flow-step { flex: 1; min-width: 150px; padding: 1rem; border: 1px solid #ddd; border-radius: 8px; background-color: #f8f9fa; transition: transform 0.2s, box-shadow 0.2s; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .flow-step:hover { transform: translateY(-5px); box-shadow: 0 6px 12px rgba(0,0,0,0.1); }
        .flow-step .fas { font-size: 1.8rem; color: var(--primary-color); margin-bottom: 0.6rem; }
        .flow-step strong { display: block; font-size: 1.1rem; color: var(--primary-color); font-weight: 600; }
        .flow-step span { font-size: 0.9em; color: #555; }
        .flow-arrow { font-size: 2rem; color: var(--secondary-color); margin: auto 0.6rem; flex-grow: 0; }

        .instructions-box ul { margin: 0.6rem 0 0 0; padding-left: 1.25rem; }
        .instructions-box li { margin-bottom: 0.5rem; line-height: 1.6; }
        
        .cycle-step { border: 1px solid #eee; border-radius: 8px; padding: 1.25rem; margin-bottom: 1.25rem; background-color: #fdfdfd; }
        .cycle-step h3 { font-size: 1.2em; margin-top: 0; margin-bottom: 1rem; color: var(--primary-color); border-bottom: 1px solid #eee; padding-bottom: 0.6rem; font-weight: 800; }
        .cycle-step h3 .fas { margin-right: 0.5rem; }
        .form-group { margin-bottom: 1.25rem; }
        
        label { color: var(--primary-color); font-weight: 600; display: block; margin-bottom: 0.5rem; }
        textarea {
            width: 100%; padding: 0.6rem; border: 1px solid #ddd; border-radius: 4px;
            transition: border 0.3s, box-shadow 0.3s; font-size: 1rem; font-family: 'Nunito', sans-serif;
            min-height: 45px;
            resize: none;
            overflow-y: hidden;
            box-sizing: border-box; /* Previene desbordamiento por padding */
        }
        textarea:focus, button:focus-visible {
            outline: none; border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        button {
            background-color: var(--secondary-color); color: white; padding: 0.7rem 1.25rem;
            border: none; border-radius: 4px; cursor: pointer; margin: 5px;
            font-size: 1rem; transition: background-color 0.3s;
            font-family: 'Nunito', sans-serif; font-weight: 600;
        }
        .btn-success { background-color: var(--success-color); }
        .btn-success:hover { background-color: #219653; }
        .btn-warning { background-color: var(--warning-color); }
        .btn-warning:hover { background-color: #d4ac0d; }
        #generate-report-button { width: 100%; padding: 1rem; font-size: 1.2em; font-weight: bold; margin-top: 1.25rem; box-sizing: border-box; }
        #generate-report-button:hover { background-color: #2980b9; }

        .hidden { display: none; }
        
        #results-container { border: 2px solid var(--success-color); background-color: #f8fef8; border-radius: 8px; padding: 1.25rem; margin-top: 1.5rem; }
        #results-container h3 { color: var(--success-color); font-weight: 800; }
        .results-summary { border-left: 3px solid var(--secondary-color); padding-left: 1rem; margin-bottom: 1.5rem; }
        .results-summary h4 { margin: 0 0 0.5rem 0; color: var(--dark-color); }
        .results-summary p { white-space: pre-wrap; margin: 0; background: #fff; padding: 0.5rem; border-radius: 4px; border: 1px solid #eee; word-break: break-word; }
        
        .results-actions { margin-top: 1.25rem; padding-top: 1.25rem; border-top: 1px solid #eee; }

        footer[role="contentinfo"] { background-color: #222; color: #ccc; padding: 50px 20px; text-align: center; }
        .disclaimer-note { margin-top: 2rem; padding: 0 1rem; font-size: 0.8rem; color: #a0a0a0; max-width: 800px; margin-left: auto; margin-right: auto; line-height: 1.8; }
        
        @media (max-width: 992px) {
            .infographic-flow { flex-direction: column; align-items: center; }
            .flow-arrow { display: none; }
        }
    </style>
</head>
<body>

<header role="banner" class="top-bar">
    <a href="index.html" class="logo-container-link">
        <div class="logo-container">
            <img src="sigma-exacta-icon.jpg" alt="SigmaExacta Logo" class="main-logo">
            <span class="logo-text">SigmaExacta</span>
        </div>
    </a>
    <nav class="navigation">
        <button class="nav-toggle" id="nav-toggle" aria-label="Toggle navigation menu">
            <i class="fas fa-bars"></i>
        </button>
        <ul class="nav-menu" id="nav-menu">
            <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
            <li class="nav-item nav-item-dropdown" id="tools-dropdown-container">
                <a href="#" class="nav-link" id="tools-dropdown-toggle">Tools <i class="fas fa-chevron-down"></i></a>
                <div class="dropdown-menu" id="tools-dropdown-menu">
                    <div class="dropdown-grid">
                        <div class="dropdown-column">
                            <h4 class="dropdown-category">Process & Quality</h4>
                            <a href="cpk_calculator.html" class="dropdown-link">Cpk Calculator</a>
                            <a href="control-plan.html" class="dropdown-link">Control Plan Creator</a>
                            <a href="weibull.html" class="dropdown-link">Weibull Analysis</a>
                            <a href="pdca.html" class="dropdown-link">PDCA Cycle</a>
                        </div>
                        <div class="dropdown-column">
                            <h4 class="dropdown-category">Design & Innovation</h4>
                            <a href="stack_up_analysis.html" class="dropdown-link">Tolerance Stack-up</a>
                            <a href="taguchi_doe.html" class="dropdown-link">Robust Design (DOE)</a>
                            <a href="fmea.html" class="dropdown-link">FMEA</a>
                            <a href="qfd.html" class="dropdown-link">QFD (House of Quality)</a>
                            <a href="pugh.html" class="dropdown-link">Pugh Matrix</a>
                            <a href="vave.html" class="dropdown-link">VAVE Analysis</a>
                            <a href="design_thinking.html" class="dropdown-link">Design Thinking</a>
                            <a href="kano.html" class="dropdown-link">Kano Model</a>
                        </div>
                        <div class="dropdown-column">
                            <h4 class="dropdown-category">Problem Solving</h4>
                            <a href="8d.html" class="dropdown-link">8D Report</a>
                            <a href="ishikawa.html" class="dropdown-link">Ishikawa Diagram</a>
                            <a href="triz.html" class="dropdown-link">TRIZ</a>
                            <a href="eisenhower.html" class="dropdown-link">Eisenhower Matrix</a>
                        </div>
                         <div class="dropdown-column">
                            <h4 class="dropdown-category">Strategy & Management</h4>
                            <a href="apqp-ppap.html" class="dropdown-link">APQP & PPAP Planner</a>
                            <a href="balancedcard.html" class="dropdown-link">Strategic Scorecard</a>
                            <a href="swot.html" class="dropdown-link">SWOT Analysis</a>
                            <a href="efqm.html" class="dropdown-link">Maturity Assessment</a>
                        </div>
                    </div>
                </div>
            </li>
            <li class="nav-item"><a href="documentation.html" class="nav-link">Documentation</a></li>
            <li class="nav-item"><a href="mailto:sigmaexacta@gmail.com" class="nav-link">Contact</a></li>
        </ul>
    </nav>
</header>

<main class="main-content-wrapper">
    <header class="header">
        <h1>
            <div class="main-tool-logo" data-color="9"><i class="fas fa-sync-alt"></i></div>
            Free Online Plan-Do-Check-Act (PDCA) Cycle Tool (Deming Wheel)
        </h1>
        <p class="header-subtitle">A structured four-phase model for continuous improvement and quality management.</p>
    </header>

    <div class="content-block">
        <h2><i class="fas fa-question-circle"></i> What is the PDCA Cycle?</h2>
        <p>The <strong>PDCA Cycle</strong> (Plan-Do-Check-Act), also known as the Deming Wheel or Shewhart Cycle, is a systematic, iterative four-stage approach for continuous improvement in processes and products. It provides a simple but powerful framework for solving problems, managing change, and implementing quality control.</p>
        <p>By repeatedly cycling through the four phases, organizations can refine their processes, identify root causes of problems, and create a culture of continuous learning and improvement.</p>
        <div class="infographic-flow">
            <div class="flow-step"><i class="fas fa-clipboard-list"></i><strong>1. Plan</strong><span>Identify goal & plan action.</span></div>
            <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
            <div class="flow-step"><i class="fas fa-cogs"></i><strong>2. Do</strong><span>Implement the plan.</span></div>
            <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
            <div class="flow-step"><i class="fas fa-chart-line"></i><strong>3. Check</strong><span>Analyze the results.</span></div>
            <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
            <div class="flow-step"><i class="fas fa-bullhorn"></i><strong>4. Act</strong><span>Standardize or adjust.</span></div>
        </div>
    </div>
    
    <div class="content-block">
        <h2><i class="fas fa-history"></i> History & Origin</h2>
        <p>The concept was originally developed by American physicist and statistician <strong>Walter A. Shewhart</strong> in the 1920s, who is often called the "father of statistical quality control." Shewhart framed it as a three-step process of specification, production, and inspection for scientific learning.</p>
        <p>His mentee, <strong>Dr. W. Edwards Deming</strong>, modified and popularized the cycle in the 1950s, evolving it into the four-step "Plan-Do-Check-Act" model we know today. Deming strongly advocated for its use in Japan, where it became a cornerstone of the country's post-war industrial and manufacturing success, known as "Kaizen" (continuous improvement).</p>
    </div>

    <div class="content-block">
        <h2><i class="fas fa-tools"></i> How to Use This Tool</h2>
        <div class="instructions-box">
          <ul>
            <li><strong>Load Example:</strong> Click "Load Example" to see a pre-filled PDCA cycle for a common business problem.</li>
            <li><strong>Follow the Steps:</strong> Document your own improvement project by filling in the details for each of the four phases (Plan, Do, Check, Act).</li>
            <li><strong>Generate Report:</strong> Click "Generate PDCA Report" to create a consolidated summary of your cycle.</li>
            <li><strong>Export:</strong> Once the report is generated, you can export it to an Excel file for documentation or to share with your team.</li>
          </ul>
      </div>
    </div>

    <div class="content-block">
        <h2><i class="fas fa-sync-alt"></i> PDCA Cycle Worksheet</h2>
        <div style="text-align: center; margin-bottom: 20px;">
            <button class="btn-success" onclick="loadExample()"><i class="fas fa-magic"></i> Load Example</button>
            <button class="btn-warning" onclick="resetTool()"><i class="fas fa-sync-alt"></i> Reset Tool</button>
        </div>

        <div class="cycle-step" id="step-1">
            <h3><i class="fas fa-clipboard-list"></i> Phase 1: Plan</h3>
            <div class="form-group"><label for="plan-problem">Problem/Opportunity Statement:</label><textarea id="plan-problem" placeholder="e.g., Customer support call times are too long, averaging 12 minutes."></textarea></div>
            <div class="form-group"><label for="plan-goal">Goal/Hypothesis (What do you expect to happen?):</label><textarea id="plan-goal" placeholder="e.g., By implementing a new call script, we will reduce the average call time by 15% to 10 minutes or less within one month."></textarea></div>
            <div class="form-group"><label for="plan-actions">Action Plan (What steps will you take?):</label><textarea id="plan-actions" placeholder="e.g., 1. Develop new script. 2. Train a pilot group of 5 agents. 3. Monitor their call times for 1 week."></textarea></div>
        </div>
        
        <div class="cycle-step" id="step-2">
            <h3><i class="fas fa-cogs"></i> Phase 2: Do</h3>
            <div class="form-group"><label for="do-execution">What was executed? (Record actions taken):</label><textarea id="do-execution" placeholder="e.g., The new script was developed and deployed. Five agents from Team B were trained on the new script on Monday. They used the script for all calls from Tuesday to Friday."></textarea></div>
            <div class="form-group"><label for="do-problems">What problems or unexpected observations occurred?:</label><textarea id="do-problems" placeholder="e.g., Some veteran agents initially resisted the change, finding the script too rigid. One part of the script for 'billing issues' was found to be confusing for customers."></textarea></div>
        </div>

        <div class="cycle-step" id="step-3">
            <h3><i class="fas fa-chart-line"></i> Phase 3: Check</h3>
            <div class="form-group"><label for="check-data">Data & Results (What did the metrics show?):</label><textarea id="check-data" placeholder="e.g., Average call time for the pilot group was 9.5 minutes, an 18% reduction. Customer satisfaction scores for the pilot group remained stable (no change)."></textarea></div>
            <div class="form-group"><label for="check-analysis">Analysis (Did the results match the hypothesis?):</label><textarea id="check-analysis" placeholder="e.g., The results exceeded the goal. The script was effective in reducing call time without negatively impacting customer satisfaction. The confusing 'billing' section needs to be addressed."></textarea></div>
        </div>

        <div class="cycle-step" id="step-4">
            <h3><i class="fas fa-bullhorn"></i> Phase 4: Act</h3>
            <div class="form-group"><label for="act-conclusions">Conclusions & Learnings:</label><textarea id="act-conclusions" placeholder="e.g., The new script is a viable solution for reducing call times. Allowing for minor flexibility in the script could improve adoption among veteran agents."></textarea></div>
            <div class="form-group"><label for="act-next">Next Steps (Standardize, Adjust, or begin a new cycle?):</label><textarea id="act-next" placeholder="e.g., 1. Adjust the 'billing issues' part of the script based on feedback. 2. Standardize the revised script and roll it out to all support agents. 3. Start a new PDCA cycle to improve the first-call resolution rate."></textarea></div>
        </div>

        <button id="generate-report-button" onclick="generateReport()"><i class="fas fa-file-alt"></i> Generate PDCA Report</button>
        <div id="results-container" class="hidden"></div>
    </div>
</main>
<footer role="contentinfo">
    <div class="disclaimer-note">
        <p><strong>Disclaimer:</strong> The PDCA Cycle was developed by Walter A. Shewhart and later popularized by W. Edwards Deming. This tool is an independent implementation provided for educational and informational purposes only. It is not affiliated with, sponsored by, or endorsed by the estates of Deming or Shewhart, or their respective organizations. The effectiveness of the process depends on the user's application. Sigma Exacta and its creators are not liable for any damages or losses resulting from its use.</p>
    </div>
</footer>

<script>
    let cycleData = {};

    document.addEventListener('DOMContentLoaded', () => {
        // --- START: Lógica del Header (idéntica a index.html) ---
        const navToggle = document.getElementById('nav-toggle');
        const navMenu = document.getElementById('nav-menu');
        const toolsDropdownToggle = document.getElementById('tools-dropdown-toggle');
        const toolsDropdownMenu = document.getElementById('tools-dropdown-menu');
        const toolsDropdownContainer = document.getElementById('tools-dropdown-container');

        navToggle.addEventListener('click', () => {
            navMenu.classList.toggle('show-menu');
            const icon = navToggle.querySelector('i');
            icon.classList.toggle('fa-bars');
            icon.classList.toggle('fa-times');
            
            if (!navMenu.classList.contains('show-menu')) {
                toolsDropdownMenu.classList.remove('show-submenu');
                toolsDropdownContainer.classList.remove('active');
            }
        });
        
        toolsDropdownToggle.addEventListener('click', (event) => {
            if (window.innerWidth <= 992) {
                event.preventDefault(); 
                toolsDropdownMenu.classList.toggle('show-submenu');
                toolsDropdownContainer.classList.toggle('active');
            }
        });
        // --- END: Lógica del Header ---
        
        // Lógica específica de la página PDCA
        document.querySelectorAll('textarea').forEach(textarea => {
            textarea.addEventListener('input', function() { autoResizeTextarea(this); });
            autoResizeTextarea(textarea);
        });
    });

    function autoResizeTextarea(textarea) {
        textarea.style.height = 'auto';
        textarea.style.height = (textarea.scrollHeight) + 'px';
    }

    function resetTool() {
        cycleData = {};
        document.querySelectorAll('textarea').forEach(el => {
            el.value = '';
            autoResizeTextarea(el);
        });
        document.getElementById('results-container').classList.add('hidden');
        document.getElementById('plan-problem').focus();
    }

    function loadExample() {
        resetTool();
        document.getElementById('plan-problem').value = "Customer support call times are too long, averaging 12 minutes, which leads to lower customer satisfaction and higher costs.";
        document.getElementById('plan-goal').value = "By implementing a new streamlined call script and providing targeted training, we will reduce the average call handling time by 15% (to 10.2 minutes or less) within one month, without decreasing the customer satisfaction score.";
        document.getElementById('plan-actions').value = "1. Analyze top 5 call reasons to create a streamlined script (Week 1).\n2. Select a pilot group of 5 agents for training (Week 2).\n3. Train the pilot group on the new script (Week 2).\n4. Monitor the pilot group's call times and CSAT scores for two weeks (Weeks 3-4).";
        document.getElementById('do-execution').value = "The script was developed and deployed. Five agents from Team B were trained on Monday of Week 3. They used the script for all their calls for the following two weeks. Call data was automatically logged by the CRM.";
        document.getElementById('do-problems').value = "Initial feedback from the pilot agents was that the script felt too rigid for complex, multi-issue calls. We allowed for minor deviations after the first week based on their feedback.";
        document.getElementById('check-data').value = "Results after two weeks:\n- Average call time for the pilot group was 9.5 minutes (an 18.75% reduction).\n- Average call time for the control group (rest of the team) was 11.8 minutes.\n- Customer Satisfaction (CSAT) scores for the pilot group increased by 2%.";
        document.getElementById('check-analysis').value = "The hypothesis was confirmed: the new script significantly reduced call times. The slight increase in CSAT suggests the script did not harm the customer experience and may have improved it due to faster resolution.";
        document.getElementById('act-conclusions').value = "The streamlined script is an effective method for reducing call handling time. The key learning is that while a script provides structure, a small degree of flexibility is necessary for experienced agents to handle complex cases effectively.";
        document.getElementById('act-next').value = "1. (Standardize) Roll out the revised, slightly more flexible script to all customer support agents, with mandatory training.\n2. (Adjust) Update the standard operating procedure (SOP) to reflect the new process.\n3. (New Cycle) Begin a new PDCA cycle to tackle the 'first-call resolution rate', which was identified as the next key improvement area during analysis.";

        document.querySelectorAll('textarea').forEach(textarea => autoResizeTextarea(textarea));
        document.getElementById('plan-problem').focus();
    }

    function generateReport() {
        cycleData = {
            plan: {
                problem: document.getElementById('plan-problem').value,
                goal: document.getElementById('plan-goal').value,
                actions: document.getElementById('plan-actions').value
            },
            do: {
                execution: document.getElementById('do-execution').value,
                problems: document.getElementById('do-problems').value
            },
            check: {
                data: document.getElementById('check-data').value,
                analysis: document.getElementById('check-analysis').value
            },
            act: {
                conclusions: document.getElementById('act-conclusions').value,
                next: document.getElementById('act-next').value
            }
        };

        if (!cycleData.plan.problem && !cycleData.plan.goal) {
            alert('Please fill in at least the "Plan" phase to generate a report.');
            return;
        }
        displayResults();
    }

    function displayResults() {
        const resultsDiv = document.getElementById('results-container');
        let html = `<h3><i class="fas fa-check-circle"></i> PDCA Cycle Report Summary</h3>`;

        html += `<div class="results-summary"><h4><i class="fas fa-clipboard-list"></i> PLAN</h4><p>${cycleData.plan.problem || 'N/A'}</p><br><p>${cycleData.plan.goal || 'N/A'}</p><br><p>${cycleData.plan.actions || 'N/A'}</p></div>`;
        html += `<div class="results-summary"><h4><i class="fas fa-cogs"></i> DO</h4><p>${cycleData.do.execution || 'N/A'}</p><br><p>${cycleData.do.problems || 'N/A'}</p></div>`;
        html += `<div class="results-summary"><h4><i class="fas fa-chart-line"></i> CHECK</h4><p>${cycleData.check.data || 'N/A'}</p><br><p>${cycleData.check.analysis || 'N/A'}</p></div>`;
        html += `<div class="results-summary"><h4><i class="fas fa-bullhorn"></i> ACT</h4><p>${cycleData.act.conclusions || 'N/A'}</p><br><p>${cycleData.act.next || 'N/A'}</p></div>`;

        html += `<div class="results-actions"><button class="btn-success" onclick="exportToExcel()"><i class="fas fa-file-excel"></i> Export to Excel</button></div>`;
        
        resultsDiv.innerHTML = html;
        resultsDiv.classList.remove('hidden');
        resultsDiv.scrollIntoView({ behavior: 'smooth' });
    }

    function exportToExcel() {
        if (Object.keys(cycleData).length === 0) {
            alert("No data to export. Please generate a report first.");
            return;
        }

        const wb = XLSX.utils.book_new();
        const ws_data = [];
        ws_data.push(["PDCA Cycle Report"]);
        ws_data.push(["Company: Sigma Exacta"]);
        ws_data.push([`Date: ${new Date().toLocaleDateString()}`]);
        ws_data.push([]);

        ws_data.push(["Phase", "Category", "Details"]);
        ws_data.push(["PLAN", "Problem/Opportunity", cycleData.plan.problem]);
        ws_data.push(["", "Goal/Hypothesis", cycleData.plan.goal]);
        ws_data.push(["", "Action Plan", cycleData.plan.actions]);
        ws_data.push([]);
        ws_data.push(["DO", "Execution Record", cycleData.do.execution]);
        ws_data.push(["", "Problems/Observations", cycleData.do.problems]);
        ws_data.push([]);
        ws_data.push(["CHECK", "Data & Results", cycleData.check.data]);
        ws_data.push(["", "Analysis", cycleData.check.analysis]);
        ws_data.push([]);
        ws_data.push(["ACT", "Conclusions", cycleData.act.conclusions]);
        ws_data.push(["", "Next Steps", cycleData.act.next]);

        const ws = XLSX.utils.aoa_to_sheet(ws_data);
        ws['!cols'] = [{wch: 15}, {wch: 25}, {wch: 80}];
        XLSX.utils.book_append_sheet(wb, ws, "PDCA Report");

        const dateStr = new Date().toISOString().slice(0, 10);
        XLSX.writeFile(wb, `PDCA_Report_Sigma_Exacta_${dateStr}.xlsx`);
    }

</script>
</body>
</html>