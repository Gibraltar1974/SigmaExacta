<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>PDCA Cycle (Plan-Do-Check-Act) | Deming Wheel | Sigma Exacta</title>
    <link href="https://sigmaexacta.com/pdca" rel="canonical" />
    <meta
        content="Free online interactive PDCA (Plan-Do-Check-Act) tool to implement continuous improvement. Follow the Deming Wheel methodology for structured problem-solving and process optimization."
        name="description" />
    <meta
        content="SigmaExacta, Opensource, Free software, PDCA, Plan-Do-Check-Act, Deming Wheel, Deming Cycle, Shewhart Cycle, continuous improvement, quality management, free tool, W. Edwards Deming"
        name="keywords" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <link href="sigma-exacta-icon.jpg" rel="icon" type="image/jpeg" />
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&amp;display=swap" rel="stylesheet" />
    <link href="styles.css" rel="stylesheet" />
    <style>
        /* ===== ESTILOS PARA TABS PRINCIPALES ===== */
        .tabs-nav {
            display: flex;
            background-color: #f1f5f9;
            border-radius: 8px 8px 0 0;
            overflow-x: auto;
            border-bottom: 2px solid var(--secondary-color);
            margin-bottom: 0;
            scrollbar-width: thin;
            -ms-overflow-style: -ms-autohiding-scrollbar;
            width: 100%;
            box-sizing: border-box;
        }

        .tabs-nav::-webkit-scrollbar {
            height: 6px;
        }

        .tabs-nav::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .tabs-nav::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .tabs-nav::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .tab-btn {
            padding: 0.8rem 1rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 700;
            color: #64748b;
            white-space: nowrap;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            flex-shrink: 0;
            min-width: max-content;
            font-size: clamp(0.75rem, 1.5vw, 0.9rem);
            box-sizing: border-box;
            flex: 1;
            min-width: 0;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        @media (min-width: 768px) {
            .tab-btn {
                flex: 1;
                min-width: 0;
                overflow: hidden;
                text-overflow: ellipsis;
                padding: 0.9rem 0.5rem;
                font-size: 0.85rem;
            }

            .tabs-nav {
                overflow-x: hidden;
                justify-content: space-between;
            }
        }

        @media (max-width: 480px) {
            .tab-btn {
                padding: 0.7rem 0.6rem;
                font-size: 0.75rem;
                gap: 0.3rem;
            }

            .tab-btn i {
                font-size: 0.8rem;
            }
        }

        .tab-btn:hover {
            background-color: #e2e8f0;
            color: var(--primary-color);
        }

        .tab-btn.active {
            background-color: #fff;
            color: var(--secondary-color);
            border-bottom-color: var(--secondary-color);
            border-radius: 8px 8px 0 0;
            margin-bottom: -2px;
            border-left: 1px solid #e1e5e9;
            border-right: 1px solid #e1e5e9;
            border-top: 1px solid #e1e5e9;
        }

        /* ===== ESTILOS PARA SUBTABS DENTRO DE PDCA TOOL ===== */
        .subtabs-nav {
            display: flex;
            background-color: #f8fafc;
            border-radius: 6px 6px 0 0;
            overflow-x: auto;
            border-bottom: 2px solid #cbd5e1;
            margin-bottom: 0;
            width: 100%;
            box-sizing: border-box;
        }

        .subtab-btn {
            padding: 0.7rem 0.9rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 600;
            color: #64748b;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.4rem;
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
            flex-shrink: 0;
            font-size: clamp(0.7rem, 1.2vw, 0.8rem);
            box-sizing: border-box;
            flex: 1;
            min-width: 0;
        }

        .subtab-btn:hover {
            background-color: #e2e8f0;
            color: var(--primary-color);
        }

        .subtab-btn.active {
            background-color: #fff;
            color: var(--secondary-color);
            border-bottom-color: var(--secondary-color);
            border-radius: 6px 6px 0 0;
            margin-bottom: -2px;
            border-left: 1px solid #e1e5e9;
            border-right: 1px solid #e1e5e9;
            border-top: 1px solid #e1e5e9;
        }

        .subtab-content {
            display: none;
            padding: 1.5rem;
            background: #fff;
            border: 1px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 8px 8px;
            animation: fadeIn 0.3s ease;
            width: 100%;
            box-sizing: border-box;
        }

        .subtab-content.active {
            display: block;
        }

        /* ===== CONTENIDO DE LAS TABS ===== */
        .tab-content {
            display: none;
            padding: 0;
            background: #fff;
            border: 1px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 8px 8px;
            animation: fadeIn 0.3s ease;
            width: 100%;
            box-sizing: border-box;
        }

        @media (max-width: 768px) {
            .tab-content {
                padding: 0;
            }
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== BOTONES PRINCIPALES (ESTILO KANO) ===== */
        .main-action-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1.5rem auto 2rem auto;
            flex-wrap: wrap;
            max-width: 800px;
        }

        .main-action-buttons button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        .main-action-buttons .btn-example {
            background-color: var(--success-color);
            color: white;
        }

        .main-action-buttons .btn-example:hover {
            background-color: #27ad60;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        .main-action-buttons .btn-reset {
            background-color: var(--danger-color);
            color: white;
        }

        .main-action-buttons .btn-reset:hover {
            background-color: #a5281c;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        /* ===== ESTILOS GENERALES ===== */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #c0392b;
            font-size: 16px;
        }

        @media (max-width: 768px) {
            :root {
                font-size: 15px;
            }
        }

        @media (max-width: 480px) {
            :root {
                font-size: 14px;
            }
        }

        body {
            background-color: #f5f7fa;
            font-family: 'Nunito', sans-serif;
            color: #333;
            margin: 0;
            overflow-x: hidden;
            width: 100%;
        }

        .main-content-wrapper {
            max-width: 1400px;
            margin: 20px auto;
            padding: 1.25rem;
            box-sizing: border-box;
            width: 100%;
            overflow-x: hidden;
        }

        @media (max-width: 768px) {
            .main-content-wrapper {
                padding: 1rem;
            }
        }

        @media (max-width: 480px) {
            .main-content-wrapper {
                padding: 0.8rem;
            }
        }

        .header {
            margin-bottom: 0.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #ddd;
            text-align: center;
            width: 100%;
            box-sizing: border-box;
        }

        .header h1 {
            color: var(--primary-color);
            font-size: clamp(1.2rem, 4vw, 1.8rem);
            margin: 0.5rem 0;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            text-align: center;
            width: 100%;
        }

        .header .header-subtitle {
            font-size: clamp(0.9rem, 2vw, 1.1rem);
            color: #7f8c8d;
            margin: 0;
            font-weight: 400;
            padding: 0 1rem;
        }

        /* ===== CONTENIDO DE LAS SUBTABS ===== */
        .content-block {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            width: 100%;
            box-sizing: border-box;
            overflow-wrap: break-word;
        }

        @media (max-width: 768px) {
            .content-block {
                padding: 1.25rem;
            }
        }

        @media (max-width: 480px) {
            .content-block {
                padding: 1rem;
                margin-bottom: 1rem;
            }
        }

        .content-block h2 {
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            margin-top: 0;
            margin-bottom: 1.25rem;
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.6rem;
            font-weight: 800;
            overflow-wrap: break-word;
        }

        .content-block h2 .fas {
            margin-right: 0.75rem;
        }

        .instructions-box ul {
            margin: 0.6rem 0 0 0;
            padding-left: 1.25rem;
        }

        .instructions-box li {
            margin-bottom: 0.5rem;
            line-height: 1.6;
            overflow-wrap: break-word;
        }

        /* ===== RUEDA PDCA ===== */
        .pdca-wheel-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2rem auto;
            max-width: 600px;
            width: 100%;
            box-sizing: border-box;
        }

        .pdca-wheel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            width: 100%;
            padding-top: 100%;
            border-radius: 50%;
            overflow: hidden;
            position: relative;
            border: 5px solid #555;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            max-width: 100%;
        }

        @media (max-width: 600px) {
            .pdca-wheel {
                border-width: 3px;
            }
        }

        .pdca-quadrant {
            position: absolute;
            width: 50%;
            height: 50%;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #333;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.1);
            transform: translateZ(0);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        @media (max-width: 600px) {
            .pdca-quadrant {
                padding: 10px;
            }
        }

        @media (max-width: 480px) {
            .pdca-quadrant {
                padding: 8px;
            }
        }

        .pdca-quadrant:hover {
            transform: translateZ(10px) scale(1.03);
            box-shadow:
                inset 0 0 30px rgba(255, 255, 255, 0.3),
                0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 5;
            filter: brightness(1.1);
        }

        .quadrant-plan {
            top: 0;
            left: 0;
            background: linear-gradient(135deg, #eaf4ff 0%, #c2e0ff 100%);
        }

        .quadrant-do {
            top: 0;
            right: 0;
            background: linear-gradient(135deg, #ffe6cc 0%, #ffcc99 100%);
        }

        .quadrant-act {
            bottom: 0;
            left: 0;
            background: linear-gradient(135deg, #f7e6ff 0%, #e6ccff 100%);
        }

        .quadrant-check {
            bottom: 0;
            right: 0;
            background: linear-gradient(135deg, #eafbe7 0%, #ccffcc 100%);
        }

        .pdca-quadrant h3 {
            margin: 0 0 10px 0;
            padding: 0;
            font-size: clamp(1rem, 3vw, 1.5rem);
            font-weight: 800;
            border: none;
            color: inherit;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .pdca-quadrant:hover h3 {
            transform: translateY(-3px);
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.2);
        }

        .pdca-quadrant .fas {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            margin-bottom: 10px;
            color: #333;
            transition: all 0.3s ease;
        }

        .pdca-quadrant:hover .fas {
            transform: scale(1.2);
            filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.2));
        }

        .pdca-quadrant span {
            font-size: clamp(0.7rem, 1.5vw, 0.9rem);
            transition: all 0.3s ease;
        }

        .pdca-quadrant:hover span {
            transform: translateY(2px);
        }

        .pdca-wheel::after,
        .pdca-wheel::before {
            content: '';
            position: absolute;
            background: #555;
            z-index: 10;
        }

        .pdca-wheel::after {
            width: 5px;
            height: 100%;
            left: 50%;
            transform: translateX(-50%);
        }

        .pdca-wheel::before {
            height: 5px;
            width: 100%;
            top: 50%;
            transform: translateY(-50%);
        }

        .pdca-center-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20%;
            height: 20%;
            min-width: 60px;
            min-height: 60px;
            background: white;
            border-radius: 50%;
            border: 5px solid #555;
            z-index: 11;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: clamp(1.2rem, 2.5vw, 1.8rem);
            color: #555;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        @media (max-width: 600px) {
            .pdca-center-circle {
                min-width: 50px;
                min-height: 50px;
                border-width: 3px;
            }
        }

        .pdca-center-circle i {
            animation: rotate 10s linear infinite;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
        }

        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        .pdca-center-circle:hover {
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        .pdca-center-circle:hover i {
            animation-duration: 5s;
        }

        /* ===== FORMULARIOS PDCA ===== */
        .cycle-step {
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 1.25rem;
            margin-bottom: 1.25rem;
            background-color: #fdfdfd;
            width: 100%;
            box-sizing: border-box;
        }

        @media (max-width: 480px) {
            .cycle-step {
                padding: 1rem;
                margin-bottom: 1rem;
            }
        }

        .cycle-step h3 {
            font-size: clamp(1.1rem, 2.5vw, 1.2rem);
            margin-top: 0;
            margin-bottom: 1rem;
            color: var(--primary-color);
            border-bottom: 1px solid #eee;
            padding-bottom: 0.6rem;
            font-weight: 800;
        }

        .cycle-step h3 .fas {
            margin-right: 0.5rem;
        }

        .form-group {
            margin-bottom: 1.25rem;
            width: 100%;
            box-sizing: border-box;
        }

        label {
            color: var(--primary-color);
            font-weight: 600;
            display: block;
            margin-bottom: 0.5rem;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        textarea {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            transition: border 0.3s, box-shadow 0.3s;
            font-size: clamp(0.9rem, 2vw, 1rem);
            font-family: 'Nunito', sans-serif;
            min-height: 45px;
            resize: none;
            overflow-y: hidden;
            box-sizing: border-box;
            max-width: 100%;
        }

        textarea:focus,
        button:focus-visible {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        button {
            background-color: var(--secondary-color);
            color: white;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: clamp(0.9rem, 2vw, 1rem);
            transition: background-color 0.3s;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
            box-sizing: border-box;
            white-space: nowrap;
        }

        @media (max-width: 480px) {
            button {
                padding: 0.6rem 1rem;
                margin: 4px;
                font-size: 0.9rem;
            }
        }

        .btn-success {
            background-color: var(--success-color);
        }

        .btn-success:hover {
            background-color: #219653;
        }

        .btn-warning {
            background-color: var(--warning-color);
        }

        .btn-warning:hover {
            background-color: #d4ac0d;
        }

        #generate-report-button {
            width: 100%;
            padding: 1rem;
            font-size: clamp(1rem, 2.5vw, 1.2rem);
            font-weight: bold;
            margin-top: 1.25rem;
            box-sizing: border-box;
        }

        #generate-report-button:hover {
            background-color: #2980b9;
        }

        /* ===== TAB NAVIGATION BUTTONS ===== */
        .tab-nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
            width: 100%;
            box-sizing: border-box;
        }

        .btn-next-tab {
            background-color: var(--secondary-color);
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.8rem 1.5rem;
            font-size: 0.9rem;
        }

        @media (max-width: 480px) {
            .btn-next-tab {
                padding: 0.7rem 1.2rem;
                font-size: 0.85rem;
            }
        }

        .btn-prev-tab {
            background-color: #95a5a6;
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.8rem 1.5rem;
            font-size: 0.9rem;
        }

        .btn-prev-tab:hover {
            background-color: #7f8c8d;
        }

        /* ===== RESULTS CONTAINER ===== */
        #results-container {
            border: 2px solid var(--success-color);
            background-color: #f8fef8;
            border-radius: 8px;
            padding: 1.25rem;
            margin-top: 1.5rem;
            overflow-x: auto;
            width: 100%;
            box-sizing: border-box;
        }

        @media (max-width: 768px) {
            #results-container {
                padding: 1rem;
            }
        }

        @media (max-width: 480px) {
            #results-container {
                padding: 0.8rem;
            }
        }

        #results-container h3 {
            color: var(--success-color);
            font-weight: 800;
            text-align: center;
            margin-bottom: 1rem;
            font-size: clamp(1.2rem, 3vw, 1.5rem);
        }

        .pdca-summary-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
            table-layout: auto;
            min-width: 100%;
        }

        @media (max-width: 768px) {
            .pdca-summary-table {
                display: block;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
        }

        .pdca-summary-table th,
        .pdca-summary-table td {
            padding: 12px;
            text-align: left;
            border: 1px solid #ddd;
            word-wrap: break-word;
        }

        @media (max-width: 768px) {

            .pdca-summary-table th,
            .pdca-summary-table td {
                padding: 8px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {

            .pdca-summary-table th,
            .pdca-summary-table td {
                padding: 6px;
                font-size: 0.85rem;
            }
        }

        .pdca-summary-table th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 800;
            vertical-align: top;
            min-width: 100px;
        }

        .pdca-summary-table td:nth-child(2) {
            font-weight: 600;
            min-width: 120px;
            background-color: #f1f1f1;
        }

        .pdca-summary-table td:nth-child(3) {
            min-width: 200px;
            white-space: pre-wrap;
            vertical-align: top;
        }

        .phase-row {
            background-color: #eaf4ff;
            border-bottom: 3px solid var(--secondary-color);
        }

        .results-actions {
            margin-top: 1.25rem;
            padding-top: 1.25rem;
            border-top: 1px solid #eee;
            text-align: center;
            width: 100%;
            box-sizing: border-box;
        }

        /* ===== FOOTER ===== */
        footer[role="contentinfo"] {
            padding: 2rem 1.25rem;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        @media (max-width: 768px) {
            footer[role="contentinfo"] {
                padding: 1.5rem 1rem;
            }
        }

        .disclaimer-note {
            margin-top: 2rem;
            padding: 0 1rem;
            font-size: clamp(0.7rem, 1.5vw, 0.8rem);
            color: #777;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
            text-align: left;
            width: 100%;
            box-sizing: border-box;
        }

        .hidden {
            display: none;
        }

        .main-tool-logo {
            width: 50px;
            height: 50px;
            border-radius: 18px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 1.8rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            flex-shrink: 0;
            margin-right: 15px;
        }

        @media (max-width: 768px) {
            .main-tool-logo {
                width: 40px;
                height: 40px;
                font-size: 1.4rem;
                margin-right: 10px;
            }
        }

        @media (max-width: 480px) {
            .main-tool-logo {
                width: 35px;
                height: 35px;
                font-size: 1.2rem;
                margin-right: 8px;
            }
        }

        .main-tool-logo[data-color='9'] {
            background-color: #7ed321;
        }
    </style>
</head>

<body>

    <div id="header-placeholder"></div>
    <div id="header-container"></div>

    <noscript>
        <nav>
            <a href="/">Home</a> |
            <a href="/8d">8D Tool</a> |
            <a href="/taguchi_doe">Taguchi DOE</a> |
            <a href="/swot">SWOT Analysis</a> |
            <a href="/balancedcard">Balanced Scorecard</a> |
            <a href="/qfd">QFD</a> |
            <a href="/apqp-ppap">APQP/PPAP</a> |
            <a href="/ishikawa">Ishikawa</a> |
            <a href="/fmea">FMEA</a> |
            <a href="/vave">VAVE</a> |
            <a href="/eisenhower">Eisenhower Matrix</a> |
            <a href="/triz">TRIZ</a> |
            <a href="/weibull">Weibull</a> |
            <a href="/stack_up_analysis">Tolerance Stack-Up</a> |
            <a href="/pdca">PDCA</a> |
            <a href="/design_thinking">Design Thinking</a> |
            <a href="/pugh">Pugh Matrix</a> |
            <a href="/cpk_calculator">CpK Calculator</a> |
            <a href="/control-plan">Control Plan</a>
        </nav>
    </noscript>

    <main class="main-content-wrapper">
        <header class="header">
            <h1>
                <div class="main-tool-logo" data-color="9"><i class="fas fa-sync-alt"></i></div>
                Free Online Plan-Do-Check-Act (PDCA) Cycle Tool (Deming Wheel)
            </h1>
            <p class="header-subtitle">A structured four-phase model for continuous improvement and quality management.
            </p>
        </header>

        <!-- BOTONES PRINCIPALES (ESTILO KANO) -->
        <div class="main-action-buttons">
            <button id="globalLoadExampleBtn" class="btn-example">
                <i class="fas fa-play-circle"></i> Load Example
            </button>
            <button id="globalResetBtn" class="btn-reset">
                <i class="fas fa-sync-alt"></i> Reset All
            </button>
        </div>

        <!-- BARRA DE PESTAÑAS PRINCIPALES (3 TABS) -->
        <nav class="tabs-nav">
            <button class="tab-btn active" onclick="switchTab('tab-start')">
                <i class="fas fa-info-circle"></i> <span class="tab-text">Start & Info</span>
            </button>
            <button class="tab-btn" onclick="switchTab('tab-pdca-tool')">
                <i class="fas fa-tools"></i> <span class="tab-text">PDCA Tool</span>
            </button>
            <button class="tab-btn" onclick="switchTab('tab-report')">
                <i class="fas fa-file-alt"></i> <span class="tab-text">Report</span>
            </button>
        </nav>

        <!-- PESTAÑA 1: START & INFO -->
        <div id="tab-start" class="tab-content active">
            <div class="content-block">
                <h2><i class="fas fa-question-circle"></i> What is the PDCA Cycle?</h2>
                <p>The <strong>PDCA Cycle</strong> (Plan‑Do‑Check‑Act), also known as the Deming Wheel or Shewhart
                    Cycle, is
                    a systematic, iterative four‑stage approach for continuous improvement in processes and products. It
                    provides a simple but powerful framework for solving problems, managing change, and implementing
                    quality
                    control.</p>
                <p>By repeatedly cycling through the four phases, organizations can refine their processes, identify
                    root
                    causes of problems, and create a culture of continuous learning and improvement.</p>
                <div class="pdca-wheel-container">
                    <div class="pdca-wheel">
                        <div class="pdca-quadrant quadrant-plan">
                            <i class="fas fa-clipboard-list"></i>
                            <h3>1. Plan</h3>
                            <span>Identify goal &amp; plan action.</span>
                        </div>
                        <div class="pdca-quadrant quadrant-do">
                            <i class="fas fa-cogs"></i>
                            <h3>2. Do</h3>
                            <span>Implement the plan.</span>
                        </div>
                        <div class="pdca-quadrant quadrant-act">
                            <i class="fas fa-bullhorn"></i>
                            <h3>4. Act</h3>
                            <span>Standardize or adjust.</span>
                        </div>
                        <div class="pdca-quadrant quadrant-check">
                            <i class="fas fa-chart-line"></i>
                            <h3>3. Check</h3>
                            <span>Analyze the results.</span>
                        </div>
                        <div class="pdca-center-circle">
                            <i class="fas fa-sync-alt"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-block">
                <h2><i class="fas fa-history"></i> History &amp; Origin</h2>
                <p>The concept was originally developed by American physicist and statistician <strong>Walter A.
                        Shewhart</strong> in the 1920s, who is often called the "father of statistical quality control."
                    Shewhart framed it as a three‑step process of specification, production, and inspection for
                    scientific
                    learning.</p>
                <p>His mentee, <strong>Dr. W. Edwards Deming</strong>, modified and popularized the cycle in the 1950s,
                    evolving it into the four‑step "Plan‑Do‑Check‑Act" model we know today. Deming strongly advocated
                    for
                    its use in Japan, where it became a cornerstone of the country's post‑war industrial and
                    manufacturing
                    success, known as "Kaizen" (continuous improvement).</p>
            </div>

            <div class="content-block">
                <h2><i class="fas fa-tools"></i> How to Use This Tool</h2>
                <div class="instructions-box">
                    <ul>
                        <li><strong>Load Example:</strong> Click "Load Example" above to populate all tabs with sample
                            data.</li>
                        <li><strong>Follow the Steps:</strong> Work through each phase (Plan, Do, Check, Act) in the
                            PDCA Tool tab to document your improvement project.</li>
                        <li><strong>Generate Report:</strong> Click "Generate PDCA Report" on the Report tab to create a
                            consolidated summary.</li>
                        <li><strong>Export:</strong> Once the report is generated, you can export it to an Excel file
                            for documentation or sharing.</li>
                    </ul>
                </div>
            </div>

            <div class="tab-nav-buttons">
                <button class="btn-next-tab" onclick="switchTab('tab-pdca-tool')">Start PDCA Tool <i
                        class="fas fa-arrow-right"></i></button>
            </div>
        </div>

        <!-- PESTAÑA 2: PDCA TOOL (CON SUBTABS) -->
        <div id="tab-pdca-tool" class="tab-content">
            <!-- NAVEGACIÓN DE SUBTABS -->
            <nav class="subtabs-nav">
                <button class="subtab-btn active" onclick="switchSubTab('subtab-plan')">
                    <i class="fas fa-clipboard-list"></i> <span>1. Plan</span>
                </button>
                <button class="subtab-btn" onclick="switchSubTab('subtab-do')">
                    <i class="fas fa-cogs"></i> <span>2. Do</span>
                </button>
                <button class="subtab-btn" onclick="switchSubTab('subtab-check')">
                    <i class="fas fa-chart-line"></i> <span>3. Check</span>
                </button>
                <button class="subtab-btn" onclick="switchSubTab('subtab-act')">
                    <i class="fas fa-bullhorn"></i> <span>4. Act</span>
                </button>
            </nav>

            <!-- SUBTAB 1: PLAN -->
            <div id="subtab-plan" class="subtab-content active">
                <div class="content-block">
                    <h2><i class="fas fa-clipboard-list"></i> Phase 1: Plan</h2>
                    <div class="cycle-step">
                        <h3><i class="fas fa-clipboard-list"></i> Plan Phase</h3>
                        <div class="form-group">
                            <label for="plan-problem">Problem/Opportunity Statement:</label>
                            <textarea id="plan-problem"
                                placeholder="e.g., Customer support call times are too long, averaging 12 minutes."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="plan-goal">Goal/Hypothesis (What do you expect to happen?):</label>
                            <textarea id="plan-goal"
                                placeholder="e.g., By implementing a new call script, we will reduce the average call time by 15% to 10 minutes or less within one month."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="plan-actions">Action Plan (What steps will you take?):</label>
                            <textarea id="plan-actions"
                                placeholder="e.g., 1. Develop new script. 2. Train a pilot group of 5 agents. 3. Monitor their call times for 1 week."></textarea>
                        </div>
                    </div>
                </div>

                <div class="tab-nav-buttons">
                    <button class="btn-next-tab" onclick="switchSubTab('subtab-do')">Next: Do Phase <i
                            class="fas fa-arrow-right"></i></button>
                </div>
            </div>

            <!-- SUBTAB 2: DO -->
            <div id="subtab-do" class="subtab-content">
                <div class="content-block">
                    <h2><i class="fas fa-cogs"></i> Phase 2: Do</h2>
                    <div class="cycle-step">
                        <h3><i class="fas fa-cogs"></i> Do Phase</h3>
                        <div class="form-group">
                            <label for="do-execution">What was executed? (Record actions taken):</label>
                            <textarea id="do-execution"
                                placeholder="e.g., The new script was developed and deployed. Five agents from Team B were trained on the new script on Monday. They used the script for all calls from Tuesday to Friday."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="do-problems">What problems or unexpected observations occurred?:</label>
                            <textarea id="do-problems"
                                placeholder="e.g., Some veteran agents initially resisted the change, finding the script too rigid. One part of the script for 'billing issues' was found to be confusing for customers."></textarea>
                        </div>
                    </div>
                </div>

                <div class="tab-nav-buttons">
                    <button class="btn-prev-tab" onclick="switchSubTab('subtab-plan')"><i class="fas fa-arrow-left"></i>
                        Back to Plan</button>
                    <button class="btn-next-tab" onclick="switchSubTab('subtab-check')">Next: Check Phase <i
                            class="fas fa-arrow-right"></i></button>
                </div>
            </div>

            <!-- SUBTAB 3: CHECK -->
            <div id="subtab-check" class="subtab-content">
                <div class="content-block">
                    <h2><i class="fas fa-chart-line"></i> Phase 3: Check</h2>
                    <div class="cycle-step">
                        <h3><i class="fas fa-chart-line"></i> Check Phase</h3>
                        <div class="form-group">
                            <label for="check-data">Data &amp; Results (What did the metrics show?):</label>
                            <textarea id="check-data"
                                placeholder="e.g., Average call time for the pilot group was 9.5 minutes, an 18% reduction. Customer satisfaction scores for the pilot group remained stable (no change)."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="check-analysis">Analysis (Did the results match the hypothesis?):</label>
                            <textarea id="check-analysis"
                                placeholder="e.g., The results exceeded the goal. The script was effective in reducing call time without negatively impacting customer satisfaction. The confusing 'billing' section needs to be addressed."></textarea>
                        </div>
                    </div>
                </div>

                <div class="tab-nav-buttons">
                    <button class="btn-prev-tab" onclick="switchSubTab('subtab-do')"><i class="fas fa-arrow-left"></i>
                        Back to Do</button>
                    <button class="btn-next-tab" onclick="switchSubTab('subtab-act')">Next: Act Phase <i
                            class="fas fa-arrow-right"></i></button>
                </div>
            </div>

            <!-- SUBTAB 4: ACT -->
            <div id="subtab-act" class="subtab-content">
                <div class="content-block">
                    <h2><i class="fas fa-bullhorn"></i> Phase 4: Act</h2>
                    <div class="cycle-step">
                        <h3><i class="fas fa-bullhorn"></i> Act Phase</h3>
                        <div class="form-group">
                            <label for="act-conclusions">Conclusions &amp; Learnings:</label>
                            <textarea id="act-conclusions"
                                placeholder="e.g., The new script is a viable solution for reducing call times. Allowing for minor flexibility in the script could improve adoption among veteran agents."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="act-next">Next Steps (Standardize, Adjust, or begin a new cycle?):</label>
                            <textarea id="act-next"
                                placeholder="e.g., 1. Adjust the 'billing issues' part of the script based on feedback. 2. Standardize the revised script and roll it out to all support agents. 3. Start a new PDCA cycle to improve the first-call resolution rate."></textarea>
                        </div>
                    </div>
                </div>

                <div class="tab-nav-buttons">
                    <button class="btn-prev-tab" onclick="switchSubTab('subtab-check')"><i
                            class="fas fa-arrow-left"></i>
                        Back to Check</button>
                    <button class="btn-next-tab" onclick="switchTab('tab-report')">Go to Report <i
                            class="fas fa-file-alt"></i></button>
                </div>
            </div>
        </div>

        <!-- PESTAÑA 3: REPORT -->
        <div id="tab-report" class="tab-content">
            <div class="content-block">
                <h2><i class="fas fa-file-alt"></i> Generate PDCA Report</h2>
                <div style="text-align: center; padding: 30px; width: 100%; box-sizing: border-box;">
                    <h3 style="color: var(--secondary-color); font-size: clamp(1.2rem, 3vw, 1.5rem);">Ready to Generate
                        Report?</h3>
                    <p style="margin-bottom: 20px;">This will gather all data from Plan, Do, Check, and Act phases.</p>
                    <button id="generate-report-button" onclick="generateReport()"
                        style="max-width: 400px; margin: 0 auto;">
                        <i class="fas fa-file-alt"></i> Generate PDCA Report
                    </button>
                </div>

                <div id="results-container" class="hidden"></div>
            </div>

            <div class="tab-nav-buttons">
                <button class="btn-prev-tab" onclick="switchTab('tab-pdca-tool')"><i class="fas fa-arrow-left"></i> Back
                    to PDCA Tool</button>
                <button class="btn-next-tab" onclick="switchTab('tab-start')"><i class="fas fa-info-circle"></i> Back to
                    Start & Info</button>
            </div>
        </div>

    </main>

    <footer role="contentinfo">
        <div class="disclaimer-note">
            <p><strong>Disclaimer:</strong> The PDCA Cycle was developed by Walter A. Shewhart and later popularized by
                W. Edwards Deming. This tool is an independent implementation provided for educational and informational
                purposes only. It is not affiliated with, sponsored by, or endorsed by the estates of Deming or
                Shewhart, or their respective organizations. The effectiveness of the process depends on the user's
                application. Sigma Exacta and its creators are not liable for any damages or losses resulting from its
                use.</p>
        </div>
    </footer>

    <script>
        // ===== VARIABLES GLOBALES =====
        let cycleData = {};

        // ===== FUNCIONES DE NAVEGACIÓN =====
        function switchTab(tabId) {
            // Quitar clase active de todos los botones y contenidos principales
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // Activar el seleccionado
            document.getElementById(tabId).classList.add('active');

            // Activar botón correspondiente
            const activeBtn = document.querySelector(`button[onclick="switchTab('${tabId}')"]`);
            if (activeBtn) activeBtn.classList.add('active');

            // Scroll al top suavemente
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Actualizar textareas
            document.querySelectorAll('textarea').forEach(textarea => {
                autoResizeTextarea(textarea);
            });
        }

        function switchSubTab(subTabId) {
            // Quitar clase active de todos los botones y contenidos de subtabs
            document.querySelectorAll('.subtab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.subtab-content').forEach(content => content.classList.remove('active'));

            // Activar el seleccionado
            document.getElementById(subTabId).classList.add('active');

            // Activar botón correspondiente
            const activeBtn = document.querySelector(`button[onclick="switchSubTab('${subTabId}')"]`);
            if (activeBtn) activeBtn.classList.add('active');

            // Scroll al top suavemente
            const subtabContainer = document.querySelector('.subtab-content.active');
            if (subtabContainer) {
                subtabContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            // Actualizar textareas
            document.querySelectorAll('textarea').forEach(textarea => {
                autoResizeTextarea(textarea);
            });
        }

        // ===== FUNCIONES DE INICIALIZACIÓN =====
        function initializePage() {
            const navToggle = document.getElementById('nav-toggle');
            const navMenu = document.getElementById('nav-menu');
            const toolsDropdownToggle = document.getElementById('tools-dropdown-toggle');
            const toolsDropdownMenu = document.getElementById('tools-dropdown-menu');
            const toolsDropdownContainer = document.getElementById('tools-dropdown-container');

            if (navToggle && navMenu) {
                navToggle.addEventListener('click', () => {
                    navMenu.classList.toggle('show-menu');
                    const icon = navToggle.querySelector('i');
                    icon.classList.toggle('fa-bars');
                    icon.classList.toggle('fa-times');

                    if (!navMenu.classList.contains('show-menu')) {
                        if (toolsDropdownMenu) toolsDropdownMenu.classList.remove('show-submenu');
                        if (toolsDropdownContainer) toolsDropdownContainer.classList.remove('active');
                    }
                });
            }

            if (toolsDropdownToggle && toolsDropdownMenu && toolsDropdownContainer) {
                toolsDropdownToggle.addEventListener('click', (event) => {
                    if (window.innerWidth <= 992) {
                        event.preventDefault();
                        toolsDropdownMenu.classList.toggle('show-submenu');
                        toolsDropdownContainer.classList.toggle('active');
                    }
                });
            }

            // Auto-resize textareas
            document.querySelectorAll('textarea').forEach(textarea => {
                textarea.addEventListener('input', function () { autoResizeTextarea(this); });
                autoResizeTextarea(textarea);
            });

            // Botones globales
            document.getElementById('globalLoadExampleBtn').addEventListener('click', loadExample);
            document.getElementById('globalResetBtn').addEventListener('click', resetTool);
        }

        // Cargar el header y luego inicializar la página
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-placeholder').innerHTML = data;
                setTimeout(initializePage, 10);
            })
            .catch(error => {
                console.error('Error loading header:', error);
            });

        function autoResizeTextarea(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = (textarea.scrollHeight) + 'px';
        }

        // ===== FUNCIONES DE LA HERRAMIENTA =====
        function resetTool() {
            if (cycleData && Object.keys(cycleData).length > 0) {
                if (!confirm("Are you sure you want to reset all data? This will clear all entered information.")) {
                    return;
                }
            }

            cycleData = {};
            document.querySelectorAll('textarea').forEach(el => {
                el.value = '';
                autoResizeTextarea(el);
            });
            document.getElementById('results-container').classList.add('hidden');
            document.getElementById('results-container').innerHTML = '';

            // Ir a la pestaña inicial
            switchTab('tab-start');

            // Mostrar notificación
            showNotification("All data has been reset successfully!");
        }

        function loadExample() {
            if (cycleData && Object.keys(cycleData).length > 0) {
                if (!confirm("Loading example data will replace your current work. Do you want to continue?")) {
                    return;
                }
            }

            // Reset primero
            resetTool();

            // Llenar con datos de ejemplo
            document.getElementById('plan-problem').value = "Customer support call times are too long, averaging 12 minutes, which leads to lower customer satisfaction and higher costs.";
            document.getElementById('plan-goal').value = "By implementing a new streamlined call script and providing targeted training, we will reduce the average call handling time by 15% (to 10.2 minutes or less) within one month, without decreasing the customer satisfaction score.";
            document.getElementById('plan-actions').value = "1. Analyze top 5 call reasons to create a streamlined script (Week 1).\n2. Select a pilot group of 5 agents for training (Week 2).\n3. Train the pilot group on the new script (Week 2).\n4. Monitor the pilot group's call times and CSAT scores for two weeks (Weeks 3-4).";
            document.getElementById('do-execution').value = "The script was developed and deployed. Five agents from Team B were trained on Monday of Week 3. They used the script for all their calls for the following two weeks. Call data was automatically logged by the CRM.";
            document.getElementById('do-problems').value = "Initial feedback from the pilot agents was that the script felt too rigid for complex, multi-issue calls. We allowed for minor deviations after the first week based on their feedback.";
            document.getElementById('check-data').value = "Results after two weeks:\n- Average call time for the pilot group was 9.5 minutes (an 18.75% reduction).\n- Average call time for the control group (rest of the team) was 11.8 minutes.\n- Customer Satisfaction (CSAT) scores for the pilot group increased by 2%.";
            document.getElementById('check-analysis').value = "The hypothesis was confirmed: the new script significantly reduced call times. The slight increase in CSAT suggests the script did not harm the customer experience and may have improved it due to faster resolution.";
            document.getElementById('act-conclusions').value = "The streamlined script is an effective method for reducing call handling time. The key learning is that while a script provides structure, a small degree of flexibility is necessary for experienced agents to handle complex cases effectively.";
            document.getElementById('act-next').value = "1. (Standardize) Roll out the revised, slightly more flexible script to all customer support agents, with mandatory training.\n2. (Adjust) Update the standard operating procedure (SOP) to reflect the new process.\n3. (New Cycle) Begin a new PDCA cycle to tackle the 'first-call resolution rate', which was identified as the next key improvement area during analysis.";

            // Actualizar textareas
            document.querySelectorAll('textarea').forEach(textarea => autoResizeTextarea(textarea));

            // Ir a la pestaña PDCA Tool
            switchTab('tab-pdca-tool');

            // Mostrar notificación
            showNotification("Example data loaded successfully! You can now explore the PDCA phases.");
        }

        function showNotification(message) {
            // Crear elemento de notificación
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background-color: var(--success-color);
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                animation: slideIn 0.3s ease;
                max-width: 300px;
                font-weight: 600;
            `;

            // Animación CSS
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes fadeOut {
                    from { opacity: 1; }
                    to { opacity: 0; }
                }
            `;
            document.head.appendChild(style);

            notification.textContent = message;
            document.body.appendChild(notification);

            // Remover después de 3 segundos
            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.5s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 500);
            }, 3000);
        }

        function generateReport() {
            cycleData = {
                plan: {
                    problem: document.getElementById('plan-problem').value,
                    goal: document.getElementById('plan-goal').value,
                    actions: document.getElementById('plan-actions').value
                },
                do: {
                    execution: document.getElementById('do-execution').value,
                    problems: document.getElementById('do-problems').value
                },
                check: {
                    data: document.getElementById('check-data').value,
                    analysis: document.getElementById('check-analysis').value
                },
                act: {
                    conclusions: document.getElementById('act-conclusions').value,
                    next: document.getElementById('act-next').value
                }
            };

            if (!cycleData.plan.problem && !cycleData.plan.goal) {
                alert('Please fill in at least the "Plan" phase to generate a report.');
                return;
            }

            displayResults();

            // Ir a la pestaña de reporte
            switchTab('tab-report');
        }

        function displayResults() {
            const resultsDiv = document.getElementById('results-container');

            function escapeHTML(str) {
                return str ? str.replace(/[&<>"']/g, function (m) {
                    return { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[m];
                }) : 'N/A';
            }

            let html = `<h3><i class="fas fa-check-circle"></i> PDCA Cycle Report Summary</h3>`;

            html += `<table class="pdca-summary-table">
            <thead>
                <tr>
                    <th>Phase</th>
                    <th>Category</th>
                    <th>Details</th>
                </tr>
            </thead>
            <tbody>
                <tr class="phase-row">
                    <td rowspan="3"><strong>1. PLAN</strong><br><i class="fas fa-clipboard-list"></i></td>
                    <td>Problem/Opportunity</td>
                    <td>${escapeHTML(cycleData.plan.problem)}</td>
                </tr>
                <tr>
                    <td>Goal/Hypothesis</td>
                    <td>${escapeHTML(cycleData.plan.goal)}</td>
                </tr>
                <tr>
                    <td>Action Plan</td>
                    <td>${escapeHTML(cycleData.plan.actions)}</td>
                </tr>

                <tr class="phase-row" style="background-color: #ffe6cc; border-bottom: 3px solid #e67e22;">
                    <td rowspan="2"><strong>2. DO</strong><br><i class="fas fa-cogs"></i></td>
                    <td>Execution Record</td>
                    <td>${escapeHTML(cycleData.do.execution)}</td>
                </tr>
                <tr>
                    <td>Problems/Observations</td>
                    <td>${escapeHTML(cycleData.do.problems)}</td>
                </tr>
                
                <tr class="phase-row" style="background-color: #eafbe7; border-bottom: 3px solid #2ecc71;">
                    <td rowspan="2"><strong>3. CHECK</strong><br><i class="fas fa-chart-line"></i></td>
                    <td>Data & Results</td>
                    <td>${escapeHTML(cycleData.check.data)}</td>
                </tr>
                <tr>
                    <td>Analysis</td>
                    <td>${escapeHTML(cycleData.check.analysis)}</td>
                </tr>

                <tr class="phase-row" style="background-color: #f7e6ff; border-bottom: 3px solid #9b59b6;">
                    <td rowspan="2"><strong>4. ACT</strong><br><i class="fas fa-bullhorn"></i></td>
                    <td>Conclusions/Learnings</td>
                    <td>${escapeHTML(cycleData.act.conclusions)}</td>
                </tr>
                <tr>
                    <td>Next Steps</td>
                    <td>${escapeHTML(cycleData.act.next)}</td>
                </tr>
            </tbody>
        </table>`;

            html += `<div class="results-actions">
                    <button class="btn-success" onclick="exportToExcel()"><i class="fas fa-file-excel"></i> Export to Excel</button>
                 </div>`;

            resultsDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function exportToExcel() {
            if (Object.keys(cycleData).length === 0) {
                alert("No data to export. Please generate a report first.");
                return;
            }

            const wb = XLSX.utils.book_new();
            const ws_data = [];
            ws_data.push(["PDCA Cycle Report"]);
            ws_data.push(["Company: Sigma Exacta"]);
            ws_data.push([`Date: ${new Date().toLocaleDateString()}`]);
            ws_data.push([]);

            ws_data.push(["Phase", "Category", "Details"]);
            ws_data.push(["PLAN", "Problem/Opportunity", cycleData.plan.problem]);
            ws_data.push(["", "Goal/Hypothesis", cycleData.plan.goal]);
            ws_data.push(["", "Action Plan", cycleData.plan.actions]);
            ws_data.push([]);
            ws_data.push(["DO", "Execution Record", cycleData.do.execution]);
            ws_data.push(["", "Problems/Observations", cycleData.do.problems]);
            ws_data.push([]);
            ws_data.push(["CHECK", "Data & Results", cycleData.check.data]);
            ws_data.push(["", "Analysis", cycleData.check.analysis]);
            ws_data.push([]);
            ws_data.push(["ACT", "Conclusions", cycleData.act.conclusions]);
            ws_data.push(["", "Next Steps", cycleData.act.next]);

            const ws = XLSX.utils.aoa_to_sheet(ws_data);
            ws['!cols'] = [{ wch: 15 }, { wch: 25 }, { wch: 80 }];
            XLSX.utils.book_append_sheet(wb, ws, "PDCA Report");

            const dateStr = new Date().toISOString().slice(0, 10);
            XLSX.writeFile(wb, `PDCA_Report_Sigma_Exacta_${dateStr}.xlsx`);

            showNotification("Report exported to Excel successfully!");
        }
    </script>

    <script src="dexie.min.js"></script>
    <script src="db-sigma.js"></script>

</body>

</html>