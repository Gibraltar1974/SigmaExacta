<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Control Plan Creator | Sigma Exacta</title>
    <link rel="canonical" href="https://sigmaexacta.com/control-plan" />
    <meta name="description"
        content="A free, interactive online tool for creating and managing manufacturing control plans. Ideal for quality engineers and process managers following APQP principles. Export your plan to Excel.">
    <meta name="keywords"
        content="Open source, Free software, control plan, quality control, manufacturing, APQP, IATF 16949, process control, SPC, quality engineering, Six Sigma, free tool, prevention, SigmaExacta">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <link rel="icon" href="sigma-exacta-icon.jpg" type="image/jpeg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">

    <style>
        /* Estilos específicos de la página y generales unificados */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --performance-color: #2ecc71;
            --danger-color: #c0392b;
            font-size: 16px;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Nunito', sans-serif;
            margin: 0;
            padding: 0;
            color: #333;
            background-color: #f5f7fa;
            line-height: 1.6;
        }

        img,
        canvas {
            max-width: 100%;
            height: auto;
        }

        .main-content-wrapper {
            margin: 0 auto;
            padding: 1.25rem;
            max-width: 1400px;
            width: 100%;
            box-sizing: border-box;
        }

        .main-header {
            text-align: center;
            padding: 1rem 1.25rem;
            margin-bottom: 0;
            border-bottom: 1px solid #ddd;
            width: 100%;
            box-sizing: border-box;
        }

        .main-header h1 {
            color: var(--primary-color);
            font-size: clamp(1.5rem, 4vw, 1.8rem);
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .tool-logo {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 1.8rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            background-color: #0076a8;
        }

        .main-header p {
            color: #7f8c8d;
            font-weight: 400;
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
        }

        /* --- BOTONES PRINCIPALES SOBRE LAS TABS --- */
        .main-action-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1.5rem auto;
            flex-wrap: wrap;
            max-width: 800px;
        }

        .main-action-buttons button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        .main-action-buttons .btn-example {
            background-color: var(--performance-color);
            color: white;
        }

        .main-action-buttons .btn-example:hover {
            background-color: #27ad60;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        .main-action-buttons .btn-reset {
            background-color: var(--danger-color);
            color: white;
        }

        .main-action-buttons .btn-reset:hover {
            background-color: #a5281c;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        .content-block {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .content-block h2 {
            font-size: 1.5em;
            margin-top: 0;
            margin-bottom: 1.25rem;
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.6rem;
            font-weight: 800;
        }

        .content-block h2 .fas {
            margin-right: 0.75rem;
        }

        .infographic-flow {
            display: flex;
            justify-content: space-between;
            align-items: stretch;
            margin-top: 1.5rem;
            text-align: center;
            flex-wrap: wrap;
            gap: 0.6rem;
        }

        .flow-step {
            flex: 1;
            min-width: 150px;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #f8f9fa;
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .flow-step:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }

        .flow-step .fas {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin-bottom: 0.6rem;
        }

        .flow-step strong {
            display: block;
            font-size: 1.1rem;
            color: var(--primary-color);
            font-weight: 600;
        }

        .flow-arrow {
            font-size: 2rem;
            color: var(--secondary-color);
            margin: auto 0.6rem;
            flex-grow: 0;
        }

        @media (max-width: 992px) {
            .infographic-flow {
                flex-direction: column;
                align-items: center;
            }

            .flow-arrow {
                display: none;
            }
        }

        .key-components-list {
            list-style: none;
            padding-left: 0;
        }

        .key-components-list li {
            margin-bottom: 0.75rem;
            padding-left: 1.5rem;
            position: relative;
        }

        .key-components-list li::before {
            content: '\f058';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--success-color);
            position: absolute;
            left: 0;
            top: 2px;
        }

        button {
            color: white;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 1rem;
            transition: background-color 0.3s, box-shadow 0.3s;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
        }

        button:focus-visible {
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
        }

        .btn-primary {
            background-color: var(--secondary-color);
        }

        .btn-primary:hover {
            background-color: #2980b9;
        }

        .btn-success {
            background-color: var(--success-color);
        }

        .btn-success:hover {
            background-color: #229954;
        }

        .btn-warning {
            background-color: var(--warning-color);
        }

        .btn-warning:hover {
            background-color: #d4ac0d;
        }

        .btn-danger {
            background-color: var(--accent-color);
            padding: 5px 10px;
        }

        .btn-danger:hover {
            background-color: #c0392b;
        }

        /* ===== Contenedor para la tabla que permite el scroll horizontal en móviles ===== */
        .table-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            /* Para scroll suave en iOS */
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-top: 1.25rem;
        }

        #controlPlanTable {
            border-collapse: collapse;
            width: 100%;
            background: white;
            font-size: 1rem;
        }

        #controlPlanTable th,
        #controlPlanTable td {
            border: 1px solid #ddd;
            text-align: left;
            vertical-align: top;
            white-space: normal;
        }

        #controlPlanTable td {
            padding: 0;
        }

        #controlPlanTable th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            text-align: center;
            padding: 0.75rem 0.5rem;
            vertical-align: middle;
        }

        #controlPlanTable tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        #controlPlanTable textarea,
        #controlPlanTable select {
            width: 100%;
            height: 100%;
            padding: 0.5rem;
            border: none;
            border-radius: 0;
            font-size: 1rem;
            font-family: 'Nunito', sans-serif;
            box-sizing: border-box;
            background-color: transparent;
            transition: all 0.2s;
        }

        #controlPlanTable textarea {
            resize: none;
            overflow: hidden;
            min-height: 48px;
        }

        #controlPlanTable textarea:focus,
        #controlPlanTable select:focus {
            outline: none;
            background-color: #fff;
            box-shadow: inset 0 0 0 2px var(--secondary-color);
        }

        .button-container {
            margin-top: 1.25rem;
            text-align: right;
        }

        .action-cell {
            text-align: center;
            vertical-align: middle;
            padding: 4px;
        }

        .instructions-box ul {
            margin: 0.6rem 0 0 0;
            padding-left: 1.25rem;
        }

        .instructions-box li {
            margin-bottom: 5px;
        }

        footer {
            padding: 2rem 1.25rem;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .disclaimer-note {
            margin-top: 2rem;
            padding: 0 1rem;
            font-size: 0.8rem;
            color: #777;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
            text-align: left;
            line-height: 1.6;
        }

        /* ===== ESTILOS DEL SISTEMA DE PESTAÑAS (WIZARD) ===== */
        .tabs-nav {
            display: flex;
            background-color: #f1f5f9;
            border-radius: 8px 8px 0 0;
            overflow-x: auto;
            border-bottom: 2px solid var(--secondary-color);
            margin-bottom: 0;
            margin-top: 0.5rem;
            scrollbar-width: none;
            -ms-overflow-style: none;
            width: 100%;
        }

        .tabs-nav::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 1rem 1.5rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 700;
            color: #64748b;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            flex: 1;
            justify-content: center;
        }

        .tab-btn:hover {
            background-color: #e2e8f0;
            color: var(--primary-color);
        }

        .tab-btn.active {
            background-color: #fff;
            color: var(--secondary-color);
            border-bottom-color: var(--secondary-color);
            border-radius: 8px 8px 0 0;
            margin-bottom: -2px;
            border-left: 1px solid #e1e5e9;
            border-right: 1px solid #e1e5e9;
            border-top: 1px solid #e1e5e9;
        }

        .tabs-container {
            background: #fff;
            border: 1px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
            position: relative;
            margin-bottom: 2rem;
            box-sizing: border-box;
        }

        .wizard-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        .wizard-tab-content.active {
            display: block;
            width: 100%;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tab-content-wrapper {
            padding: 2rem;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        @media (max-width: 768px) {
            .tab-content-wrapper {
                padding: 1rem;
            }

            .tab-btn {
                padding: 0.75rem 0.5rem;
                font-size: 0.9rem;
            }

            .main-action-buttons {
                gap: 0.75rem;
                margin: 1rem auto;
            }

            .main-action-buttons button {
                padding: 0.7rem 1.2rem;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .tab-content-wrapper {
                padding: 0.75rem;
            }

            .tab-btn {
                padding: 0.6rem 0.3rem;
                font-size: 0.8rem;
            }

            .main-action-buttons {
                flex-direction: column;
                align-items: stretch;
                gap: 0.5rem;
            }

            .main-action-buttons button {
                width: 100%;
                justify-content: center;
            }
        }

        /* Estilos para la sección de resultados */
        .results-table-container {
            margin-top: 2rem;
            overflow-x: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
        }

        .results-table th,
        .results-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .results-table th {
            background-color: #f8f9fa;
            color: var(--primary-color);
            font-weight: 800;
        }

        .export-section {
            text-align: center;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px dashed #ddd;
        }

        .tab-nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
            width: 100%;
            box-sizing: border-box;
        }

        .btn-next-tab {
            background-color: var(--secondary-color);
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn-next-tab:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        .btn-next-tab.btn-prev {
            background-color: #95a5a6;
        }

        .btn-next-tab.btn-prev:hover {
            background-color: #7f8c8d;
        }
    </style>
</head>

<body>

    <div id="header-placeholder"></div>
    <div id="header-container"></div>

    <noscript>
        <nav>
            <a href="/">Home</a> |
            <a href="/8d">8D Tool</a> |
            <a href="/taguchi_doe">Taguchi DOE</a> |
            <a href="/swot">SWOT Analysis</a> |
            <a href="/balancedcard">Balanced Scorecard</a> |
            <a href="/qfd">QFD</a> |
            <a href="/apqp-ppap">APQP/PPAP</a> |
            <a href="/ishikawa">Ishikawa</a> |
            <a href="/fmea">FMEA</a> |
            <a href="/vave">VAVE</a> |
            <a href="/eisenhower">Eisenhower Matrix</a> |
            <a href="/triz">TRIZ</a> |
            <a href="/weibull">Weibull</a> |
            <a href="/stack_up_analysis">Tolerance Stack-Up</a> |
            <a href="/pdca">PDCA</a> |
            <a href="/design_thinking">Design Thinking</a> |
            <a href="/pugh">Pugh Matrix</a> |
            <a href="/cpk_calculator">CpK Calculator</a> |
            <a href="/control-plan">Control Plan</a>
        </nav>
    </noscript>

    <main class="main-content-wrapper">
        <header class="main-header">
            <h1>
                <div class="tool-logo" title="Control Plan">
                    <i class="fas fa-tasks"></i>
                </div>
                Free Online Control Plan Creator Tool
            </h1>
            <p>Ensuring Quality at Every Step of Your Process</p>

            <!-- BOTONES PRINCIPALES -->
            <div class="main-action-buttons">
                <button id="globalLoadExampleBtn" class="btn-example">
                    <i class="fas fa-play-circle"></i> Load Example
                </button>
                <button id="globalResetBtn" class="btn-reset">
                    <i class="fas fa-sync-alt"></i> Reset All
                </button>
            </div>
        </header>

        <!-- CONTENEDOR DE TABS -->
        <div class="tabs-container">
            <!-- NAVEGACIÓN DE PESTAÑAS (WIZARD) -->
            <nav class="tabs-nav">
                <button class="tab-btn active" onclick="switchWizardTab('tab-theory')">
                    <i class="fas fa-book"></i> Theory & Info
                </button>
                <button class="tab-btn" onclick="switchWizardTab('tab-tool')">
                    <i class="fas fa-cogs"></i> Control Plan Tool
                </button>
                <button class="tab-btn" onclick="switchWizardTab('tab-results')">
                    <i class="fas fa-chart-line"></i> Results
                </button>
            </nav>

            <!-- PESTAÑA 1: TEORÍA -->
            <div id="tab-theory" class="wizard-tab-content active">
                <div class="tab-content-wrapper">
                    <div class="content-block">
                        <h2><i class="fas fa-file-signature"></i> What is a Control Plan?</h2>
                        <p>A Control Plan is a living document that provides a structured summary of the methods used
                            for
                            controlling processes and products. Its primary goal is to ensure all outputs meet customer
                            requirements
                            by minimizing process and product variation. It acts as a roadmap for quality control,
                            detailing
                            every
                            check and balance from raw materials to the final product.</p>
                        <div class="infographic-flow">
                            <div class="flow-step"> <i class="fas fa-cogs"></i> <strong>1. Process</strong> <span>What
                                    step is
                                    being
                                    done?</span> </div>
                            <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                            <div class="flow-step"> <i class="fas fa-ruler-combined"></i> <strong>2.
                                    Characteristic</strong>
                                <span>What is being measured?</span>
                            </div>
                            <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                            <div class="flow-step"> <i class="fas fa-shield-alt"></i> <strong>3. Control</strong>
                                <span>How is
                                    it
                                    being checked?</span> </div>
                            <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                            <div class="flow-step"> <i class="fas fa-exclamation-triangle"></i> <strong>4.
                                    Reaction</strong>
                                <span>What happens if it's wrong?</span>
                            </div>
                        </div>
                    </div>

                    <div class="content-block">
                        <h2><i class="fas fa-list-ol"></i> Key Components</h2>
                        <ul class="key-components-list">
                            <li><strong>Process Name:</strong> The specific manufacturing step being controlled.</li>
                            <li><strong>Characteristic:</strong> The specific product or process feature being measured.
                            </li>
                            <li><strong>Specification / Tolerance:</strong> The target value and acceptable range.</li>
                            <li><strong>Evaluation Technique:</strong> The tool or method used to perform the
                                measurement.</li>
                            <li><strong>Sample Size / Frequency:</strong> How many parts to check and how often.</li>
                            <li><strong>Control Method:</strong> How the data is recorded and monitored.</li>
                            <li><strong>Reaction Plan:</strong> Predefined actions to take if a characteristic is out of
                                spec.
                            </li>
                        </ul>
                    </div>

                    <div class="content-block">
                        <h2><i class="fas fa-cogs"></i> How to Use This Tool</h2>
                        <div class="instructions-box">
                            <ul>
                                <li>Click <strong><i class="fas fa-plus"></i> Add Row</strong> to add a new process
                                    step.</li>
                                <li>Click the <strong><i class="fas fa-trash-alt"></i></strong> button on any row to
                                    delete it.
                                </li>
                                <li>Use <strong><i class="fas fa-magic"></i> Load Example</strong> or <strong><i
                                            class="fas fa-undo"></i> Reset Plan</strong>.</li>
                                <li>On mobile, scroll the table horizontally to see all columns.</li>
                                <li>Click <strong><i class="fas fa-file-excel"></i> Export to Excel</strong> to download
                                    your
                                    plan.
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-tool')">Go to Control Plan Tool <i
                                class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA 2: CONTROL PLAN TOOL -->
            <div id="tab-tool" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <div class="content-block">
                        <div class="table-container">
                            <table id="controlPlanTable">
                                <thead>
                                    <tr>
                                        <th style="min-width: 150px;"><i class="fas fa-cogs"></i> Process Name</th>
                                        <th style="min-width: 120px;"><i class="fas fa-robot"></i> Machine / Tool</th>
                                        <th style="min-width: 150px;"><i class="fas fa-ruler-combined"></i>
                                            Characteristic</th>
                                        <th style="min-width: 150px;"><i class="fas fa-arrows-alt-h"></i> Spec /
                                            Tolerance</th>
                                        <th style="min-width: 200px;"><i class="fas fa-search"></i> Evaluation Technique
                                        </th>
                                        <th style="min-width: 120px;"><i class="fas fa-box"></i> Sample Size / Freq.
                                        </th>
                                        <th style="min-width: 200px;"><i class="fas fa-shield-alt"></i> Control Method
                                        </th>
                                        <th style="min-width: 200px;"><i class="fas fa-exclamation-triangle"></i>
                                            Reaction Plan
                                        </th>
                                        <th style="min-width: 80px;"><i class="fas fa-times-circle"></i> Action</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>

                        <div class="button-container">
                            <button id="addRowBtn" class="btn-primary"><i class="fas fa-plus"></i> Add Row</button>
                        </div>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab btn-prev" onclick="switchWizardTab('tab-theory')"><i
                                class="fas fa-arrow-left"></i> Back to Theory</button>
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-results')">Go to Results <i
                                class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA 3: RESULTS -->
            <div id="tab-results" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <div class="content-block">
                        <h2><i class="fas fa-chart-line"></i> Control Plan Results</h2>
                        <p>Review your complete control plan below. You can list all results in a readable format and
                            export to Excel for sharing.</p>

                        <div style="text-align: center; margin: 2rem 0;">
                            <button id="listResultsBtn" class="btn-success">
                                <i class="fas fa-list"></i> List Results
                            </button>
                        </div>

                        <div id="resultsContainer" class="results-table-container">
                            <!-- Results will be displayed here -->
                        </div>
                    </div>

                    <!-- BOTÓN DE EXPORTACIÓN -->
                    <div class="export-section">
                        <h3><i class="fas fa-file-export"></i> Export Control Plan</h3>
                        <p>Download your complete control plan as an Excel file for offline use or sharing with your
                            team.</p>
                        <button id="exportBtn" class="btn-success">
                            <i class="fas fa-file-excel"></i> Export to Excel
                        </button>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab btn-prev" onclick="switchWizardTab('tab-tool')"><i
                                class="fas fa-arrow-left"></i> Back to Control Plan Tool</button>
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-theory')">Back to Theory <i
                                class="fas fa-book"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="disclaimer-note">
            <p><strong>Disclaimer:</strong> The tools and information provided on Sigma Exacta are for informational and
                educational purposes only. This Control Plan tool is based on established methodologies, such as those
                found in the Advanced Product Quality Planning (APQP) and IATF 16949 frameworks. The tool on this site
                is an independent implementation and is not affiliated with, sponsored by, or endorsed by the Automotive
                Industry Action Group (AIAG) or any other standards body. While we strive for accuracy, we make no
                warranty or guarantee regarding the results. All decisions based on the output of this tool are the sole
                responsibility of the user. Sigma Exacta and its creators are not liable for any damages or losses
                resulting from the use of this website.</p>
        </div>
    </footer>

    <script>
        // Función para cambiar entre tabs
        function switchWizardTab(tabId) {
            // Quitar clase active de todos los botones y contenidos
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.wizard-tab-content').forEach(content => content.classList.remove('active'));

            // Activar el contenido seleccionado
            document.getElementById(tabId).classList.add('active');

            // Activar botón correspondiente
            const activeBtn = document.querySelector(`button[onclick="switchWizardTab('${tabId}')"]`);
            if (activeBtn) activeBtn.classList.add('active');

            // Scroll al top suavemente
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Constantes y variables globales
        const evaluationTechniques = ["", "Visual Inspection", "Digital Caliper", "Micrometer", "Go/No-Go Gauge", "CMM", "Profilometer", "Coating Thickness Gauge", "Torque Wrench"];
        const controlMethods = ["", "SPC Chart (X-bar & R)", "First-off Inspection Report", "100% Inspection", "Operator Checklist", "Attribute Chart (p/np)", "Destructive Testing", "Process Audit"];
        const reactionPlans = ["", "Stop Process & Quarantine", "Adjust Machine/Tool", "Notify Supervisor", "Sort Suspect Material", "Re-work/Repair Part", "Check Tooling for Wear", "Initiate 8D Report"];
        const exampleData = [
            { processName: "10. Stamping", machine: "Press #5", characteristic: "Hole Diameter", spec: "10.00 ± 0.05 mm", evaluation: "Digital Caliper", sample: "5 pcs / hour", controlMethod: "SPC Chart (X-bar & R)", reactionPlan: "Stop Process & Quarantine" },
            { processName: "20. CNC Machining. This step involves a long description to demonstrate how the text area auto-expands to fit more content.", machine: "Haas VF-2", characteristic: "Surface Finish", spec: "Ra < 1.6 µm", evaluation: "Profilometer", sample: "1 pc / setup", controlMethod: "First-off Inspection Report", reactionPlan: "Adjust Machine/Tool" },
            { processName: "30. Welding", machine: "Robotic Welder #2", characteristic: "Weld Penetration", spec: "3.0 ± 0.2 mm", evaluation: "Visual Inspection", sample: "1 pc / 4 hrs", controlMethod: "Destructive Testing", reactionPlan: "Notify Supervisor" },
            { processName: "40. Painting", machine: "Paint Booth", characteristic: "Paint Thickness", spec: "70 ± 10 µm", evaluation: "Coating Thickness Gauge", sample: "3 spots / part", controlMethod: "100% Inspection", reactionPlan: "Sort Suspect Material" },
            { processName: "50. Assembly", machine: "Line 1", characteristic: "Torque M6 Bolt", spec: "8 ± 1 Nm", evaluation: "Torque Wrench", sample: "100%", controlMethod: "Operator Checklist", reactionPlan: "Re-work/Repair Part" }
        ];

        const tableBody = document.querySelector("#controlPlanTable tbody");

        function autoGrow(element) {
            element.style.height = 'auto';
            element.style.height = (element.scrollHeight) + 'px';
        }

        function createSelect(options, selectedValue = "") {
            const select = document.createElement("select");
            options.forEach(optionText => {
                const option = document.createElement("option");
                option.value = optionText;
                option.textContent = optionText;
                if (optionText === selectedValue) option.selected = true;
                select.appendChild(option);
            });
            return select;
        }

        function createRow(data = {}) {
            const row = document.createElement("tr");
            const createTextarea = (value, placeholder = '...') => `<textarea rows="1" oninput="autoGrow(this)" placeholder="${placeholder}">${value || ''}</textarea>`;
            row.innerHTML = `<td>${createTextarea(data.processName)}</td><td>${createTextarea(data.machine)}</td><td>${createTextarea(data.characteristic)}</td><td>${createTextarea(data.spec)}</td><td></td><td>${createTextarea(data.sample)}</td><td></td><td></td><td class="action-cell"><button class="btn-danger"><i class="fas fa-trash-alt"></i></button></td>`;
            row.cells[4].appendChild(createSelect(evaluationTechniques, data.evaluation));
            row.cells[6].appendChild(createSelect(controlMethods, data.controlMethod));
            row.cells[7].appendChild(createSelect(reactionPlans, data.reactionPlan));
            row.querySelector('.btn-danger').addEventListener('click', () => row.remove());
            tableBody.appendChild(row);
            row.querySelectorAll('textarea').forEach(autoGrow);
        }

        function loadExample() {
            resetPlan();
            exampleData.forEach(rowData => createRow(rowData));
            // Cambiar a la pestaña Control Plan Tool después de cargar el ejemplo
            switchWizardTab('tab-tool');
        }

        function resetPlan() {
            tableBody.innerHTML = '';
        }

        function listResults() {
            const container = document.getElementById('resultsContainer');
            container.innerHTML = '';

            const headers = Array.from(document.querySelectorAll('#controlPlanTable th')).map(th => th.innerText.trim());
            headers.pop(); // Remove Action column

            if (headers.length === 0) {
                container.innerHTML = '<p style="text-align: center; padding: 2rem; color: #777;">No data available. Please add some rows first.</p>';
                return;
            }

            const table = document.createElement('table');
            table.className = 'results-table';

            // Create header
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            headers.forEach(headerText => {
                const th = document.createElement('th');
                th.textContent = headerText;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            // Create body
            const tbody = document.createElement('tbody');
            const rows = document.querySelectorAll('#controlPlanTable tbody tr');

            if (rows.length === 0) {
                container.innerHTML = '<p style="text-align: center; padding: 2rem; color: #777;">No data available. Please add some rows first.</p>';
                return;
            }

            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                const dataRow = document.createElement('tr');

                cells.forEach((cell, index) => {
                    if (index < headers.length) { // Skip Action column
                        const td = document.createElement('td');
                        const input = cell.querySelector('textarea, select');
                        td.textContent = input ? input.value : cell.innerText;
                        dataRow.appendChild(td);
                    }
                });

                tbody.appendChild(dataRow);
            });

            table.appendChild(tbody);
            container.appendChild(table);
        }

        function exportToExcel() {
            const headers = Array.from(document.querySelectorAll('#controlPlanTable th')).map(th => th.innerText.trim());
            headers.pop(); // Remove Action column
            const numCols = headers.length;

            const data = [];

            data.push(["SigmaExacta Control Plan"]);
            data.push(["Generated on: " + new Date().toLocaleString()]);
            data.push([]); // Blank row for spacing
            data.push(headers);

            tableBody.querySelectorAll('tr').forEach(row => {
                const rowData = [];
                row.querySelectorAll('td').forEach((cell, index) => {
                    if (index < numCols) {
                        const input = cell.querySelector('textarea, select');
                        rowData.push(input ? input.value : cell.innerText);
                    }
                });
                data.push(rowData);
            });

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(data);

            if (!ws['!merges']) ws['!merges'] = [];
            ws['!merges'].push({ s: { r: 0, c: 0 }, e: { r: 0, c: numCols - 1 } });
            ws['!merges'].push({ s: { r: 1, c: 0 }, e: { r: 1, c: numCols - 1 } });

            ws['!cols'] = headers.map(h => ({ wch: h.length > 20 ? 30 : 20 }));

            XLSX.utils.book_append_sheet(wb, ws, "Control Plan");
            XLSX.writeFile(wb, "Control_Plan_Sigma_Exacta.xlsx");
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Cargar el header
            fetch('header.html')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('No se pudo cargar header.html');
                    }
                    return response.text();
                })
                .then(data => {
                    document.getElementById('header-placeholder').innerHTML = data;

                    // Inicializar el menú
                    const navToggle = document.getElementById('nav-toggle');
                    const navMenu = document.getElementById('nav-menu');
                    const toolsDropdownToggle = document.getElementById('tools-dropdown-toggle');
                    const toolsDropdownMenu = document.getElementById('tools-dropdown-menu');
                    const toolsDropdownContainer = document.getElementById('tools-dropdown-container');

                    if (navToggle) {
                        navToggle.addEventListener('click', () => {
                            navMenu.classList.toggle('show-menu');
                            const icon = navToggle.querySelector('i');
                            icon.classList.toggle('fa-bars');
                            icon.classList.toggle('fa-times');
                            if (!navMenu.classList.contains('show-menu')) {
                                toolsDropdownMenu.classList.remove('show-submenu');
                                toolsDropdownContainer.classList.remove('active');
                            }
                        });
                    }

                    if (toolsDropdownToggle) {
                        toolsDropdownToggle.addEventListener('click', (event) => {
                            if (window.innerWidth <= 992) {
                                event.preventDefault();
                                toolsDropdownMenu.classList.toggle('show-submenu');
                                toolsDropdownContainer.classList.toggle('active');
                            }
                        });
                    }
                })
                .catch(error => {
                    console.error('Error al cargar el header:', error);
                    document.getElementById('header-placeholder').innerHTML = '<p>Error al cargar el header.</p>';
                });

            // Configurar botones
            document.getElementById("addRowBtn").addEventListener("click", () => createRow());
            document.getElementById("globalLoadExampleBtn").addEventListener("click", loadExample);
            document.getElementById("globalResetBtn").addEventListener("click", resetPlan);
            document.getElementById("exportBtn").addEventListener("click", exportToExcel);
            document.getElementById("listResultsBtn").addEventListener("click", listResults);

            // Crear primera fila por defecto
            createRow();
        });
    </script>

</body>

</html>