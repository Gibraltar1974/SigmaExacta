<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kano Model Analysis Tool | Sigma Exacta</title>
    <link rel="canonical" href="https://sigmaexacta.com/kano" />
    <meta name="description"
        content="Free online interactive Kano Model graph and summary table to analyze customer satisfaction. Visually categorize features to prioritize product development.">
    <meta name="keywords"
        content="Open source, Free software, Kano Model, Kano Analysis, Kano graph, customer satisfaction, product development, feature prioritization, user experience, free tool, chart.js">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="sigma-exacta-icon.jpg" type="image/jpeg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --attractive-color: #3498db;
            --performance-color: #2ecc71;
            --must-be-color: #f1c40f;
            --reverse-color: #9b59b6;
            --indifferent-color: #95a5a6;
            --questionable-color: #e74c3c;
            --light-color: #ecf0f1;
            --danger-color: #c0392b;
            --cs-plus-color: #27ae60;
            --cs-minus-color: #e74c3c;
            font-size: 16px;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Nunito', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            color: #333;
            background-color: #f5f7fa;
            line-height: 1.6;
        }

        /* --- MODIFICACIONES PARA ANCHO RESPONSIVE --- */
        .main-content-wrapper {
            margin: 0 auto;
            padding: 1.25rem;
            max-width: 1400px;
            width: 100%;
            box-sizing: border-box;
        }

        .main-header {
            text-align: center;
            padding: 1rem 1.25rem;
            margin-bottom: 0;
            border-bottom: 1px solid #ddd;
            width: 100%;
            box-sizing: border-box;
        }

        .main-header h1 {
            color: #2c3e50;
            font-size: clamp(1.5rem, 4vw, 1.8rem);
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .tool-logo {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 1.8rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            background-color: #0076a8;
        }

        .main-header p {
            color: #7f8c8d;
            font-weight: 400;
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
        }

        /* --- BOTONES PRINCIPALES SOBRE LAS TABS --- */
        .main-action-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1.5rem auto;
            flex-wrap: wrap;
            max-width: 800px;
        }

        .main-action-buttons button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        .main-action-buttons .btn-example {
            background-color: var(--performance-color);
            color: white;
        }

        .main-action-buttons .btn-example:hover {
            background-color: #27ad60;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        .main-action-buttons .btn-reset {
            background-color: var(--danger-color);
            color: white;
        }

        .main-action-buttons .btn-reset:hover {
            background-color: #a5281c;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        /* ===== ESTILOS DEL SISTEMA DE PESTAÑAS (WIZARD) ===== */
        .tabs-nav {
            display: flex;
            background-color: #f1f5f9;
            border-radius: 8px 8px 0 0;
            overflow-x: auto;
            border-bottom: 2px solid #3498db;
            margin-bottom: 0;
            margin-top: 0.5rem;
            scrollbar-width: none;
            -ms-overflow-style: none;
            width: 100%;
        }

        .tabs-nav::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 1rem 1.5rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 700;
            color: #64748b;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            flex: 1;
            justify-content: center;
        }

        .tab-btn:hover {
            background-color: #e2e8f0;
            color: #2c3e50;
        }

        .tab-btn.active {
            background-color: #fff;
            color: #3498db;
            border-bottom-color: #3498db;
            border-radius: 8px 8px 0 0;
            margin-bottom: -2px;
            border-left: 1px solid #e1e5e9;
            border-right: 1px solid #e1e5e9;
            border-top: 1px solid #e1e5e9;
        }

        .tabs-container {
            background: #fff;
            border: 1px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
            position: relative;
            margin-bottom: 2rem;
            box-sizing: border-box;
        }

        .wizard-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        .wizard-tab-content.active {
            display: block;
            width: 100%;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tab-content-wrapper {
            padding: 2rem;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        @media (max-width: 768px) {
            .tab-content-wrapper {
                padding: 1rem;
            }

            .tab-btn {
                padding: 0.75rem 0.5rem;
                font-size: 0.9rem;
            }

            .main-action-buttons {
                gap: 0.75rem;
                margin: 1rem auto;
            }

            .main-action-buttons button {
                padding: 0.7rem 1.2rem;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .tab-content-wrapper {
                padding: 0.75rem;
            }

            .tab-btn {
                padding: 0.6rem 0.3rem;
                font-size: 0.8rem;
            }

            .main-action-buttons {
                flex-direction: column;
                align-items: stretch;
                gap: 0.5rem;
            }

            .main-action-buttons button {
                width: 100%;
                justify-content: center;
            }
        }

        /* ESTILOS DE CONTENIDO */
        .content-block {
            margin-bottom: 1.5rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .content-block h2 {
            font-size: 1.5em;
            margin-top: 0;
            margin-bottom: 1.25rem;
            color: var(--primary-color);
            border-bottom: 2px solid var(--attractive-color);
            padding-bottom: 0.6rem;
            font-weight: 800;
        }

        .content-block h2 .fas {
            margin-right: 0.75rem;
        }

        .instructions-box ul {
            margin: 0.6rem 0 0 0;
            padding-left: 1.25rem;
            list-style-type: '✔ ';
        }

        .instructions-box li {
            margin-bottom: 0.5rem;
            padding-left: 0.6rem;
            line-height: 1.6;
        }

        label {
            display: block;
            margin-bottom: 0.6rem;
            color: var(--primary-color);
            font-weight: 600;
        }

        input[type="text"],
        select {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            margin-bottom: 1rem;
            transition: border 0.3s, box-shadow 0.3s;
            font-family: 'Nunito', sans-serif;
        }

        input:focus,
        select:focus,
        button:focus-visible {
            outline: none;
            border-color: var(--attractive-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        button {
            color: white;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 1rem;
            transition: background-color 0.3s, box-shadow 0.3s;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
        }

        .btn-primary {
            background-color: var(--attractive-color);
        }

        .btn-primary:hover {
            background-color: #2980b9;
        }

        .btn-success {
            background-color: var(--performance-color);
        }

        .btn-success:hover {
            background-color: #27ad60;
        }

        .btn-warning {
            background-color: #e67e22;
        }

        .btn-warning:hover {
            background-color: #d35400;
        }

        .btn-calculate {
            background-color: #9b59b6;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1.5rem;
            font-size: 1.1rem;
            padding: 0.8rem 1.5rem;
        }

        .btn-calculate:hover {
            background-color: #8e44ad;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .btn-export {
            background-color: #3498db;
            margin-top: 1.5rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.1rem;
            padding: 0.8rem 1.5rem;
        }

        .btn-export:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .chart-container {
            position: relative;
            height: 450px;
            width: 100%;
            margin-top: 2rem;
        }

        /* --- NUEVOS ESTILOS PARA CS INDEX --- */
        .cs-index-container {
            margin-top: 2rem;
            padding: 1.5rem;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid var(--cs-plus-color);
            border-right: 4px solid var(--cs-minus-color);
        }

        .cs-index-container h3 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cs-index-container h3 i {
            font-size: 1.2rem;
        }

        .cs-cards {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .cs-card {
            flex: 1;
            min-width: 200px;
            background: white;
            border-radius: 8px;
            padding: 1.25rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            border-top: 4px solid;
        }

        .cs-card.cs-plus {
            border-color: var(--cs-plus-color);
        }

        .cs-card.cs-minus {
            border-color: var(--cs-minus-color);
        }

        .cs-card h4 {
            margin-top: 0;
            margin-bottom: 0.75rem;
            color: var(--primary-color);
            font-size: 1.1rem;
        }

        .cs-value {
            font-size: 2.2rem;
            font-weight: 800;
            margin: 0.5rem 0;
            line-height: 1;
        }

        .cs-plus .cs-value {
            color: var(--cs-plus-color);
        }

        .cs-minus .cs-value {
            color: var(--cs-minus-color);
        }

        .cs-formula {
            font-size: 0.85rem;
            color: #666;
            margin-top: 0.75rem;
            font-style: italic;
        }

        .cs-explanation {
            background-color: white;
            padding: 1.25rem;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-top: 1rem;
        }

        .cs-explanation h4 {
            margin-top: 0;
            color: var(--primary-color);
            margin-bottom: 0.75rem;
        }

        .cs-explanation ul {
            margin: 0;
            padding-left: 1.25rem;
            color: #555;
        }

        .cs-explanation li {
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }

        /* --- ESTILOS DE LA TABLA DE RESULTADOS --- */
        .summary-table-container {
            margin-top: 2rem;
            overflow-x: auto;
        }

        .summary-table {
            width: 100%;
            border-collapse: collapse;
        }

        .summary-table th,
        .summary-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
            vertical-align: top;
        }

        .summary-table th {
            background-color: #f8f9fa;
            color: var(--primary-color);
            font-weight: 800;
        }

        .summary-table .category-cell {
            width: 30%;
            font-weight: 600;
        }

        .summary-table .features-cell p {
            margin: 0 0 8px 0;
            padding: 5px 8px;
            background-color: var(--light-color);
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
        }

        .summary-table .features-cell p.readonly {
            background-color: #f9f9f9;
            display: block;
        }

        .summary-table .features-cell p.readonly span {
            display: block;
            padding: 5px 0;
        }

        .summary-table .features-cell p:last-child {
            margin-bottom: 0;
        }

        .no-features-message {
            color: #7f8c8d;
            font-style: italic;
            text-align: center;
            padding: 2rem;
        }

        .summary-table .features-cell p span {
            word-break: break-word;
            flex-grow: 1;
            flex-shrink: 1;
            min-width: 0;
        }

        @media (max-width: 600px) {
            .summary-table thead {
                display: none;
            }

            .summary-table tbody tr {
                display: flex;
                flex-direction: column;
                margin-bottom: 1.5rem;
                border: 1px solid #e0e0e0;
                border-radius: 8px;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
            }

            .summary-table td {
                width: 100%;
                border: none;
            }

            .summary-table .category-cell {
                border-bottom: 1px solid #e0e0e0;
                background-color: #f9f9f9;
                padding: 12px 15px;
                border-top-left-radius: 8px;
                border-top-right-radius: 8px;
            }

            .summary-table .features-cell {
                padding: 15px;
            }

            .cs-cards {
                flex-direction: column;
            }

            .cs-card {
                min-width: 100%;
            }
        }

        .remove-btn {
            background: none;
            border: none;
            color: #aaa;
            cursor: pointer;
            padding: 2px 5px;
            font-size: 1em;
            line-height: 1;
            transition: color 0.2s;
            flex-shrink: 0;
        }

        .remove-btn:hover {
            color: var(--danger-color);
        }

        .remove-category-btn {
            background-color: #f2f2f2;
            color: #888;
            border: 1px solid #ddd;
            font-size: 0.75rem;
            padding: 3px 8px;
            font-weight: normal;
            margin-left: 10px;
        }

        .remove-category-btn:hover {
            background-color: var(--danger-color);
            color: white;
            border-color: var(--danger-color);
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .calculate-button-container {
            text-align: center;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px solid #eee;
        }

        .export-section {
            text-align: center;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px dashed #ddd;
        }

        .tab-nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
            width: 100%;
            box-sizing: border-box;
        }

        .btn-next-tab {
            background-color: #3498db;
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn-next-tab:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        .btn-next-tab.btn-prev {
            background-color: #95a5a6;
        }

        .btn-next-tab.btn-prev:hover {
            background-color: #7f8c8d;
        }

        footer {
            padding: 2rem 1.25rem;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .disclaimer-note {
            margin-top: 2rem;
            padding: 0 1rem;
            font-size: 0.8rem;
            color: #777;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
            text-align: left;
            line-height: 1.6;
        }
    </style>
</head>

<body>

    <!-- Contenedor donde se cargará el header dinámicamente -->
    <div id="header-container"></div>

    <noscript>
        <nav>
            <a href="/">Home</a> |
            <a href="/8d">8D Tool</a> |
            <a href="/taguchi_doe">Taguchi DOE</a> |
            <a href="/swot">SWOT Analysis</a> |
            <a href="/balancedcard">Balanced Scorecard</a> |
            <a href="/qfd">QFD</a> |
            <a href="/apqp-ppap">APQP/PPAP</a> |
            <a href="/ishikawa">Ishikawa</a> |
            <a href="/fmea">FMEA</a> |
            <a href="/vave">VAVE</a> |
            <a href="/eisenhower">Eisenhower Matrix</a> |
            <a href="/triz">TRIZ</a> |
            <a href="/weibull">Weibull</a> |
            <a href="/stack_up_analysis">Tolerance Stack-Up</a> |
            <a href="/pdca">PDCA</a> |
            <a href="/design_thinking">Design Thinking</a> |
            <a href="/pugh">Pugh Matrix</a> |
            <a href="/cpk_calculator">CpK Calculator</a> |
            <a href="/control-plan">Control Plan</a>
        </nav>
    </noscript>

    <main class="main-content-wrapper">
        <header class="main-header">
            <h1>
                <div class="tool-logo" title="Kano Model">
                    <i class="fas fa-heart"></i>
                </div>
                Free Online Customer Satisfaction (Kano Model) Interactive Tool
            </h1>
            <p>Prioritize features by visualizing their impact on customer satisfaction.</p>

            <!-- BOTONES PRINCIPALES -->
            <div class="main-action-buttons">
                <button id="globalLoadExampleBtn" class="btn-example">
                    <i class="fas fa-play-circle"></i> Load Example
                </button>
                <button id="globalResetBtn" class="btn-reset">
                    <i class="fas fa-sync-alt"></i> Reset All
                </button>
            </div>
        </header>

        <!-- CONTENEDOR DE TABS -->
        <div class="tabs-container">
            <!-- NAVEGACIÓN DE PESTAÑAS (WIZARD) -->
            <nav class="tabs-nav">
                <button class="tab-btn active" onclick="switchWizardTab('tab-theory')">
                    <i class="fas fa-book"></i> Theory & Info
                </button>
                <button class="tab-btn" onclick="switchWizardTab('tab-input-edit')">
                    <i class="fas fa-edit"></i> Input & Edit Features
                </button>
                <button class="tab-btn" onclick="switchWizardTab('tab-results')">
                    <i class="fas fa-chart-line"></i> Results
                </button>
            </nav>

            <!-- PESTAÑA 1: TEORÍA -->
            <div id="tab-theory" class="wizard-tab-content active">
                <div class="tab-content-wrapper">
                    <div class="content-block">
                        <h2><i class="fas fa-question-circle"></i> What is the Kano Model?</h2>
                        <p>The <strong>Kano Model</strong> is a framework for product development and customer
                            satisfaction. It
                            classifies product attributes into five categories based on how customers perceive them.
                            This helps
                            teams distinguish between basic necessities and delightful extras, making it easier to
                            prioritize
                            features that will have the most positive impact.</p>
                        <ul>
                            <li><strong>Must-Be (Basic)</strong>: Expected features. Their absence causes
                                dissatisfaction, but their
                                presence is taken for granted (e.g., brakes on a car).</li>
                            <li><strong>Performance</strong>: The more of these, the better. Satisfaction is
                                proportional to their
                                level of execution (e.g., battery life).</li>
                            <li><strong>Attractive (Delighters)</strong>: Unexpected features. Their presence delights
                                customers,
                                but their absence does not cause dissatisfaction (e.g., a surprise upgrade).</li>
                            <li><strong>Indifferent</strong>: Features customers don't care about.</li>
                            <li><strong>Reverse</strong>: Features that cause dissatisfaction when present.</li>
                        </ul>
                    </div>

                    <div class="content-block">
                        <h2><i class="fas fa-history"></i> Origin of the Model</h2>
                        <p>The model was developed in the 1980s by <strong>Dr. Noriaki Kano</strong>, a professor of
                            quality
                            management at the Tokyo University of Science. While researching what drives customer
                            satisfaction and
                            loyalty, he challenged the traditional belief that improving every feature would
                            proportionally increase
                            satisfaction.</p>
                        <p>His findings revealed a non-linear relationship between product functionality and customer
                            emotional
                            response, leading to the creation of the five distinct categories. The Kano Model has since
                            become a
                            vital tool in user experience (UX), marketing, and product strategy.</p>
                    </div>

                    <div class="content-block">
                        <h2><i class="fas fa-calculator"></i> Customer Satisfaction Index (CS)</h2>
                        <p>The <strong>Customer Satisfaction Index (CS)</strong> is a quantitative measure that helps
                            you understand the impact of features on customer satisfaction and dissatisfaction.</p>
                        <ul>
                            <li><strong>CS+ (Satisfaction Index)</strong>: Measures how much satisfaction a feature will
                                generate if implemented.</li>
                            <li><strong>CS- (Dissatisfaction Index)</strong>: Measures how much dissatisfaction will
                                occur if a feature is NOT implemented.</li>
                        </ul>
                        <p><strong>Formula:</strong> Based on survey responses, where A=Attractive, O=Performance
                            (One-dimensional), M=Must-be, I=Indifferent:</p>
                        <ul>
                            <li><strong>CS+ = (A + O) / (A + O + M + I)</strong></li>
                            <li><strong>CS- = (O + M) / (A + O + M + I) × (-1)</strong></li>
                        </ul>
                        <p>Values range from 0 to 1 for CS+ and 0 to -1 for CS-. Higher CS+ indicates greater
                            satisfaction impact, while lower CS- indicates greater dissatisfaction avoidance.</p>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-input-edit')">Start Adding Features
                            <i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA 2: INPUT & EDIT FEATURES -->
            <div id="tab-input-edit" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <div class="content-block">
                        <h2><i class="fas fa-edit"></i> Add Features to Your Kano Analysis</h2>
                        <form id="featureForm">
                            <label for="featureInput">Feature Description:</label>
                            <input type="text" id="featureInput" placeholder="e.g., Free welcome drink" required>

                            <label for="functionalSelect">If the feature IS present, the customer feels:</label>
                            <select id="functionalSelect">
                                <option value="0">1. Like it</option>
                                <option value="1">2. Expect it (Must-be)</option>
                                <option value="2">3. Neutral</option>
                                <option value="3">4. Can live with it</option>
                                <option value="4">5. Dislike it</option>
                            </select>

                            <label for="dysfunctionalSelect">If the feature IS NOT present, the customer feels:</label>
                            <select id="dysfunctionalSelect">
                                <option value="0">1. Like it</option>
                                <option value="1">2. Expect it (Must-be)</option>
                                <option value="2">3. Neutral</option>
                                <option value="3">4. Can live with it</option>
                                <option value="4">5. Dislike it</option>
                            </select>

                            <div style="text-align: center;">
                                <button type="submit" class="btn-primary"><i class="fas fa-plus"></i> Add to
                                    Analysis</button>
                            </div>
                        </form>
                    </div>

                    <!-- TABLA DE CATEGORIZACIÓN EN LA PESTAÑA DE INPUT/EDIT -->
                    <div class="content-block">
                        <h2><i class="fas fa-list"></i> Feature Categorization</h2>
                        <div class="summary-table-container">
                            <table class="summary-table">
                                <thead>
                                    <tr>
                                        <th>Category</th>
                                        <th>Features</th>
                                    </tr>
                                </thead>
                                <tbody id="summaryTableBody">
                                </tbody>
                            </table>
                        </div>

                        <!-- BOTÓN CALCULATE -->
                        <div class="calculate-button-container">
                            <button id="calculateBtn" class="btn-calculate">
                                <i class="fas fa-calculator"></i> Calculate & View Results
                            </button>
                        </div>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab btn-prev" onclick="switchWizardTab('tab-theory')"><i
                                class="fas fa-arrow-left"></i> Back to Theory</button>
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-results')">Go to Results <i
                                class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA 3: RESULTS -->
            <div id="tab-results" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <!-- GRÁFICO -->
                    <div class="content-block">
                        <h2><i class="fas fa-chart-line"></i> Kano Analysis Visualization</h2>
                        <div class="chart-container">
                            <canvas id="kanoChart"></canvas>
                        </div>
                    </div>

                    <!-- CS INDEX -->
                    <div id="csIndexContainer" class="content-block">
                        <h2><i class="fas fa-calculator"></i> Customer Satisfaction Index (CS)</h2>
                        <div class="cs-cards">
                            <div class="cs-card cs-plus">
                                <h4>Satisfaction Index (CS+)</h4>
                                <div class="cs-value" id="csPlusValue">0.00</div>
                                <div>Impact on satisfaction if implemented</div>
                                <div class="cs-formula">CS+ = (A + O) / (A + O + M + I)</div>
                            </div>
                            <div class="cs-card cs-minus">
                                <h4>Dissatisfaction Index (CS-)</h4>
                                <div class="cs-value" id="csMinusValue">0.00</div>
                                <div>Impact on dissatisfaction if NOT implemented</div>
                                <div class="cs-formula">CS- = (O + M) / (A + O + M + I) × (-1)</div>
                            </div>
                        </div>
                        <div class="cs-explanation">
                            <h4>Interpretation:</h4>
                            <ul>
                                <li><strong>CS+ close to 1.0:</strong> Implementing these features will significantly
                                    increase customer satisfaction.</li>
                                <li><strong>CS- close to -1.0:</strong> Not implementing these features will cause
                                    significant dissatisfaction.</li>
                                <li><strong>Both values near 0:</strong> Features have minimal impact on customer
                                    satisfaction/dissatisfaction.</li>
                                <li>For optimal results, prioritize features with <strong>high CS+</strong> and
                                    <strong>low CS-</strong> (more negative).</li>
                            </ul>
                        </div>
                    </div>

                    <!-- TABLA DE CATEGORIZACIÓN (READ-ONLY) -->
                    <div class="content-block">
                        <h2><i class="fas fa-list"></i> Feature Categorization Results</h2>
                        <div class="summary-table-container">
                            <table class="summary-table">
                                <thead>
                                    <tr>
                                        <th>Category</th>
                                        <th>Features</th>
                                    </tr>
                                </thead>
                                <tbody id="resultsTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- BOTÓN DE EXPORTACIÓN -->
                    <div class="export-section">
                        <h3><i class="fas fa-file-export"></i> Export Complete Analysis</h3>
                        <p>Download a comprehensive report of your Kano analysis including the visualization data, CS
                            Index, and all categorized features for offline use or sharing with your team.</p>
                        <button id="exportBtn" class="btn-export">
                            <i class="fas fa-file-excel"></i> Export Full Analysis to Excel
                        </button>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab btn-prev" onclick="switchWizardTab('tab-input-edit')"><i
                                class="fas fa-arrow-left"></i> Back to Input & Edit</button>
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-theory')">Back to Theory <i
                                class="fas fa-book"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="disclaimer-note">
            <p><strong>Disclaimer:</strong> The Kano Model is a theory developed by Noriaki Kano. This tool is an
                independent implementation provided for educational and informational purposes only. It is not
                affiliated with, sponsored by, or endorsed by Noriaki Kano or his affiliated institutions. The use of
                this tool is at your own risk, and all decisions made based on its output are the sole responsibility of
                the user. Sigma Exacta and its creators are not liable for any damages or losses resulting from its use.
            </p>
        </div>
    </footer>

    <script>
        // Función para cambiar entre tabs
        function switchWizardTab(tabId) {
            // Quitar clase active de todos los botones y contenidos
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.wizard-tab-content').forEach(content => content.classList.remove('active'));

            // Activar el contenido seleccionado
            document.getElementById(tabId).classList.add('active');

            // Activar botón correspondiente
            const activeBtn = document.querySelector(`button[onclick="switchWizardTab('${tabId}')"]`);
            if (activeBtn) activeBtn.classList.add('active');

            // Si estamos en la pestaña de Results y el gráfico existe, actualizarlo
            if (tabId === 'tab-results' && window.kanoApp && window.kanoApp.kanoChart) {
                setTimeout(() => {
                    if (window.kanoApp.kanoChart) {
                        window.kanoApp.kanoChart.resize();
                        window.kanoApp.kanoChart.update();
                    }
                }, 100);
            }

            // Scroll al top suavemente
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Cargar el header dinámicamente
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-container').innerHTML = data;
                // Inicializar el menú después de cargar el header
                initNavigationMenu();
            })
            .catch(error => console.error('Error loading header:', error));

        // Función para inicializar el menú de navegación
        function initNavigationMenu() {
            const navToggle = document.getElementById('nav-toggle');
            const navMenu = document.getElementById('nav-menu');
            const toolsDropdownToggle = document.getElementById('tools-dropdown-toggle');
            const toolsDropdownMenu = document.getElementById('tools-dropdown-menu');
            const toolsDropdownContainer = document.getElementById('tools-dropdown-container');

            if (navToggle && navMenu) {
                navToggle.addEventListener('click', () => {
                    navMenu.classList.toggle('show-menu');
                    const icon = navToggle.querySelector('i');
                    icon.classList.toggle('fa-bars');
                    icon.classList.toggle('fa-times');

                    if (!navMenu.classList.contains('show-menu') && toolsDropdownContainer) {
                        toolsDropdownMenu.classList.remove('show-submenu');
                        toolsDropdownContainer.classList.remove('active');
                    }
                });
            }
            if (toolsDropdownToggle && toolsDropdownMenu && toolsDropdownContainer) {
                toolsDropdownToggle.addEventListener('click', (event) => {
                    if (window.innerWidth <= 992) {
                        event.preventDefault();
                        toolsDropdownMenu.classList.toggle('show-submenu');
                        toolsDropdownContainer.classList.toggle('active');
                    }
                });
            }
        }

        // Functions to remove features/categories declared globally
        function removeFeature(featureName) {
            window.kanoApp.removeFeature(featureName);
        }

        function removeCategory(categoryName) {
            window.kanoApp.removeCategory(categoryName);
        }

        document.addEventListener('DOMContentLoaded', () => {
            // App logic is now encapsulated in an object on the window
            window.kanoApp = {
                init: function () {
                    this.cacheDOM();
                    this.initChartLogo();
                    this.bindEvents();
                    this.updateUI();
                },
                cacheDOM: function () {
                    this.featureForm = document.getElementById('featureForm');
                    this.featureInput = document.getElementById('featureInput');
                    this.functionalSelect = document.getElementById('functionalSelect');
                    this.dysfunctionalSelect = document.getElementById('dysfunctionalSelect');
                    this.globalLoadExampleBtn = document.getElementById('globalLoadExampleBtn');
                    this.globalResetBtn = document.getElementById('globalResetBtn');
                    this.calculateBtn = document.getElementById('calculateBtn');
                    this.exportBtn = document.getElementById('exportBtn');
                    this.ctx = document.getElementById('kanoChart').getContext('2d');
                    this.summaryTableBody = document.getElementById('summaryTableBody');
                    this.resultsTableBody = document.getElementById('resultsTableBody');
                    this.csPlusValue = document.getElementById('csPlusValue');
                    this.csMinusValue = document.getElementById('csMinusValue');
                },
                // State
                kanoChart: null,
                analyzedFeatures: [],
                logoImage: new Image(),
                logoLoaded: false,

                // Constants
                kanoTable: [
                    ['Q', 'A', 'A', 'A', 'P'], ['R', 'I', 'I', 'I', 'M'], ['R', 'I', 'I', 'I', 'M'],
                    ['R', 'I', 'I', 'I', 'M'], ['R', 'R', 'R', 'R', 'Q']
                ],
                categoryOrder: ['Attractive', 'Performance', 'Must-Be', 'Indifferent', 'Reverse', 'Questionable'],
                categoryMap: {
                    'P': 'Performance', 'A': 'Attractive', 'M': 'Must-Be',
                    'I': 'Indifferent', 'R': 'Reverse', 'Q': 'Questionable'
                },
                colorMap: {
                    'Attractive': '#3498db', 'Performance': '#2ecc71', 'Must-Be': '#f1c40f',
                    'Indifferent': '#95a5a6', 'Reverse': '#9b59b6', 'Questionable': '#e74c3c'
                },
                iconMap: {
                    'Attractive': 'fas fa-gem', 'Performance': 'fas fa-chart-line', 'Must-Be': 'fas fa-check-square',
                    'Indifferent': 'fas fa-meh', 'Reverse': 'fas fa-undo', 'Questionable': 'fas fa-question-circle'
                },

                // Methods
                initChartLogo: function () {
                    this.logoImage.src = 'sigma-exacta-icon.jpg';
                    this.logoImage.onload = () => {
                        this.logoLoaded = true;
                        if (this.kanoChart) this.kanoChart.draw();
                    };
                },
                bindEvents: function () {
                    this.featureForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        const description = this.featureInput.value.trim();
                        if (description) {
                            this.addFeatureToList(description, parseInt(this.functionalSelect.value, 10), parseInt(this.dysfunctionalSelect.value, 10));
                            this.featureInput.value = '';
                            this.featureInput.focus();
                        }
                    });

                    // Botones globales
                    this.globalLoadExampleBtn.addEventListener('click', () => this.loadExample());
                    this.globalResetBtn.addEventListener('click', () => this.resetAnalysis());

                    // Botón para calcular y ver resultados
                    this.calculateBtn.addEventListener('click', () => {
                        if (this.analyzedFeatures.length === 0) {
                            alert("Please add at least one feature to calculate results.");
                        } else {
                            switchWizardTab('tab-results');
                        }
                    });

                    this.exportBtn.addEventListener('click', () => this.exportAnalysis());
                },
                addFeatureToList: function (description, funcAnswer, dysfuncAnswer) {
                    const categoryCode = this.kanoTable[funcAnswer][dysfuncAnswer];
                    const categoryName = this.categoryMap[categoryCode];
                    this.analyzedFeatures.push({ name: description, category: categoryName });
                    this.updateUI();

                    // Mostrar notificación de éxito
                    this.showNotification(`"${description}" added as ${categoryName}`);
                },
                showNotification: function (message) {
                    // Crear elemento de notificación
                    const notification = document.createElement('div');
                    notification.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background-color: var(--performance-color);
                        color: white;
                        padding: 15px 20px;
                        border-radius: 5px;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                        z-index: 1000;
                        animation: slideIn 0.3s ease;
                        max-width: 300px;
                        font-weight: 600;
                    `;

                    // Animación CSS
                    const style = document.createElement('style');
                    style.textContent = `
                        @keyframes slideIn {
                            from { transform: translateX(100%); opacity: 0; }
                            to { transform: translateX(0); opacity: 1; }
                        }
                        @keyframes fadeOut {
                            from { opacity: 1; }
                            to { opacity: 0; }
                        }
                    `;
                    document.head.appendChild(style);

                    notification.textContent = message;
                    document.body.appendChild(notification);

                    // Remover después de 3 segundos
                    setTimeout(() => {
                        notification.style.animation = 'fadeOut 0.5s ease';
                        setTimeout(() => {
                            document.body.removeChild(notification);
                        }, 500);
                    }, 3000);
                },
                removeFeature: function (featureName) {
                    this.analyzedFeatures = this.analyzedFeatures.filter(f => f.name !== featureName);
                    this.updateUI();
                    this.showNotification(`"${featureName}" removed from analysis`);
                },
                removeCategory: function (categoryName) {
                    this.analyzedFeatures = this.analyzedFeatures.filter(f => f.category !== categoryName);
                    this.updateUI();
                    this.showNotification(`All "${categoryName}" features removed`);
                },
                resetAnalysis: function () {
                    if (this.analyzedFeatures.length > 0) {
                        if (confirm("Are you sure you want to reset all analysis? This will remove all features.")) {
                            this.analyzedFeatures = [];
                            this.updateUI();
                            this.featureInput.focus();
                            this.showNotification("Analysis reset successfully");
                        }
                    }
                },
                loadExample: function () {
                    if (this.analyzedFeatures.length > 0) {
                        if (!confirm("Loading example data will replace your current analysis. Continue?")) {
                            return;
                        }
                    }

                    this.analyzedFeatures = [];
                    const exampleData = [
                        { name: 'Fast Check-in', func: 0, dysfunc: 4 },
                        { name: 'Longer Battery Life', func: 0, dysfunc: 4 },
                        { name: 'Free Welcome Drink', func: 0, dysfunc: 2 },
                        { name: 'Unexpected Room Upgrade', func: 0, dysfunc: 2 },
                        { name: 'Clean Room', func: 1, dysfunc: 4 },
                        { name: 'Working Wi-Fi', func: 2, dysfunc: 4 },
                        { name: 'Brand of A/C unit', func: 2, dysfunc: 2 },
                        { name: 'Too many notifications', func: 4, dysfunc: 0 },
                        { name: 'Confusing Instructions', func: 4, dysfunc: 2 },
                        { name: 'Useless Feature (Liked/Liked)', func: 0, dysfunc: 0 }
                    ];

                    exampleData.forEach(f => this.addFeatureToList(f.name, f.func, f.dysfunc));

                    // Cambiar a la pestaña de resultados
                    setTimeout(() => switchWizardTab('tab-results'), 500);
                },
                // Calcular CS Index
                calculateCSIndex: function (featuresByCategory) {
                    // Contar categorías relevantes para CS
                    const counts = {
                        'Attractive': featuresByCategory['Attractive'] ? featuresByCategory['Attractive'].length : 0,
                        'Performance': featuresByCategory['Performance'] ? featuresByCategory['Performance'].length : 0,
                        'Must-Be': featuresByCategory['Must-Be'] ? featuresByCategory['Must-Be'].length : 0,
                        'Indifferent': featuresByCategory['Indifferent'] ? featuresByCategory['Indifferent'].length : 0
                    };

                    const total = counts['Attractive'] + counts['Performance'] + counts['Must-Be'] + counts['Indifferent'];

                    let csPlus = 0;
                    let csMinus = 0;

                    if (total > 0) {
                        // CS+ = (A + O) / (A + O + M + I)
                        csPlus = (counts['Attractive'] + counts['Performance']) / total;

                        // CS- = (O + M) / (A + O + M + I) × (-1)
                        csMinus = (counts['Performance'] + counts['Must-Be']) / total * (-1);
                    }

                    // Formatear a 2 decimales
                    return {
                        csPlus: csPlus.toFixed(2),
                        csMinus: csMinus.toFixed(2),
                        counts: counts,
                        total: total
                    };
                },
                // Actualizar display del CS Index
                updateCSIndex: function (featuresByCategory) {
                    const csData = this.calculateCSIndex(featuresByCategory);

                    this.csPlusValue.textContent = csData.csPlus;
                    this.csMinusValue.textContent = csData.csMinus;

                    // Ocultar/mostrar sección CS basado en si hay datos
                    const csContainer = document.getElementById('csIndexContainer');
                    if (csData.total === 0) {
                        csContainer.style.display = 'none';
                    } else {
                        csContainer.style.display = 'block';
                    }
                },
                updateUI: function () {
                    const featuresByCategory = this.analyzedFeatures.reduce((acc, feature) => {
                        (acc[feature.category] = acc[feature.category] || []).push(feature);
                        return acc;
                    }, {});

                    this.drawChart(featuresByCategory);
                    this.updateSummaryTable(featuresByCategory);
                    this.updateResultsTable(featuresByCategory);
                    this.updateCSIndex(featuresByCategory);
                },
                generatePointsForCategory: function (category) {
                    const jitterX = (Math.random() - 0.5) * 0.4;
                    const jitterY = (Math.random() - 0.5) * 0.4;
                    let x, y;
                    switch (category) {
                        case 'Attractive': x = 0.5 + jitterX; y = 0.7 + jitterY; break;
                        case 'Performance': x = 0.7 + jitterX * 0.5; y = 0.7 + jitterY * 0.5; break;
                        case 'Must-Be': x = -0.7 + jitterX; y = -0.7 + jitterY; break;
                        case 'Indifferent': x = 0 + jitterX * 1.5; y = 0 + jitterY * 0.3; break;
                        case 'Reverse': x = -0.7 + jitterX; y = 0.7 + jitterY; break;
                        case 'Questionable': x = 0 + jitterX; y = -0.9 + jitterY * 0.2; break;
                        default: x = 0; y = 0; break;
                    }
                    return { x: Math.max(-1, Math.min(1, x)), y: Math.max(-1, Math.min(1, y)) };
                },
                // CORRECCIÓN DE CURVAS TEÓRICAS DEL MODELO KANO
                drawChart: function (featuresByCategory) {
                    if (this.kanoChart) this.kanoChart.destroy();

                    // Generar puntos para las curvas teóricas
                    const datasets = [
                        // Curva Atractiva (Attractive) - Azul
                        {
                            type: 'line',
                            data: Array.from({ length: 50 }, (_, i) => {
                                const x = -1 + (2 / 49) * i;
                                // Función cuadrática: y = (x+1)^2/4
                                // En x=-1: y=0, en x=0: y=0.25, en x=1: y=1
                                return { x: x, y: Math.pow(x + 1, 2) / 4 };
                            }),
                            borderColor: 'rgba(52, 152, 219, 0.5)',
                            borderWidth: 3,
                            pointRadius: 0,
                            tension: 0.4
                        },
                        // Línea Performance (One-dimensional) - Verde
                        {
                            type: 'line',
                            data: Array.from({ length: 50 }, (_, i) => {
                                const x = -1 + (2 / 49) * i;
                                return { x: x, y: x };
                            }),
                            borderColor: 'rgba(46, 204, 113, 0.5)',
                            borderWidth: 3,
                            pointRadius: 0
                        },
                        // Curva Must-Be (Basic) - Amarilla
                        {
                            type: 'line',
                            data: Array.from({ length: 50 }, (_, i) => {
                                const x = -1 + (2 / 49) * i;
                                // Función cuadrática: y = -(1-x)^2/4
                                // En x=-1: y=-1, en x=0: y=-0.25, en x=1: y=0
                                return { x: x, y: -Math.pow(1 - x, 2) / 4 };
                            }),
                            borderColor: 'rgba(241, 196, 15, 0.5)',
                            borderWidth: 3,
                            pointRadius: 0,
                            tension: 0.4
                        },
                        // Línea Reverse (Inversa) - Púrpura
                        {
                            type: 'line',
                            data: Array.from({ length: 50 }, (_, i) => {
                                const x = -1 + (2 / 49) * i;
                                return { x: x, y: -x };
                            }),
                            borderColor: 'rgba(155, 89, 182, 0.5)',
                            borderWidth: 3,
                            pointRadius: 0
                        }
                    ];

                    // Agregar puntos de características
                    for (const category in featuresByCategory) {
                        if (featuresByCategory.hasOwnProperty(category)) {
                            datasets.push({
                                type: 'scatter',
                                label: category,
                                data: featuresByCategory[category].map(feature => ({
                                    ...this.generatePointsForCategory(category),
                                    featureName: feature.name
                                })),
                                backgroundColor: this.colorMap[category] || '#000',
                                pointRadius: 7,
                                pointHoverRadius: 9
                            });
                        }
                    }

                    const logoPlugin = {
                        id: 'customLogo',
                        afterDraw: (chart) => {
                            if (this.logoLoaded) {
                                const ctx = chart.ctx;
                                const logoSize = 60;
                                const x = chart.chartArea.left + 15;
                                const y = chart.chartArea.top + 15;

                                ctx.save();
                                ctx.fillStyle = 'white';
                                ctx.fillRect(x, y, logoSize, logoSize);
                                ctx.globalCompositeOperation = 'difference';
                                ctx.drawImage(this.logoImage, x, y, logoSize, logoSize);
                                ctx.restore();
                            }
                        }
                    };

                    this.kanoChart = new Chart(this.ctx, {
                        data: { datasets },
                        plugins: [logoPlugin],
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    type: 'linear',
                                    position: 'bottom',
                                    min: -1.1,
                                    max: 1.1,
                                    title: {
                                        display: true,
                                        text: '← Not Fulfilled · Fulfilled →',
                                        font: { size: 14, color: 'black' }  // Ejes en color negro
                                    },
                                    grid: {
                                        color: 'rgba(0, 0, 0, 0.1)', // Color de la cuadrícula
                                        zeroLineColor: 'black',
                                        zeroLineWidth: 2
                                    },
                                    ticks: {
                                        display: false,
                                        color: 'black'  // Color de los ticks
                                    }
                                },
                                y: {
                                    type: 'linear',
                                    min: -1.1,
                                    max: 1.1,
                                    title: {
                                        display: true,
                                        text: '← Dissatisfaction · Satisfaction →',
                                        font: { size: 14, color: 'black' }  // Ejes en color negro
                                    },
                                    grid: {
                                        color: 'rgba(0, 0, 0, 0.1)', // Color de la cuadrícula
                                        zeroLineColor: 'black',
                                        zeroLineWidth: 2
                                    },
                                    ticks: {
                                        display: false,
                                        color: 'black'  // Color de los ticks
                                    }
                                }
                            },
                            plugins: {
                                tooltip: {
                                    callbacks: {
                                        label: (c) => c.dataset.type === 'scatter' ? ` ${c.raw.featureName}` : null,
                                        title: (c) => c[0].dataset.type === 'scatter' ? c[0].dataset.label : null
                                    }
                                },
                                legend: { display: false }
                            }
                        }
                    });
                },
                // Actualizar tabla editable en Input & Edit tab
                updateSummaryTable: function (featuresByCategory) {
                    this.summaryTableBody.innerHTML = '';
                    if (this.analyzedFeatures.length === 0) {
                        const row = this.summaryTableBody.insertRow();
                        const cell = row.insertCell();
                        cell.colSpan = 2;
                        cell.className = 'no-features-message';
                        cell.textContent = 'No features analyzed yet. Add a feature in the form above to get started.';
                        return;
                    }

                    this.categoryOrder.forEach(category => {
                        const features = featuresByCategory[category];
                        if (features && features.length > 0) {
                            const row = this.summaryTableBody.insertRow();
                            const categoryCell = row.insertCell();
                            categoryCell.className = 'category-cell';

                            const escapedCategory = category.replace(/'/g, "\\'");
                            categoryCell.innerHTML = `
                      <div class="category-header">
                        <div>
                          <i class="${this.iconMap[category]}" style="color: ${this.colorMap[category]}"></i>
                          <span style="color: ${this.colorMap[category]}">${category}</span>
                          <span style="font-size: 0.85rem; color: #777; margin-left: 8px;">(${features.length})</span>
                        </div>
                        <button class="remove-category-btn" onclick="removeCategory('${escapedCategory}')" title="Remove all in ${category}">
                          <i class="fas fa-trash-alt"></i>
                        </button>
                      </div>
                    `;

                            const featuresCell = row.insertCell();
                            featuresCell.className = 'features-cell';
                            featuresCell.innerHTML = features.map(f => {
                                const escapedName = f.name.replace(/'/g, "\\'");
                                return `<p><span>${f.name}</span> <button class="remove-btn" onclick="removeFeature('${escapedName}')" title="Remove feature"><i class="fas fa-trash-alt"></i></button></p>`;
                            }).join('');
                        }
                    });
                },
                // Actualizar tabla de solo lectura en Results tab
                updateResultsTable: function (featuresByCategory) {
                    this.resultsTableBody.innerHTML = '';
                    if (this.analyzedFeatures.length === 0) {
                        const row = this.resultsTableBody.insertRow();
                        const cell = row.insertCell();
                        cell.colSpan = 2;
                        cell.className = 'no-features-message';
                        cell.textContent = 'No features analyzed yet. Add a feature in the Input & Edit tab to get started.';
                        return;
                    }

                    this.categoryOrder.forEach(category => {
                        const features = featuresByCategory[category];
                        if (features && features.length > 0) {
                            const row = this.resultsTableBody.insertRow();
                            const categoryCell = row.insertCell();
                            categoryCell.className = 'category-cell';

                            categoryCell.innerHTML = `
                      <div class="category-header">
                        <div>
                          <i class="${this.iconMap[category]}" style="color: ${this.colorMap[category]}"></i>
                          <span style="color: ${this.colorMap[category]}">${category}</span>
                          <span style="font-size: 0.85rem; color: #777; margin-left: 8px;">(${features.length})</span>
                        </div>
                      </div>
                    `;

                            const featuresCell = row.insertCell();
                            featuresCell.className = 'features-cell';
                            featuresCell.innerHTML = features.map(f => {
                                return `<p class="readonly"><span>${f.name}</span></p>`;
                            }).join('');
                        }
                    });
                },
                exportAnalysis: function () {
                    if (this.analyzedFeatures.length === 0) {
                        alert("⚠️ No features to export. Please analyze some features first.");
                        return;
                    }

                    // Calcular CS index para incluirlo en el export
                    const featuresByCategory = this.analyzedFeatures.reduce((acc, feature) => {
                        (acc[feature.category] = acc[feature.category] || []).push(feature);
                        return acc;
                    }, {});
                    const csData = this.calculateCSIndex(featuresByCategory);

                    // Crear datos para exportar
                    let featuresData = [];

                    // Encabezado
                    featuresData.push({
                        'Feature': '=== KANO MODEL ANALYSIS ===',
                        'Kano Category': 'Sigma Exacta Tool'
                    });
                    featuresData.push({ 'Feature': '', 'Kano Category': '' });

                    // Características categorizadas
                    featuresData.push({
                        'Feature': '=== FEATURE CATEGORIZATION ===',
                        'Kano Category': ''
                    });

                    // Agregar cada característica
                    this.analyzedFeatures.forEach(f => {
                        featuresData.push({
                            'Feature': f.name,
                            'Kano Category': f.category
                        });
                    });

                    // Espacio
                    featuresData.push({ 'Feature': '', 'Kano Category': '' });

                    // CS Index
                    featuresData.push({
                        'Feature': '=== CUSTOMER SATISFACTION INDEX ===',
                        'Kano Category': ''
                    });
                    featuresData.push({
                        'Feature': 'CS+ (Satisfaction Index)',
                        'Kano Category': csData.csPlus
                    });
                    featuresData.push({
                        'Feature': 'CS- (Dissatisfaction Index)',
                        'Kano Category': csData.csMinus
                    });
                    featuresData.push({ 'Feature': '', 'Kano Category': '' });

                    // Conteo de categorías
                    featuresData.push({
                        'Feature': '=== CATEGORY COUNTS ===',
                        'Kano Category': ''
                    });
                    featuresData.push({
                        'Feature': 'Attractive (A)',
                        'Kano Category': csData.counts['Attractive']
                    });
                    featuresData.push({
                        'Feature': 'Performance (O)',
                        'Kano Category': csData.counts['Performance']
                    });
                    featuresData.push({
                        'Feature': 'Must-Be (M)',
                        'Kano Category': csData.counts['Must-Be']
                    });
                    featuresData.push({
                        'Feature': 'Indifferent (I)',
                        'Kano Category': csData.counts['Indifferent']
                    });
                    featuresData.push({
                        'Feature': 'Total Features',
                        'Kano Category': csData.total
                    });

                    // Información del análisis
                    featuresData.push({ 'Feature': '', 'Kano Category': '' });
                    featuresData.push({
                        'Feature': '=== ANALYSIS INFORMATION ===',
                        'Kano Category': ''
                    });
                    featuresData.push({
                        'Feature': 'Analysis Date',
                        'Kano Category': new Date().toLocaleDateString()
                    });
                    featuresData.push({
                        'Feature': 'Analysis Time',
                        'Kano Category': new Date().toLocaleTimeString()
                    });
                    featuresData.push({
                        'Feature': 'Total Features Analyzed',
                        'Kano Category': this.analyzedFeatures.length
                    });

                    const ws = XLSX.utils.json_to_sheet(featuresData);
                    const wb = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(wb, ws, 'Kano Analysis');

                    // Ajustar el ancho de las columnas
                    ws['!cols'] = [
                        { wch: 40 },  // Columna Feature
                        { wch: 25 }   // Columna Kano Category
                    ];

                    XLSX.writeFile(wb, `Kano_Analysis_${new Date().toISOString().slice(0, 10)}.xlsx`);

                    this.showNotification("Full analysis exported successfully!");
                }
            };

            window.kanoApp.init();
        });
    </script>

</body>

</html>