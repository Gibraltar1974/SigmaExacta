<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="canonical" href="https://sigmaexacta.com/balancedcard" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Online Strategic Performance Scorecard Tool | Sigma Exacta</title>
    <meta name="description"
        content="Free Online Tool to create, manage, and monitor your Strategic Performance Scorecard. Define your strategic objectives and KPIs across the financial, customer, internal processes, and learning perspectives.">
    <meta name="keywords"
        content="Open source, Free software, strategy scorecard, balanced scoreboard, scoreboard, strategic management, kpi, performance dashboard, strategic planning, objective tracking, balanced scorecard, SigmaExacta">
    <meta name="author" content="Sigma Exacta">
    <link rel="icon" href="sigma-exacta-icon.jpg" type="image/jpeg">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">

    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f1c40f;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --financial-bg: #16a085;
            --customer-bg: #2980b9;
            --internal-bg: #8e44ad;
            --learning-bg: #d35400;
            font-size: 16px;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Nunito', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            color: #333;
            background-color: #f5f7fa;
            line-height: 1.6;
            width: 100%;
            overflow-x: hidden;
        }

        /* --- MODIFICACIONES PARA ANCHO RESPONSIVE --- */
        .main-content-wrapper {
            margin: 0 auto;
            padding: 1.25rem;
            max-width: 1400px;
            width: 100%;
            box-sizing: border-box;
        }

        .main-header {
            text-align: center;
            padding: 1rem 1.25rem;
            margin-bottom: 0;
            border-bottom: 1px solid #ddd;
            width: 100%;
            box-sizing: border-box;
        }

        .main-header h1 {
            color: #2c3e50;
            font-size: clamp(1.5rem, 4vw, 1.8rem);
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .tool-logo {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 1.8rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            background-color: #0076a8;
        }

        .main-header p {
            color: #7f8c8d;
            font-weight: 400;
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
        }

        /* --- BOTONES PRINCIPALES SOBRE LAS TABS --- */
        .main-action-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1.5rem auto;
            flex-wrap: wrap;
            max-width: 800px;
        }

        .main-action-buttons button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        .main-action-buttons .btn-example {
            background-color: var(--success-color);
            color: white;
        }

        .main-action-buttons .btn-example:hover {
            background-color: #229954;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        .main-action-buttons .btn-reset {
            background-color: var(--danger-color);
            color: white;
        }

        .main-action-buttons .btn-reset:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        /* ===== ESTILOS DEL SISTEMA DE PESTAÑAS (WIZARD) ===== */
        .tabs-nav {
            display: flex;
            background-color: #f1f5f9;
            border-radius: 8px 8px 0 0;
            overflow-x: auto;
            border-bottom: 2px solid #3498db;
            margin-bottom: 0;
            margin-top: 0.5rem;
            scrollbar-width: none;
            -ms-overflow-style: none;
            width: 100%;
        }

        .tabs-nav::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 1rem 1.5rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 700;
            color: #64748b;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            flex: 1;
            justify-content: center;
        }

        .tab-btn:hover {
            background-color: #e2e8f0;
            color: #2c3e50;
        }

        .tab-btn.active {
            background-color: #fff;
            color: #3498db;
            border-bottom-color: #3498db;
            border-radius: 8px 8px 0 0;
            margin-bottom: -2px;
            border-left: 1px solid #e1e5e9;
            border-right: 1px solid #e1e5e9;
            border-top: 1px solid #e1e5e9;
        }

        .tabs-container {
            background: #fff;
            border: 1px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
            position: relative;
            margin-bottom: 2rem;
            box-sizing: border-box;
        }

        .wizard-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        .wizard-tab-content.active {
            display: block;
            width: 100%;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tab-content-wrapper {
            padding: 2rem;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        @media (max-width: 768px) {
            .tab-content-wrapper {
                padding: 1rem;
            }

            .tab-btn {
                padding: 0.75rem 0.5rem;
                font-size: 0.9rem;
            }

            .main-action-buttons {
                gap: 0.75rem;
                margin: 1rem auto;
            }

            .main-action-buttons button {
                padding: 0.7rem 1.2rem;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .tab-content-wrapper {
                padding: 0.75rem;
            }

            .tab-btn {
                padding: 0.6rem 0.3rem;
                font-size: 0.8rem;
            }

            .main-action-buttons {
                flex-direction: column;
                align-items: stretch;
                gap: 0.5rem;
            }

            .main-action-buttons button {
                width: 100%;
                justify-content: center;
            }
        }

        /* ESTILOS DE CONTENIDO */
        .block {
            max-width: 100%;
            margin: 0 auto 1.25rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            width: 100%;
            box-sizing: border-box;
        }

        .block h2 {
            font-size: 1.5em;
            margin-top: 0;
            margin-bottom: 1.25rem;
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.6rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 800;
        }

        .block-title {
            font-weight: 800;
            font-size: 1.2em;
            margin-bottom: 1rem;
            color: var(--primary-color);
            border-bottom: 1px solid #eee;
            padding-bottom: 0.6rem;
        }

        .block ul {
            padding-left: 1.25rem;
        }

        .block ul li {
            margin-bottom: 0.6rem;
            line-height: 1.6;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
            font-weight: 600;
        }

        input,
        textarea,
        select {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            margin-bottom: 1rem;
            box-sizing: border-box;
            transition: border-color 0.3s, box-shadow 0.3s;
            font-family: 'Nunito', sans-serif;
        }

        input:focus,
        textarea:focus,
        select:focus,
        button:focus-visible {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
        }

        button {
            color: white;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px 5px 5px 0;
            font-size: 1rem;
            transition: background-color 0.3s;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
        }

        .btn-primary {
            background-color: var(--secondary-color);
        }

        .btn-primary:hover:not(:disabled) {
            background-color: #2980b9;
        }

        .btn-success {
            background-color: var(--success-color);
        }

        .btn-success:hover {
            background-color: #229954;
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: #333;
        }

        .btn-warning:hover {
            background-color: #d4ac0d;
        }

        .btn-delete {
            background-color: var(--danger-color);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: auto;
        }

        .btn-delete:hover {
            background-color: #c0392b;
        }

        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 0 1.25rem;
        }

        .custom-input-container {
            display: none;
            margin-top: -0.6rem;
        }

        .scorecard-grid {
            max-width: 100%;
            margin: 0 auto;
            display: flex;
            flex-wrap: wrap;
            gap: 1.25rem;
        }

        .scorecard-grid>.block {
            flex: 1 1 450px;
            min-width: 320px;
            max-width: none;
            margin: 0;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 1rem;
            font-size: 1rem;
            display: block;
            overflow-x: auto;
            white-space: nowrap;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 0.75rem;
            text-align: left;
            word-wrap: break-word;
            white-space: normal;
        }

        th {
            color: white;
            font-weight: 600;
        }

        th.actions-col {
            width: 70px;
            text-align: center;
        }

        td.actions-col {
            text-align: center;
        }

        .th-financial {
            background-color: var(--financial-bg);
        }

        .th-customer {
            background-color: var(--customer-bg);
        }

        .th-internal {
            background-color: var(--internal-bg);
        }

        .th-learning {
            background-color: var(--learning-bg);
        }

        .badge {
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
            text-align: center;
        }

        .badge-good {
            background-color: var(--success-color);
        }

        .badge-average {
            background-color: var(--warning-color);
            color: #333;
        }

        .badge-poor {
            background-color: var(--danger-color);
        }

        .progress-container {
            width: 100%;
            background-color: #ecf0f1;
            border-radius: 5px;
        }

        .progress-bar {
            height: 22px;
            border-radius: 5px;
            text-align: center;
            line-height: 22px;
            color: white;
            font-weight: bold;
            font-size: 0.8rem;
            transition: width 0.5s ease-in-out;
            background-color: var(--primary-color);
        }

        .progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        #toast-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
            transform: translateY(-20px);
        }

        #toast-notification.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        #toast-notification.success {
            background-color: var(--success-color);
        }

        #toast-notification.info {
            background-color: var(--secondary-color);
        }

        .tab-nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
            width: 100%;
            box-sizing: border-box;
        }

        .btn-next-tab {
            background-color: #3498db;
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn-next-tab:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        .btn-next-tab.btn-prev {
            background-color: #95a5a6;
        }

        .btn-next-tab.btn-prev:hover {
            background-color: #7f8c8d;
        }

        /* --- NUEVOS ESTILOS PARA TABLA DE RESULTADOS (READ-ONLY) --- */
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .results-table th,
        .results-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
            vertical-align: top;
        }

        .results-table th {
            background-color: #f8f9fa;
            color: var(--primary-color);
            font-weight: 800;
        }

        .results-table .category-cell {
            width: 30%;
            font-weight: 600;
        }

        .results-table .features-cell p {
            margin: 0 0 8px 0;
            padding: 5px 8px;
            background-color: var(--light-color);
            border-radius: 4px;
            display: block;
        }

        .no-data-message {
            color: #7f8c8d;
            font-style: italic;
            text-align: center;
            padding: 2rem;
        }

        .export-section {
            text-align: center;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px dashed #ddd;
        }

        .btn-export {
            background-color: #3498db;
            margin-top: 1.5rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.1rem;
            padding: 0.8rem 1.5rem;
        }

        .btn-export:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .results-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1.5rem;
            justify-content: center;
        }

        .results-actions button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
            padding: 0.8rem 1.5rem;
            min-height: 46px;
            justify-content: center;
        }

        #listResultsBtn {
            background-color: var(--secondary-color);
        }

        #listResultsBtn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .results-display-container {
            margin-top: 2rem;
            display: none;
        }

        .results-display-container.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        footer {
            padding: 2rem 1.25rem;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .disclaimer-note {
            margin-top: 2rem;
            padding: 0 1rem;
            font-size: 0.8rem;
            color: #777;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
            text-align: left;
            line-height: 1.6;
        }
    </style>
</head>

<body>
    <!-- Contenedor para el header cargado dinámicamente -->
    <div id="header-container"></div>

    <noscript>
        <nav>
            <a href="/">Home</a> |
            <a href="/8d">8D Tool</a> |
            <a href="/taguchi_doe">Taguchi DOE</a> |
            <a href="/swot">SWOT Analysis</a> |
            <a href="/balancedcard">Balanced Scorecard</a> |
            <a href="/qfd">QFD</a> |
            <a href="/apqp-ppap">APQP/PPAP</a> |
            <a href="/ishikawa">Ishikawa</a> |
            <a href="/fmea">FMEA</a> |
            <a href="/vave">VAVE</a> |
            <a href="/eisenhower">Eisenhower Matrix</a> |
            <a href="/triz">TRIZ</a> |
            <a href="/weibull">Weibull</a> |
            <a href="/stack_up_analysis">Tolerance Stack-Up</a> |
            <a href="/pdca">PDCA</a> |
            <a href="/design_thinking">Design Thinking</a> |
            <a href="/pugh">Pugh Matrix</a> |
            <a href="/cpk_calculator">CpK Calculator</a> |
            <a href="/control-plan">Control Plan</a>
        </nav>
    </noscript>

    <main class="main-content-wrapper">
        <header class="main-header">
            <h1>
                <div class="tool-logo" title="Strategic Scorecard">
                    <i class="fas fa-balance-scale"></i>
                </div>
                Free Online Strategic Performance Scorecard Tool
            </h1>
            <p>A simple and effective tool to create, track, and manage your strategic objectives.</p>

            <!-- BOTONES PRINCIPALES -->
            <div class="main-action-buttons">
                <button id="globalLoadExampleBtn" class="btn-example">
                    <i class="fas fa-magic"></i> Load Example
                </button>
                <button id="globalResetBtn" class="btn-reset">
                    <i class="fas fa-sync-alt"></i> Reset All
                </button>
            </div>
        </header>

        <!-- CONTENEDOR DE TABS -->
        <div class="tabs-container">
            <!-- NAVEGACIÓN DE PESTAÑAS (WIZARD) -->
            <nav class="tabs-nav">
                <button class="tab-btn active" onclick="switchWizardTab('tab-theory')">
                    <i class="fas fa-book"></i> Theory & Info
                </button>
                <button class="tab-btn" onclick="switchWizardTab('tab-builder')">
                    <i class="fas fa-edit"></i> Scorecard Builder
                </button>
                <button class="tab-btn" onclick="switchWizardTab('tab-results')">
                    <i class="fas fa-chart-line"></i> Results
                </button>
            </nav>

            <!-- PESTAÑA 1: TEORÍA -->
            <div id="tab-theory" class="wizard-tab-content active">
                <div class="tab-content-wrapper">
                    <div class="block">
                        <h2><i class="fas fa-question-circle"></i> What is a Strategic Performance Scorecard?</h2>
                        <p>This tool is a <strong>Strategic Performance Scorecard</strong>, a management system that
                            helps
                            organizations track the performance of their strategic goals. Its design is inspired by
                            performance
                            management concepts that aim to go beyond purely financial metrics.</p>
                        <p>The goal is to provide a holistic view of the business. To achieve this, the tool organizes
                            indicators
                            into four key, interrelated areas or perspectives:</p>
                        <ul>
                            <li><i class="fas fa-dollar-sign fa-fw" style="color: var(--financial-bg);"></i>
                                <strong>Financial:</strong> Measures the financial health and performance of the
                                organization.
                            </li>
                            <li><i class="fas fa-users fa-fw" style="color: var(--customer-bg);"></i>
                                <strong>Customer:</strong>
                                Evaluates customer satisfaction and perception of our products or services.
                            </li>
                            <li><i class="fas fa-cogs fa-fw" style="color: var(--internal-bg);"></i> <strong>Internal
                                    Processes:</strong> Analyzes the efficiency and quality of key business processes.
                            </li>
                            <li><i class="fas fa-brain fa-fw" style="color: var(--learning-bg);"></i> <strong>Learning &
                                    Growth:</strong> Focuses on the human capital, technology, and organizational
                                culture needed for
                                improvement.</li>
                        </ul>
                    </div>

                    <div class="block">
                        <h2><i class="fas fa-history"></i> Brief History & Purpose</h2>
                        <p>This concept, popularized as the <strong>Balanced Scorecard</strong>, was developed in the
                            early 1990s by
                            Robert S. Kaplan and David P. Norton. It arose from the idea that purely financial metrics
                            were
                            insufficient for managing a company in the information age.</p>
                        <p>By providing a "balanced" view across the four perspectives, the framework helps
                            organizations clarify
                            their strategy and translate it into actionable objectives and measures, ensuring that
                            day-to-day
                            operations are aligned with long-term goals.</p>
                    </div>

                    <div class="block">
                        <h2><i class="fas fa-tools"></i> How to Use This Tool</h2>
                        <ul style="list-style-type: decimal;">
                            <li><strong>Load an Example:</strong> If it's your first time, click the <i
                                    class="fas fa-magic"></i>
                                <strong>Load Example</strong> button to populate the form with sample data and see how
                                it works.
                            </li>
                            <li><strong>Add a Metric:</strong>
                                <ul>
                                    <li>Use the dropdown menus to select a <i>Perspective</i>, <i>Objective</i>, and
                                        <i>Measure
                                            (KPI)</i>. If you can't find what you need, select "Other..." to type your
                                        own.
                                    </li>
                                    <li>Enter the numeric values for the <i>Target</i> and <i>Actual Value</i>.</li>
                                    <li>Describe the associated <i>Strategic Initiative</i>, which is the action being
                                        taken to
                                        achieve the objective.</li>
                                    <li>Click <i class="fas fa-plus-circle"></i> <strong>Add to Scorecard</strong>.</li>
                                </ul>
                            </li>
                            <li><strong>Monitor Progress:</strong> Watch as the tables populate with your data.
                                Performance is
                                calculated automatically and displayed with a percentage and a status badge (Good,
                                Average, Poor).
                            </li>
                            <li><strong>View Results:</strong> Go to the <strong>Results</strong> tab to see a
                                consolidated view of all your metrics and export them to Excel.</li>
                        </ul>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-builder')">Go to Scorecard Builder <i
                                class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA 2: SCORECARD BUILDER -->
            <div id="tab-builder" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <div id="toast-notification"></div>

                    <div class="block">
                        <div class="block-title">Add New Metric</div>
                        <form id="bscForm">
                            <div class="form-grid">
                                <div>
                                    <label for="perspective"><i class="fas fa-sitemap"></i> Perspective</label>
                                    <select id="perspective" required>
                                        <option value="" disabled selected>-- Select a Perspective --</option>
                                        <option value="financial">Financial</option>
                                        <option value="customer">Customer</option>
                                        <option value="internal">Internal Processes</option>
                                        <option value="learning">Learning & Growth</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="objective"><i class="fas fa-bullseye"></i> Objective</label>
                                    <select id="objective" required></select>
                                    <div id="customObjectiveContainer" class="custom-input-container"><input type="text"
                                            id="customObjective" placeholder="Enter custom objective"></div>
                                </div>
                                <div>
                                    <label for="measure"><i class="fas fa-ruler-combined"></i> Measure (KPI)</label>
                                    <select id="measure" required></select>
                                    <div id="customMeasureContainer" class="custom-input-container"><input type="text"
                                            id="customMeasure" placeholder="Enter custom measure"></div>
                                </div>
                                <div>
                                    <label for="target"><i class="fas fa-flag-checkered"></i> Numeric Target</label>
                                    <input type="number" id="target" step="any" placeholder="E.g., 15.5" required>
                                </div>
                                <div>
                                    <label for="actual"><i class="fas fa-chart-line"></i> Actual Value</label>
                                    <input type="number" id="actual" step="any" placeholder="E.g., 12.5" required>
                                </div>
                            </div>
                            <label for="initiative"><i class="fas fa-lightbulb"></i> Strategic Initiative</label>
                            <textarea id="initiative" rows="2"
                                placeholder="E.g., Optimize production costs and renegotiate with suppliers."
                                required></textarea>
                            <button type="submit" id="addBtn" class="btn-primary" disabled><i
                                    class="fas fa-plus-circle"></i> Add to
                                Scorecard</button>
                        </form>
                    </div>

                    <div class="block">
                        <div class="block-title">Performance Summary</div>
                        <div class="progress-grid">
                            <div><strong><i class="fas fa-dollar-sign"></i> Financial</strong>
                                <div class="progress-container">
                                    <div id="summary-financial" class="progress-bar" style="width: 0%;">0%</div>
                                </div>
                            </div>
                            <div><strong><i class="fas fa-users"></i> Customer</strong>
                                <div class="progress-container">
                                    <div id="summary-customer" class="progress-bar" style="width: 0%;">0%</div>
                                </div>
                            </div>
                            <div><strong><i class="fas fa-cogs"></i> Internal Processes</strong>
                                <div class="progress-container">
                                    <div id="summary-internal" class="progress-bar" style="width: 0%;">0%</div>
                                </div>
                            </div>
                            <div><strong><i class="fas fa-brain"></i> Learning & Growth</strong>
                                <div class="progress-container">
                                    <div id="summary-learning" class="progress-bar" style="width: 0%;">0%</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="scorecard-grid">
                        <div class="block">
                            <div class="block-title"><i class="fas fa-dollar-sign"></i> Financial Perspective</div>
                            <table>
                                <thead>
                                    <tr>
                                        <th class="th-financial">Objective</th>
                                        <th class="th-financial">KPI</th>
                                        <th class="th-financial">Target</th>
                                        <th class="th-financial">Actual</th>
                                        <th class="th-financial">%</th>
                                        <th class="th-financial">Status</th>
                                        <th class="th-financial actions-col">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="financialTableBody"></tbody>
                            </table>
                        </div>
                        <div class="block">
                            <div class="block-title"><i class="fas fa-users"></i> Customer Perspective</div>
                            <table>
                                <thead>
                                    <tr>
                                        <th class="th-customer">Objective</th>
                                        <th class="th-customer">KPI</th>
                                        <th class="th-customer">Target</th>
                                        <th class="th-customer">Actual</th>
                                        <th class="th-customer">%</th>
                                        <th class="th-customer">Status</th>
                                        <th class="th-customer actions-col">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="customerTableBody"></tbody>
                            </table>
                        </div>
                        <div class="block">
                            <div class="block-title"><i class="fas fa-cogs"></i> Internal Processes Perspective</div>
                            <table>
                                <thead>
                                    <tr>
                                        <th class="th-internal">Objective</th>
                                        <th class="th-internal">KPI</th>
                                        <th class="th-internal">Target</th>
                                        <th class="th-internal">Actual</th>
                                        <th class="th-internal">%</th>
                                        <th class="th-internal">Status</th>
                                        <th class="th-internal actions-col">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="internalTableBody"></tbody>
                            </table>
                        </div>
                        <div class="block">
                            <div class="block-title"><i class="fas fa-brain"></i> Learning & Growth Perspective</div>
                            <table>
                                <thead>
                                    <tr>
                                        <th class="th-learning">Objective</th>
                                        <th class="th-learning">KPI</th>
                                        <th class="th-learning">Target</th>
                                        <th class="th-learning">Actual</th>
                                        <th class="th-learning">%</th>
                                        <th class="th-learning">Status</th>
                                        <th class="th-learning actions-col">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="learningTableBody"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab btn-prev" onclick="switchWizardTab('tab-theory')"><i
                                class="fas fa-arrow-left"></i> Back to Theory</button>
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-results')">View Results <i
                                class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA 3: RESULTS -->
            <div id="tab-results" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <!-- BOTONES DE ACCIÓN -->
                    <div class="block">
                        <h2><i class="fas fa-chart-line"></i> Scorecard Results</h2>
                        <p>Click the button below to generate a read-only report of all your metrics. You can also
                            export the full scorecard to Excel.</p>
                        <div class="results-actions">
                            <button id="listResultsBtn" class="btn-primary">
                                <i class="fas fa-list"></i> List Results
                            </button>
                            <button id="exportBtn" class="btn-success">
                                <i class="fas fa-file-excel"></i> Export to Excel
                            </button>
                        </div>
                    </div>

                    <!-- CONTENEDOR DE RESULTADOS (inicialmente oculto) -->
                    <div id="resultsDisplayContainer" class="results-display-container">
                        <!-- Aquí se cargarán los resultados dinámicamente -->
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab btn-prev" onclick="switchWizardTab('tab-builder')"><i
                                class="fas fa-arrow-left"></i> Back to Builder</button>
                        <button class="btn-next-tab" onclick="switchWizardTab('tab-theory')">Back to Theory <i
                                class="fas fa-book"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <footer>
        <div class="disclaimer-note">
            <p><strong>Disclaimer:</strong> The "Balanced Scorecard" concept was originally developed by Robert S.
                Kaplan and David P. Norton. This tool is an independent implementation inspired by its principles and is
                not affiliated with, sponsored by, or endorsed by Kaplan, Norton, or their organizations. The tools and
                information provided on Sigma Exacta are for informational and educational purposes only. While we
                strive for accuracy, we make no warranty or guarantee regarding the results. All decisions based on the
                output of these tools are the sole responsibility of the user.</p>
        </div>
    </footer>

    <script>
        // ============================================
        // FUNCIONES GLOBALES
        // ============================================

        // Función para cambiar entre tabs
        function switchWizardTab(tabId) {
            // Quitar clase active de todos los botones y contenidos de wizard
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.wizard-tab-content').forEach(content => content.classList.remove('active'));

            // Activar el contenido seleccionado
            document.getElementById(tabId).classList.add('active');

            // Activar botón correspondiente
            const activeBtn = document.querySelector(`button[onclick="switchWizardTab('${tabId}')"]`);
            if (activeBtn) activeBtn.classList.add('active');

            // Si estamos en la pestaña de Results, ocultamos los resultados
            if (tabId === 'tab-results') {
                document.getElementById('resultsDisplayContainer').classList.remove('show');
            }

            // Scroll al top suavemente
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Función para actualizar la vista de resultados
        function updateResultsView() {
            const resultsContainer = document.getElementById('resultsDisplayContainer');
            const perspectives = ['financial', 'customer', 'internal', 'learning'];
            let hasData = false;
            let html = '';

            perspectives.forEach(perspective => {
                const tableBody = document.getElementById(`${perspective}TableBody`);
                const rows = tableBody.querySelectorAll('tr');

                if (rows.length > 0) {
                    hasData = true;
                    const perspectiveName = getPerspectiveName(perspective);
                    const color = getPerspectiveColor(perspective);

                    html += `
                        <div class="block" style="margin-bottom: 2rem;">
                            <div class="block-title" style="color: ${color};">
                                <i class="fas fa-${getPerspectiveIcon(perspective)}"></i> ${perspectiveName} Perspective
                                <span style="font-size: 0.9rem; color: #777; margin-left: 8px;">(${rows.length} metrics)</span>
                            </div>
                            <table class="results-table">
                                <thead>
                                    <tr>
                                        <th style="background-color: ${color}; color: white;">Objective</th>
                                        <th style="background-color: ${color}; color: white;">KPI</th>
                                        <th style="background-color: ${color}; color: white;">Target</th>
                                        <th style="background-color: ${color}; color: white;">Actual</th>
                                        <th style="background-color: ${color}; color: white;">%</th>
                                        <th style="background-color: ${color}; color: white;">Status</th>
                                        <th style="background-color: ${color}; color: white;">Initiative</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;

                    rows.forEach(row => {
                        const cells = row.querySelectorAll('td');
                        html += `
                            <tr>
                                <td>${cells[0].textContent}</td>
                                <td>${cells[1].textContent}</td>
                                <td>${cells[2].textContent}</td>
                                <td>${cells[3].textContent}</td>
                                <td>${cells[4].textContent}</td>
                                <td>${cells[5].innerHTML}</td>
                                <td>${row.dataset.initiative || ''}</td>
                            </tr>
                        `;
                    });

                    html += `
                                </tbody>
                            </table>
                        </div>
                    `;
                }
            });

            if (!hasData) {
                html = '<div class="no-data-message">No metrics added yet. Go to the Scorecard Builder tab to add metrics.</div>';
            }

            resultsContainer.innerHTML = html;
        }

        // Función para listar los resultados (se llama al hacer clic en el botón "List Results")
        function listResults() {
            updateResultsView();
            document.getElementById('resultsDisplayContainer').classList.add('show');
            showToast('Results generated successfully!', 'success');
        }

        // Funciones auxiliares
        function getPerspectiveName(perspective) {
            const names = {
                'financial': 'Financial',
                'customer': 'Customer',
                'internal': 'Internal Processes',
                'learning': 'Learning & Growth'
            };
            return names[perspective] || perspective;
        }

        function getPerspectiveColor(perspective) {
            const colors = {
                'financial': '#16a085',
                'customer': '#2980b9',
                'internal': '#8e44ad',
                'learning': '#d35400'
            };
            return colors[perspective] || '#2c3e50';
        }

        function getPerspectiveIcon(perspective) {
            const icons = {
                'financial': 'dollar-sign',
                'customer': 'users',
                'internal': 'cogs',
                'learning': 'brain'
            };
            return icons[perspective] || 'chart-line';
        }

        // Cargar el header dinámicamente
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-container').innerHTML = data;
                // Inicializar el menú después de cargar el header
                initializeMenu();
            })
            .catch(error => console.error('Error loading header:', error));

        // Función para inicializar el menú
        function initializeMenu() {
            const navToggle = document.getElementById('nav-toggle');
            const navMenu = document.getElementById('nav-menu');
            const toolsDropdownToggle = document.getElementById('tools-dropdown-toggle');
            const toolsDropdownMenu = document.getElementById('tools-dropdown-menu');
            const toolsDropdownContainer = document.getElementById('tools-dropdown-container');

            if (navToggle && navMenu) {
                navToggle.addEventListener('click', () => {
                    navMenu.classList.toggle('show-menu');
                    const icon = navToggle.querySelector('i');
                    icon.classList.toggle('fa-bars');
                    icon.classList.toggle('fa-times');
                    if (!navMenu.classList.contains('show-menu')) {
                        toolsDropdownMenu.classList.remove('show-submenu');
                        toolsDropdownContainer.classList.remove('active');
                    }
                });
            }

            if (toolsDropdownToggle && toolsDropdownMenu) {
                toolsDropdownToggle.addEventListener('click', (event) => {
                    if (window.innerWidth <= 992) {
                        event.preventDefault();
                        toolsDropdownMenu.classList.toggle('show-submenu');
                        toolsDropdownContainer.classList.toggle('active');
                    }
                });
            }
        }

        // ============================================
        // CÓDIGO DE LA APLICACIÓN
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            const bscForm = document.getElementById('bscForm');
            const addBtn = document.getElementById('addBtn');
            const globalLoadExampleBtn = document.getElementById('globalLoadExampleBtn');
            const globalResetBtn = document.getElementById('globalResetBtn');
            const perspectiveSelect = document.getElementById('perspective');
            const objectiveSelect = document.getElementById('objective');
            const measureSelect = document.getElementById('measure');
            const customObjectiveContainer = document.getElementById('customObjectiveContainer');
            const customMeasureContainer = document.getElementById('customMeasureContainer');
            const customObjectiveInput = document.getElementById('customObjective');
            const customMeasureInput = document.getElementById('customMeasure');
            const exportBtn = document.getElementById('exportBtn');
            const listResultsBtn = document.getElementById('listResultsBtn');
            const allInputs = Array.from(bscForm.querySelectorAll('input, select, textarea'));

            const kpiData = {
                financial: {
                    'Increase Revenue': ['Total Sales Revenue', 'Revenue Growth Rate (%)', 'Revenue per Customer'],
                    'Improve Profitability': ['Net Profit Margin (%)', 'Gross Profit Margin (%)', 'Return on Investment (ROI)'],
                    'Optimize Costs': ['Operating Cost Ratio', 'Cost of Goods Sold (COGS)', 'Budget Variance'],
                },
                customer: {
                    'Enhance Customer Satisfaction': ['Net Promoter Score (NPS)', 'Customer Satisfaction Score (CSAT)', 'Number of Complaints'],
                    'Increase Market Share': ['Market Share Percentage', 'New Customer Acquisition Rate', 'Brand Recognition'],
                    'Improve Customer Loyalty': ['Customer Retention Rate', 'Customer Lifetime Value (CLV)', 'Repeat Purchase Rate'],
                },
                internal: {
                    'Optimize Operational Processes': ['Process Cycle Time', 'Production Defect Rate', 'On-time Delivery Rate'],
                    'Foster Innovation': ['Number of New Products Launched', 'R&D Investment as % of Sales', 'Time to Market for New Products'],
                    'Improve Supply Chain': ['Inventory Turnover Rate', 'Supplier Lead Time', 'Order Fulfillment Accuracy'],
                },
                learning: {
                    'Develop Employee Skills': ['Employee Training Hours', 'Skill Competency Rate', 'Internal Promotion Rate'],
                    'Improve Information Systems': ['System Downtime Percentage', 'Data Accessibility Score', 'IT Project Completion Rate'],
                    'Enhance Corporate Culture': ['Employee Engagement Score', 'Staff Turnover Rate', 'Number of Employee Suggestions'],
                }
            };

            // Datos de ejemplo completos para todas las perspectivas
            const exampleData = [
                { perspective: 'financial', objective: 'Improve Profitability', measure: 'Net Profit Margin (%)', target: '15', actual: '16.5', initiative: 'Implement cost-saving measures across all departments.' },
                { perspective: 'financial', objective: 'Increase Revenue', measure: 'Revenue Growth Rate (%)', target: '10', actual: '12.3', initiative: 'Launch new marketing campaign and expand to new markets.' },
                { perspective: 'customer', objective: 'Enhance Customer Satisfaction', measure: 'Net Promoter Score (NPS)', target: '50', actual: '45', initiative: 'Launch a new customer feedback program and act on insights.' },
                { perspective: 'customer', objective: 'Improve Customer Loyalty', measure: 'Customer Retention Rate', target: '85', actual: '88', initiative: 'Implement loyalty program and improve after-sales service.' },
                { perspective: 'internal', objective: 'Optimize Operational Processes', measure: 'On-time Delivery Rate', target: '95', actual: '97', initiative: 'Automate the logistics and dispatch system.' },
                { perspective: 'internal', objective: 'Improve Supply Chain', measure: 'Inventory Turnover Rate', target: '8', actual: '7.5', initiative: 'Implement just-in-time inventory management.' },
                { perspective: 'learning', objective: 'Develop Employee Skills', measure: 'Employee Training Hours', target: '40', actual: '42', initiative: 'Subscribe to an online learning platform for all staff.' },
                { perspective: 'learning', objective: 'Enhance Corporate Culture', measure: 'Employee Engagement Score', target: '75', actual: '72', initiative: 'Conduct quarterly employee surveys and implement feedback.' }
            ];

            const updateObjectiveDropdown = () => {
                const perspective = perspectiveSelect.value;
                objectiveSelect.innerHTML = '<option value="" disabled selected>-- Select an Objective --</option>';
                if (perspective && kpiData[perspective]) {
                    Object.keys(kpiData[perspective]).forEach(obj => objectiveSelect.add(new Option(obj, obj)));
                }
                objectiveSelect.add(new Option('Other...', 'other'));
                updateMeasureDropdown();
                toggleCustomInput(objectiveSelect, customObjectiveContainer, customObjectiveInput);
            };

            const updateMeasureDropdown = () => {
                const perspective = perspectiveSelect.value;
                const objective = objectiveSelect.value;
                measureSelect.innerHTML = '<option value="" disabled selected>-- Select a Measure --</option>';
                if (perspective && objective && kpiData[perspective]?.[objective]) {
                    kpiData[perspective][objective].forEach(m => measureSelect.add(new Option(m, m)));
                }
                measureSelect.add(new Option('Other...', 'other'));
                toggleCustomInput(measureSelect, customMeasureContainer, customMeasureInput);
            };

            const toggleCustomInput = (selectEl, containerEl, inputEl) => {
                const isOther = selectEl.value === 'other';
                containerEl.style.display = isOther ? 'block' : 'none';
                inputEl.required = isOther;
                if (!isOther) inputEl.value = '';
                validateForm();
            };

            const validateForm = () => {
                addBtn.disabled = !allInputs.every(input => !input.required || (input.value?.trim() !== ''));
            };

            const addEntryToTable = () => {
                const perspective = perspectiveSelect.value;
                const objective = objectiveSelect.value === 'other' ? customObjectiveInput.value.trim() : objectiveSelect.value;
                const measure = measureSelect.value === 'other' ? customMeasureInput.value.trim() : measureSelect.value;
                const targetNum = parseFloat(document.getElementById('target').value);
                const actualNum = parseFloat(document.getElementById('actual').value);
                const achievement = (targetNum === 0 && actualNum > 0) ? 100 : (targetNum !== 0 ? (actualNum / targetNum) * 100 : 0);
                let statusClass = 'badge-poor', statusText = 'Poor';
                if (achievement >= 100) {
                    statusClass = 'badge-good';
                    statusText = 'Good';
                }
                else if (achievement >= 80) {
                    statusClass = 'badge-average';
                    statusText = 'Average';
                }
                const tableBody = document.getElementById(`${perspective}TableBody`);
                const newRow = tableBody.insertRow();
                newRow.dataset.initiative = document.getElementById('initiative').value;
                newRow.innerHTML = `
                    <td>${objective}</td>
                    <td>${measure}</td>
                    <td>${targetNum}</td>
                    <td>${actualNum}</td>
                    <td data-achievement="${achievement.toFixed(2)}">${achievement.toFixed(0)}%</td>
                    <td><span class="badge ${statusClass}">${statusText}</span></td>
                    <td class="actions-col"><button class="btn-delete" title="Delete Metric"><i class="fas fa-trash-alt"></i></button></td>
                `;
                updateSummaries();
                showToast('Metric added successfully!', 'success');
            };

            const updateSummaries = () => {
                ['financial', 'customer', 'internal', 'learning'].forEach(p => {
                    const cells = document.querySelectorAll(`#${p}TableBody td[data-achievement]`);
                    const progressBar = document.getElementById(`summary-${p}`);
                    if (cells.length > 0) {
                        const total = Array.from(cells).reduce((sum, cell) => sum + parseFloat(cell.dataset.achievement), 0);
                        const avg = total / cells.length;
                        progressBar.style.width = `${Math.min(avg, 100)}%`;
                        progressBar.textContent = `${avg.toFixed(1)}%`;
                    } else {
                        progressBar.style.width = '0%';
                        progressBar.textContent = '0%';
                    }
                });
            };

            // Función mejorada y optimizada para cargar un ejemplo completo
            const loadExample = () => {
                // Primero resetear todo
                resetAll(true);

                // Cambiar a la pestaña Scorecard Builder inmediatamente
                switchWizardTab('tab-builder');

                // Agregar todos los ejemplos de forma más eficiente
                let delay = 0;

                exampleData.forEach((ex, index) => {
                    // Usar setTimeout para evitar bloqueo del UI, pero con intervalos más cortos
                    setTimeout(() => {
                        // Configurar el formulario con cada ejemplo
                        perspectiveSelect.value = ex.perspective;
                        updateObjectiveDropdown();

                        // Pequeña pausa para asegurar que los dropdowns se actualicen
                        setTimeout(() => {
                            objectiveSelect.value = ex.objective;
                            updateMeasureDropdown();

                            setTimeout(() => {
                                measureSelect.value = ex.measure;
                                document.getElementById('target').value = ex.target;
                                document.getElementById('actual').value = ex.actual;
                                document.getElementById('initiative').value = ex.initiative;

                                // Validar y agregar
                                validateForm();
                                if (!addBtn.disabled) {
                                    addEntryToTable();
                                }

                                // Resetear el formulario para el siguiente (excepto el último)
                                if (index < exampleData.length - 1) {
                                    bscForm.reset();
                                    updateObjectiveDropdown();
                                    validateForm();
                                }
                            }, 10); // Reducido de 100ms a 10ms
                        }, 10); // Reducido de 100ms a 10ms
                    }, delay);

                    // Incrementar el delay solo ligeramente para cada ejemplo
                    delay += 80; // Reducido de 300ms a 80ms
                });

                // Mostrar mensaje después de un tiempo razonable
                setTimeout(() => {
                    showToast('Complete example loaded with metrics across all perspectives!', 'success');
                }, delay + 100); // Reducido de +500ms a +100ms
            };

            const resetAll = (silent = false) => {
                ['financial', 'customer', 'internal', 'learning'].forEach(p => {
                    document.getElementById(`${p}TableBody`).innerHTML = '';
                });
                bscForm.reset();
                updateObjectiveDropdown();
                validateForm();
                updateSummaries();
                // Ocultar los resultados
                document.getElementById('resultsDisplayContainer').classList.remove('show');
                if (!silent) {
                    showToast('Scorecard has been reset.', 'info');
                }
            };

            const showToast = (message, type = 'success') => {
                const toast = document.getElementById('toast-notification');
                toast.textContent = message;
                toast.className = 'show';
                toast.classList.add(type);
                setTimeout(() => toast.classList.remove('show'), 3000);
            };

            const handleActionClick = (event) => {
                const deleteBtn = event.target.closest('.btn-delete');
                if (deleteBtn) {
                    if (confirm('Are you sure you want to delete this metric?')) {
                        deleteBtn.closest('tr').remove();
                        updateSummaries();
                        // Ocultar resultados si están mostrándose
                        document.getElementById('resultsDisplayContainer').classList.remove('show');
                        showToast('Metric deleted.', 'info');
                    }
                }
            };

            const exportToExcel = () => {
                const wb = XLSX.utils.book_new();
                ['financial', 'customer', 'internal', 'learning'].forEach(p => {
                    const table = document.getElementById(`${p}TableBody`).parentNode;
                    const perspectiveName = getPerspectiveName(p);
                    const rows = table.querySelectorAll('tbody tr');
                    if (rows.length === 0) return;
                    const headers = ['Objective', 'KPI', 'Target', 'Actual', '%', 'Status', 'Initiative'];
                    const data = Array.from(rows).map(row => {
                        const rowData = Array.from(row.querySelectorAll('td')).map(td => td.innerText).slice(0, -1);
                        rowData.push(row.dataset.initiative || '');
                        return rowData;
                    });
                    const ws = XLSX.utils.aoa_to_sheet([headers, ...data]);
                    XLSX.utils.book_append_sheet(wb, ws, perspectiveName.substring(0, 30));
                });
                if (wb.SheetNames.length > 0) {
                    XLSX.writeFile(wb, `Strategic_Scorecard_${new Date().toISOString().slice(0, 10)}.xlsx`);
                    showToast('Scorecard exported successfully!', 'success');
                }
                else {
                    alert("There is no data to export.");
                }
            };

            // Event listeners
            bscForm.addEventListener('submit', (e) => {
                e.preventDefault();
                addEntryToTable();
                bscForm.reset();
                updateObjectiveDropdown();
                validateForm();
            });

            allInputs.forEach(input => input.addEventListener('input', validateForm));
            perspectiveSelect.addEventListener('change', updateObjectiveDropdown);
            objectiveSelect.addEventListener('change', updateMeasureDropdown);
            measureSelect.addEventListener('change', () => toggleCustomInput(measureSelect, customMeasureContainer, customMeasureInput));

            // Botones globales
            globalLoadExampleBtn.addEventListener('click', loadExample);
            globalResetBtn.addEventListener('click', () => resetAll(false));

            // Botón de exportación
            exportBtn.addEventListener('click', exportToExcel);

            // Botón para listar resultados
            listResultsBtn.addEventListener('click', listResults);

            // Manejo de eliminación de métricas
            document.addEventListener('click', handleActionClick);

            // Inicializar
            updateObjectiveDropdown();
            validateForm();
        });
    </script>
</body>

</html>