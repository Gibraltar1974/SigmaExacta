<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="canonical" href="https://sigmaexacta.com/qfd" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive QFD Tool - House of Quality | Sigma Exacta</title>
    <meta name="description"
        content="Free Quality Function Deployment (QFD) matrix / House of Quality tool. Translate customer needs into technical specifications and prioritize engineering efforts. Export to Excel.">
    <meta name="keywords"
        content="Open source, Free Software, SigmaExacta, QFD, Quality Function Deployment, House of Quality, HOQ, customer needs, voice of the customer, technical requirements, product design, engineering, quality tool, free tool">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="sigma-exacta-icon.jpg" type="image/jpeg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">

    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --warning-color: #f39c12;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #27ae60;
            font-size: 16px;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Nunito', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            color: #333;
            background-color: #f5f7fa;
            line-height: 1.6;
        }

        /* --- SISTEMA DE TABS PRINCIPALES (COMO CPK_CALCULATOR) --- */
        .tabs-container {
            background: #fff;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin: 1.5rem auto;
            max-width: 1400px;
            width: 100%;
            overflow: hidden;
        }

        /* NAVEGACIÓN DE TABS PRINCIPALES - EXACTAMENTE COMO CPK_CALCULATOR */
        .tabs-nav {
            display: flex;
            background-color: #f1f5f9;
            border-radius: 8px 8px 0 0;
            overflow-x: auto;
            border-bottom: 2px solid var(--secondary-color);
            margin-bottom: 0;
            margin-top: 0;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .tabs-nav::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 1rem 1.5rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 700;
            color: #64748b;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
        }

        @media (min-width: 992px) {
            .tabs-nav {
                overflow-x: hidden;
            }

            .tab-btn {
                flex: 1;
                justify-content: center;
                padding: 1rem 0.5rem;
            }
        }

        .tab-btn:hover {
            background-color: #e2e8f0;
            color: var(--primary-color);
        }

        .tab-btn.active {
            background-color: #fff;
            color: var(--secondary-color);
            border-bottom-color: var(--secondary-color);
            border-radius: 8px 8px 0 0;
            margin-bottom: -2px;
            border-left: 1px solid #e1e5e9;
            border-right: 1px solid #e1e5e9;
            border-top: 1px solid #e1e5e9;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
            width: 100%;
            box-sizing: border-box;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tab-content-wrapper {
            padding: 2rem;
            width: 100%;
            box-sizing: border-box;
        }

        @media (max-width: 768px) {
            .tab-content-wrapper {
                padding: 1rem;
            }
        }

        @media (max-width: 480px) {
            .tab-content-wrapper {
                padding: 0.75rem;
            }
        }

        /* --- TABS INTERNAS (INPUT TABS) CON LOS MISMOS COLORES --- */
        .input-tabs-nav {
            display: flex;
            background-color: #f1f5f9;
            border-radius: 8px 8px 0 0;
            overflow-x: auto;
            border-bottom: 2px solid var(--secondary-color);
            margin-bottom: 0;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .input-tabs-nav::-webkit-scrollbar {
            display: none;
        }

        .input-tab {
            padding: 1rem 1.5rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 700;
            color: #64748b;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            flex: 1;
            justify-content: center;
            min-width: 140px;
        }

        .input-tab:hover {
            background-color: #e2e8f0;
            color: var(--primary-color);
        }

        .input-tab.active {
            background-color: #fff;
            color: var(--secondary-color);
            border-bottom-color: var(--secondary-color);
            border-radius: 8px 8px 0 0;
            margin-bottom: -2px;
            border-left: 1px solid #e1e5e9;
            border-right: 1px solid #e1e5e9;
            border-top: 1px solid #e1e5e9;
        }

        .input-tab-content {
            display: none;
            padding-top: 1.5rem;
            border: 1px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 8px 8px;
            padding: 1.5rem;
            background-color: white;
        }

        .input-tab-content.active {
            display: block;
        }

        /* --- MODIFICACIONES PARA ANCHO RESPONSIVE --- */
        .main-content-wrapper {
            margin: 0 auto;
            padding: 1.25rem;
            max-width: 1400px;
            width: 100%;
            box-sizing: border-box;
        }

        .header {
            max-width: 1400px;
            margin: 0 auto 1.25rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #ddd;
            text-align: center;
        }

        .content-block {
            max-width: 1400px;
            margin: 0 auto 1.5rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        footer {
            padding: 2rem 1.25rem;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .disclaimer-note {
            margin-top: 2rem;
            padding: 0 1rem;
            font-size: 0.8rem;
            color: #777;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
            text-align: left;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .main-content-wrapper {
                padding: 1rem;
            }

            .content-block {
                padding: 1rem;
                margin: 0 auto 1rem;
            }

            footer {
                padding: 1.5rem 1rem;
            }

            .input-tab {
                padding: 0.8rem 1rem;
                min-width: 120px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .main-content-wrapper {
                padding: 0.75rem;
            }

            .content-block {
                padding: 0.75rem;
                border-radius: 6px;
            }

            footer {
                padding: 1rem 0.75rem;
            }

            .input-tab {
                padding: 0.6rem 0.75rem;
                min-width: 100px;
                font-size: 0.85rem;
            }
        }

        .header h1 {
            color: var(--primary-color);
            font-size: clamp(1.5rem, 4vw, 1.8rem);
            margin: 0.5rem 0;
            font-weight: 800;
        }

        .header-subtitle {
            font-size: 1.1rem;
            color: #7f8c8d;
            margin: 0;
            font-weight: 400;
        }

        .content-block h2 {
            font-size: 1.5em;
            margin-top: 0;
            margin-bottom: 1.25rem;
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.6rem;
            font-weight: 800;
        }

        .content-block h2 .fas {
            margin-right: 0.75rem;
        }

        .tool-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.6rem;
            margin-bottom: 1.5rem;
        }

        .header h1 .fas.fa-chart-bar {
            color: var(--warning-color);
        }

        .infographic-flow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1.5rem;
            text-align: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .flow-step {
            flex: 1;
            min-width: 150px;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #f8f9fa;
            margin: 5px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .flow-step:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }

        .flow-step .fas {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin-bottom: 0.6rem;
        }

        .flow-step strong {
            display: block;
            font-size: 1.1rem;
            color: var(--primary-color);
            font-weight: 600;
        }

        .flow-arrow {
            font-size: 2rem;
            color: var(--secondary-color);
            margin: 0 0.6rem;
        }

        .key-components-list {
            list-style: none;
            padding-left: 0;
        }

        .key-components-list li {
            margin-bottom: 0.75rem;
            padding-left: 1.5rem;
            position: relative;
        }

        .key-components-list li::before {
            content: '\f058';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--success-color);
            position: absolute;
            left: 0;
            top: 2px;
        }

        .instructions-box ul {
            margin: 0.6rem 0 0 0;
            padding-left: 1.25rem;
        }

        label {
            display: block;
            margin-bottom: 0.6rem;
            color: var(--primary-color);
            font-weight: 600;
        }

        input[type="text"],
        select {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            transition: border 0.3s, box-shadow 0.3s;
            font-family: 'Nunito', sans-serif;
        }

        input:focus,
        select:focus,
        button:focus-visible {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
        }

        .main-content-wrapper button {
            background-color: var(--secondary-color);
            color: white;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 1rem;
            transition: background-color 0.3s;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
        }

        .main-content-wrapper button:hover {
            background-color: #2980b9;
        }

        .btn-add {
            background-color: var(--success-color);
            padding: 0;
            width: 42px;
            height: 42px;
            font-size: 1.2em;
            flex-shrink: 0;
        }

        .btn-remove {
            background-color: var(--accent-color);
            padding: 0;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            font-size: 1em;
            flex-shrink: 0;
        }

        .list-container {
            min-height: 100px;
            border: 1px solid #eee;
            padding: 0.6rem;
            border-radius: 4px;
            margin-bottom: 1rem;
            background-color: #fafafa;
        }

        .list-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.6rem;
            padding: 0.6rem;
            background-color: #f9f9f9;
            border-radius: 4px;
            margin-bottom: 0.5rem;
            border: 1px solid #eee;
        }

        .list-item span {
            flex-grow: 1;
            word-break: break-word;
        }

        .customer-importance-container {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 150px;
            flex-shrink: 0;
        }

        .customer-importance-bar-bg {
            flex-grow: 1;
            background-color: #e0e0e0;
            border-radius: 4px;
            height: 18px;
        }

        .customer-importance-bar {
            height: 100%;
            background-color: var(--success-color);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .add-item-form {
            display: flex;
            gap: 0.6rem;
            align-items: center;
            margin-top: 1rem;
            padding: 1rem;
            background-color: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #eee;
        }

        .add-item-form .input-group {
            flex-grow: 1;
        }

        .add-item-form .select-group {
            width: 150px;
        }

        .table-responsive-wrapper {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin-top: 1rem;
            border: 1px solid #eee;
            border-radius: 4px;
            padding: 1rem;
            background-color: white;
        }

        #qfdMatrixContainer {
            width: 100%;
            overflow-x: auto;
            padding: 2px;
        }

        .qfd-table {
            border-collapse: collapse;
            font-size: 1rem;
            width: 100%;
        }

        .qfd-table th,
        .qfd-table td {
            border: 1px solid #ccc;
            padding: 0.5rem;
            text-align: center;
            vertical-align: middle;
            white-space: nowrap;
        }

        .qfd-table th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        .qfd-table .customer-requirements {
            text-align: left;
            max-width: 200px;
            word-wrap: break-word;
            font-weight: bold;
            background-color: #eaf2f8;
            white-space: normal;
        }

        .qfd-table .importance-cell {
            font-weight: bold;
            background-color: #fef9e7;
        }

        .qfd-table .technical-requirements {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            vertical-align: middle;
            white-space: normal;
            max-width: 150px;
        }

        .relationship-strong,
        .correlation-positive-strong {
            background-color: var(--success-color);
            color: var(--dark-color);
            font-weight: bold;
        }

        .relationship-medium,
        .correlation-positive-weak {
            background-color: var(--warning-color);
            color: var(--dark-color);
            font-weight: bold;
        }

        .relationship-weak,
        .correlation-negative-weak {
            background-color: var(--accent-color);
            color: white;
            font-weight: bold;
        }

        .correlation-negative-strong {
            background-color: #7d3c98;
            color: white;
            font-weight: bold;
        }

        .priority-bar-container {
            background-color: #e0e0e0;
            border-radius: 4px;
            height: 20px;
            width: 100%;
            min-width: 100px;
        }

        .priority-bar {
            height: 100%;
            background-color: var(--secondary-color);
            border-radius: 4px;
            transition: width 0.5s ease-in-out;
        }

        .example-btn {
            background-color: var(--success-color);
        }

        .reset-btn {
            background-color: var(--warning-color);
        }

        .info-box {
            background-color: #e8f4fc;
            border-left: 4px solid var(--secondary-color);
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 0 4px 4px 0;
        }

        .info-box p {
            margin: 0;
            color: var(--primary-color);
        }

        #toast-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
            transform: translateY(-20px);
        }

        #toast-notification.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        #toast-notification.success {
            background-color: var(--success-color);
        }

        #toast-notification.info {
            background-color: #3498db;
        }

        @media (max-width: 768px) {
            .infographic-flow {
                flex-direction: column;
                align-items: stretch;
            }

            .flow-arrow {
                transform: rotate(90deg);
                margin: 1rem 0;
            }

            .add-item-form {
                flex-direction: column;
                align-items: stretch;
            }

            .add-item-form .select-group {
                width: 100%;
            }

            .add-item-form .input-group {
                width: 100%;
            }

            .customer-importance-container {
                width: 120px;
            }
        }
    </style>
</head>

<body>
    <!-- Contenedor para el header dinámico -->
    <div id="header-container"></div>
    <div id="header-container"></div>
    <div id="header-container"></div>

    <noscript>
        <nav>
            <a href="/">Home</a> |
            <a href="/8d">8D Tool</a> |
            <a href="/taguchi_doe">Taguchi DOE</a> |
            <a href="/swot">SWOT Analysis</a> |
            <a href="/balancedcard">Balanced Scorecard</a> |
            <a href="/qfd">QFD</a> |
            <a href="/apqp-ppap">APQP/PPAP</a> |
            <a href="/ishikawa">Ishikawa</a> |
            <a href="/fmea">FMEA</a> |
            <a href="/vave">VAVE</a> |
            <a href="/eisenhower">Eisenhower Matrix</a> |
            <a href="/triz">TRIZ</a> |
            <a href="/weibull">Weibull</a> |
            <a href="/stack_up_analysis">Tolerance Stack-Up</a> |
            <a href="/pdca">PDCA</a> |
            <a href="/design_thinking">Design Thinking</a> |
            <a href="/pugh">Pugh Matrix</a> |
            <a href="/cpk_calculator">CpK Calculator</a> |
            <a href="/control-plan">Control Plan</a>
        </nav>
    </noscript>

    <main class="main-content-wrapper">
        <div id="toast-notification"></div>
        <header class="header">
            <h1><i class="fas fa-chart-bar"></i> Free Online Quality Function Deployment (QFD) Tool</h1>
            <p class="header-subtitle">Translating Customer Needs into Technical Reality with the House of Quality</p>
        </header>

        <!-- SISTEMA DE TABS -->
        <div class="tabs-container">
            <!-- NAVEGACIÓN DE PESTAÑAS PRINCIPALES -->
            <nav class="tabs-nav">
                <button class="tab-btn active" onclick="switchQfdTab('tab-theory')">
                    <i class="fas fa-book"></i> Theory & Info
                </button>
                <button class="tab-btn" onclick="switchQfdTab('tab-input')">
                    <i class="fas fa-edit"></i> Input Data
                </button>
                <button class="tab-btn" onclick="switchQfdTab('tab-results')">
                    <i class="fas fa-chart-bar"></i> Results & Matrix
                </button>
            </nav>

            <!-- PESTAÑA 1: TEORÍA E INFORMACIÓN -->
            <div id="tab-theory" class="tab-content active">
                <div class="tab-content-wrapper">
                    <div class="content-block">
                        <h2><i class="fas fa-question-circle"></i> What is Quality Function Deployment?</h2>
                        <p>Quality Function Deployment (QFD) is a structured methodology used to translate customer
                            requirements—the
                            "Voice of the Customer" (VOC)—into detailed engineering specifications for a product or
                            service. The
                            primary tool of QFD is the <strong>House of Quality</strong>, a matrix that connects what
                            the customer
                            wants to how the organization can deliver it. It's a roadmap for prioritizing design efforts
                            on what
                            truly matters to the customer.</p>
                        <div class="infographic-flow">
                            <div class="flow-step"><i class="fas fa-users"></i><strong>1. Customer
                                    Needs</strong><span>What do they
                                    want?</span></div>
                            <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                            <div class="flow-step"><i class="fas fa-cogs"></i><strong>2. Technical
                                    Specs</strong><span>How can we
                                    achieve it?</span></div>
                            <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                            <div class="flow-step"><i class="fas fa-link"></i><strong>3. Relationships</strong><span>How
                                    do they
                                    connect?</span></div>
                            <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                            <div class="flow-step"><i class="fas fa-trophy"></i><strong>4.
                                    Priorities</strong><span>What's most
                                    important?</span></div>
                        </div>
                    </div>

                    <div class="content-block">
                        <h2><i class="fas fa-list-ol"></i> Key Components of the House of Quality</h2>
                        <p>The "House of Quality" gets its name from its house-like shape. Each section has a specific
                            purpose:</p>
                        <ul class="key-components-list">
                            <li><strong>Customer Requirements (The "Whats"):</strong> The left "wall" of the house,
                                listing the
                                wants and needs gathered from the customer.</li>
                            <li><strong>Importance to Customer:</strong> A ranking of how critical each customer
                                requirement is,
                                typically on a 1-5 scale.</li>
                            <li><strong>Technical Requirements (The "Hows"):</strong> The "ceiling" of the house,
                                listing the
                                engineering characteristics or design parameters that can be measured and controlled.
                            </li>
                            <li><strong>Relationship Matrix:</strong> The main "room" of the house, where the
                                relationships between
                                customer needs and technical requirements are scored (e.g., strong, medium, weak).</li>
                            <li><strong>Correlation Matrix (The "Roof"):</strong> Shows how the technical requirements
                                interact with
                                each other—do they support or conflict with one another?</li>
                            <li><strong>Technical Priorities:</strong> The "floor" or "basement" of the house, which
                                calculates the
                                importance of each technical requirement based on the customer needs it affects. This is
                                the primary
                                output of the matrix.</li>
                        </ul>
                    </div>

                    <div class="content-block">
                        <h2><i class="fas fa-history"></i> Brief History & Purpose</h2>
                        <p>QFD was developed in Japan in the late 1960s by quality experts Yoji Akao and Shigeru Mizuno.
                            It was
                            first implemented at Mitsubishi's Kobe shipyard and later popularized by Toyota and its
                            suppliers. The
                            core purpose of QFD is to ensure that the <strong>Voice of the Customer</strong> is not lost
                            during the
                            complex process of design, engineering, and manufacturing.</p>
                        <p>By systematically linking customer desires to technical functions, QFD helps teams focus
                            resources on the
                            most critical features. This proactive approach prevents costly late-stage design changes,
                            shortens
                            development time, and ultimately leads to higher customer satisfaction and market success.
                        </p>
                    </div>

                    <div class="content-block">
                        <h2><i class="fas fa-tools"></i> How to Use This Tool</h2>
                        <div class="instructions-box">
                            <ul>
                                <li>Navigate to the <strong>Input Data</strong> tab to start entering your requirements
                                </li>
                                <li><strong>Customer Needs & Technical Specs:</strong> Type a requirement/spec into the
                                    text field
                                    and click the green `+` button to add it to the list. Remove items with the red `-`
                                    button.</li>
                                <li><strong>Relationships & Correlations:</strong> Use the tabs within the Input Data
                                    section to define relationships and correlations</li>
                                <li>Click <strong><i class="fas fa-home"></i> Generate House of Quality</strong> to
                                    build the matrix
                                    and see the prioritized technical requirements.</li>
                                <li>Use <strong><i class="fas fa-lightbulb"></i> Load Example</strong> for a pre-filled
                                    demonstration or <strong><i class="fas fa-file-excel"></i> Export to Excel</strong>
                                    to save your
                                    work.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA 2: DATOS DE ENTRADA (COMPLETA) -->
            <div id="tab-input" class="tab-content">
                <div class="tab-content-wrapper">
                    <div class="content-block">
                        <div class="tool-header">
                            <h2><i class="fas fa-drafting-compass"></i> QFD Input Data - Build Your House of Quality
                            </h2>
                            <div>
                                <button id="loadExampleBtn" class="example-btn"><i class="fas fa-lightbulb"></i> Load
                                    Example</button>
                                <button id="resetBtn" class="reset-btn"><i class="fas fa-undo"></i> Reset All</button>
                            </div>
                        </div>

                        <div class="info-box">
                            <p><i class="fas fa-info-circle"></i> Use the tabs below to enter all necessary data for
                                your QFD analysis. Start with Customer Needs, then add Technical Specifications, define
                                Relationships, and finally set Correlations.</p>
                        </div>

                        <!-- TABS INTERNAS CON LOS MISMOS COLORES -->
                        <div class="input-tabs-nav">
                            <div class="input-tab active" data-input-tab="customer-needs">
                                <i class="fas fa-users"></i> Customer Needs
                            </div>
                            <div class="input-tab" data-input-tab="technical-specs">
                                <i class="fas fa-cogs"></i> Technical Specs
                            </div>
                            <div class="input-tab" data-input-tab="relationships">
                                <i class="fas fa-link"></i> Relationships
                            </div>
                            <div class="input-tab" data-input-tab="correlations">
                                <i class="fas fa-project-diagram"></i> Correlations
                            </div>
                        </div>

                        <!-- CONTENIDO DE CUSTOMER NEEDS -->
                        <div class="input-tab-content active" id="input-customer-needs">
                            <h3><i class="fas fa-users"></i> Customer Requirements (The "Whats")</h3>
                            <p>Enter the voice of the customer - what they need, want, or expect from the
                                product/service.</p>

                            <label for="newCustomerReqText">Add New Customer Requirement:</label>
                            <div class="add-item-form">
                                <div class="input-group">
                                    <input type="text" id="newCustomerReqText"
                                        placeholder="e.g., 'Easy to use', 'Durable', 'Affordable'...">
                                </div>
                                <div class="select-group">
                                    <select id="importanceScale">
                                        <option value="1">Importance: 1 (Low)</option>
                                        <option value="2">Importance: 2</option>
                                        <option value="3">Importance: 3 (Medium)</option>
                                        <option value="4">Importance: 4</option>
                                        <option value="5" selected>Importance: 5 (High)</option>
                                    </select>
                                </div>
                                <button id="addCustomerReqBtn" class="btn-add" title="Add Requirement">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>

                            <label>Current Customer Requirements:</label>
                            <div id="customerReqList" class="list-container">
                                <!-- Customer requirements will be dynamically added here -->
                                <div style="text-align: center; padding: 2rem; color: #777;">
                                    <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                                    <p>No customer requirements added yet. Add your first requirement above.</p>
                                </div>
                            </div>
                        </div>

                        <!-- CONTENIDO DE TECHNICAL SPECS -->
                        <div class="input-tab-content" id="input-technical-specs">
                            <h3><i class="fas fa-cogs"></i> Technical Specifications (The "Hows")</h3>
                            <p>Enter measurable engineering characteristics that can fulfill customer requirements.</p>

                            <label for="newTechnicalSpecText">Add New Technical Specification:</label>
                            <div class="add-item-form">
                                <div class="input-group">
                                    <input type="text" id="newTechnicalSpecText"
                                        placeholder="e.g., 'Weight (g)', 'Material thickness', 'Cost ($)'...">
                                </div>
                                <button id="addTechnicalSpecBtn" class="btn-add" title="Add Specification">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>

                            <label>Current Technical Specifications:</label>
                            <div id="technicalSpecList" class="list-container">
                                <!-- Technical specs will be dynamically added here -->
                                <div style="text-align: center; padding: 2rem; color: #777;">
                                    <i class="fas fa-cogs" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                                    <p>No technical specifications added yet. Add your first specification above.</p>
                                </div>
                            </div>
                        </div>

                        <!-- CONTENIDO DE RELATIONSHIPS -->
                        <div class="input-tab-content" id="input-relationships">
                            <h3><i class="fas fa-link"></i> Relationship Matrix</h3>
                            <p>Define how strongly each customer requirement relates to each technical specification.
                            </p>
                            <p><strong>Strong (9):</strong> Strong correlation | <strong>Medium (3):</strong> Moderate
                                correlation | <strong>Weak (1):</strong> Weak correlation</p>

                            <div id="relationshipControls" class="table-responsive-wrapper">
                                <div style="text-align: center; padding: 2rem; color: #777;">
                                    <i class="fas fa-link" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                                    <p>Add customer requirements and technical specifications first to see the
                                        relationship matrix.</p>
                                </div>
                            </div>
                        </div>

                        <!-- CONTENIDO DE CORRELATIONS -->
                        <div class="input-tab-content" id="input-correlations">
                            <h3><i class="fas fa-project-diagram"></i> Correlation Matrix (The "Roof")</h3>
                            <p>Define how technical specifications interact with each other.</p>
                            <p><strong>++:</strong> Strong Positive | <strong>+:</strong> Positive | <strong>-:</strong>
                                Negative | <strong>--:</strong> Strong Negative</p>

                            <div id="correlationControls" class="table-responsive-wrapper">
                                <div style="text-align: center; padding: 2rem; color: #777;">
                                    <i class="fas fa-project-diagram" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                                    <p>Add at least 2 technical specifications to see the correlation matrix.</p>
                                </div>
                            </div>
                        </div>

                        <!-- BOTÓN PARA GENERAR -->
                        <div style="margin-top: 2rem; text-align: center;">
                            <button id="generateQfdBtn" style="padding: 1rem 2rem; font-size: 1.1rem;">
                                <i class="fas fa-home"></i> Generate House of Quality Matrix
                            </button>
                            <p style="margin-top: 0.5rem; color: #777; font-size: 0.9rem;">
                                <i class="fas fa-lightbulb"></i> Make sure you've entered data in all sections before
                                generating the matrix.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA 3: RESULTADOS Y MATRIZ -->
            <div id="tab-results" class="tab-content">
                <div class="tab-content-wrapper">
                    <div id="qfdMatrix" class="content-block" style="display: none;">
                        <div class="tool-header">
                            <h2><i class="fas fa-table"></i> House of Quality Matrix</h2>
                            <button id="backToInputBtn" style="background-color: var(--warning-color);">
                                <i class="fas fa-edit"></i> Edit Input Data
                            </button>
                        </div>
                        <div id="qfdMatrixContainer" class="table-responsive-wrapper">
                            <div style="text-align: center; padding: 3rem; color: #777;">
                                <i class="fas fa-home" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                                <h3>House of Quality Matrix Not Generated Yet</h3>
                                <p>Go to the <strong>Input Data</strong> tab, enter your requirements and
                                    specifications, then click "Generate House of Quality Matrix".</p>
                            </div>
                        </div>
                    </div>

                    <div class="content-block">
                        <h2><i class="fas fa-award"></i> Prioritized Technical Requirements</h2>
                        <div class="table-responsive-wrapper">
                            <table id="priorityTable" class="qfd-table">
                                <thead>
                                    <tr>
                                        <th style="width: 40%;">Technical Requirement</th>
                                        <th style="width: 15%;">Priority Score</th>
                                        <th style="width: 35%;">Priority</th>
                                        <th style="width: 10%;">Rank</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td colspan="4" style="text-align: center; padding: 2rem; color: #777;">
                                            <i class="fas fa-chart-bar"
                                                style="font-size: 2rem; margin-bottom: 1rem;"></i>
                                            <p>Priority rankings will appear here after generating the House of Quality
                                                matrix.</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: center;">
                            <button id="exportQfdBtn" style="flex: 1; max-width: 300px;">
                                <i class="fas fa-file-excel"></i> Export to Excel
                            </button>
                            <button id="printQfdBtn" style="flex: 1; max-width: 300px; background-color: #7d3c98;">
                                <i class="fas fa-print"></i> Print Results
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="disclaimer-note">
            <p><strong>Disclaimer:</strong> The tools and information provided on Sigma Exacta are for informational and
                educational purposes only. This tool is based on the Quality Function Deployment (QFD) methodology, also
                known as the House of Quality, developed by Yoji Akao and Shigeru Mizuno. The tools on this site are
                independent implementations and are not affiliated with, sponsored by, or endorsed by the original
                creators or any specific institution. While we strive for accuracy, we make no warranty or guarantee
                regarding the results. All decisions related to product design, engineering priorities, or strategic
                planning based on the output of this tool are the sole responsibility of the user. Sigma Exacta and its
                creators are not liable for any damages or losses resulting from the use of this website.</p>
        </div>
    </footer>

    <script>
        // Función para cambiar entre pestañas principales
        function switchQfdTab(tabId) {
            // Quitar clase active de todos los botones y contenidos
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // Activar el contenido seleccionado
            document.getElementById(tabId).classList.add('active');

            // Activar botón correspondiente
            const activeBtn = document.querySelector(`button[onclick="switchQfdTab('${tabId}')"]`);
            if (activeBtn) activeBtn.classList.add('active');

            // Si vamos a la pestaña de resultados, asegurarse de que la matriz esté visible si ya se generó
            if (tabId === 'tab-results') {
                const qfdMatrix = document.getElementById('qfdMatrix');
                if (qfdMatrix.style.display !== 'none') {
                    setTimeout(() => {
                        qfdMatrix.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }, 100);
                }
            }
        }

        // Función para cambiar entre pestañas de input
        function switchInputTab(tabId) {
            // Quitar clase active de todos los botones y contenidos de input
            document.querySelectorAll('.input-tab').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.input-tab-content').forEach(content => content.classList.remove('active'));

            // Activar el contenido seleccionado
            document.getElementById('input-' + tabId).classList.add('active');

            // Activar botón correspondiente
            const activeBtn = document.querySelector(`.input-tab[data-input-tab="${tabId}"]`);
            if (activeBtn) activeBtn.classList.add('active');

            // Actualizar controles si es necesario
            if (tabId === 'relationships') updateRelationshipControls();
            if (tabId === 'correlations') updateCorrelationControls();
        }

        // Cargar el header dinámicamente
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-container').innerHTML = data;
                // Inicializar el menú después de cargar el header
                initializeMenu();
            })
            .catch(error => console.error('Error loading header:', error));

        function initializeMenu() {
            const navToggle = document.getElementById('nav-toggle');
            const navMenu = document.getElementById('nav-menu');
            const toolsDropdownToggle = document.getElementById('tools-dropdown-toggle');
            const toolsDropdownMenu = document.getElementById('tools-dropdown-menu');
            const toolsDropdownContainer = document.getElementById('tools-dropdown-container');

            if (navToggle && navMenu) {
                navToggle.addEventListener('click', () => {
                    navMenu.classList.toggle('show-menu');
                    const icon = navToggle.querySelector('i');
                    icon.classList.toggle('fa-bars');
                    icon.classList.toggle('fa-times');

                    if (!navMenu.classList.contains('show-menu')) {
                        toolsDropdownMenu.classList.remove('show-submenu');
                        toolsDropdownContainer.classList.remove('active');
                    }
                });
            }

            if (toolsDropdownToggle && toolsDropdownMenu && toolsDropdownContainer) {
                toolsDropdownToggle.addEventListener('click', (event) => {
                    if (window.innerWidth <= 992) {
                        event.preventDefault();
                        toolsDropdownMenu.classList.toggle('show-submenu');
                        toolsDropdownContainer.classList.toggle('active');
                    }
                });
            }
        }

        // Variables globales para datos del QFD
        let customerRequirements = [];
        let technicalRequirements = [];
        let relationships = {};
        let correlations = {};

        // Función para renderizar requisitos del cliente
        function renderCustomerRequirements() {
            const list = document.getElementById('customerReqList');
            if (customerRequirements.length === 0) {
                list.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #777;">
                        <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>No customer requirements added yet. Add your first requirement above.</p>
                    </div>
                `;
                return;
            }

            list.innerHTML = customerRequirements.map(req => `
                <div class="list-item" data-id="${req.id}">
                    <span>${req.text}</span>
                    <div class="customer-importance-container">
                        <div class="customer-importance-bar-bg">
                            <div class="customer-importance-bar" style="width: ${(req.importance / 5) * 100}%;"></div>
                        </div>
                        <span style="min-width: 20px; text-align: center;">${req.importance}</span>
                    </div>
                    <button class="btn-remove" title="Remove Requirement">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            `).join('');
        }

        // Función para renderizar especificaciones técnicas
        function renderTechnicalSpecs() {
            const list = document.getElementById('technicalSpecList');
            if (technicalRequirements.length === 0) {
                list.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #777;">
                        <i class="fas fa-cogs" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>No technical specifications added yet. Add your first specification above.</p>
                    </div>
                `;
                return;
            }

            list.innerHTML = technicalRequirements.map(spec => `
                <div class="list-item" data-id="${spec.id}">
                    <span>${spec.text}</span>
                    <button class="btn-remove" title="Remove Specification">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            `).join('');
        }

        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', () => {
            // Renderizar listas iniciales
            renderCustomerRequirements();
            renderTechnicalSpecs();

            // Configurar event listeners para tabs de input
            document.querySelectorAll('.input-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-input-tab');
                    switchInputTab(tabId);
                });
            });

            // Agregar requisitos del cliente
            document.getElementById('addCustomerReqBtn').addEventListener('click', () => {
                const input = document.getElementById('newCustomerReqText');
                const text = input.value.trim();
                if (!text) {
                    showToast('Please enter a customer requirement.', 'info');
                    return;
                }

                const importance = document.getElementById('importanceScale').value;
                customerRequirements.push({
                    id: 'cr_' + Date.now(),
                    text: text,
                    importance: parseInt(importance)
                });

                input.value = '';
                input.focus();
                renderCustomerRequirements();
                showToast('Customer requirement added.', 'success');

                // Actualizar controles de relación si están visibles
                if (document.getElementById('input-relationships').classList.contains('active')) {
                    updateRelationshipControls();
                }
            });

            // Agregar especificaciones técnicas
            document.getElementById('addTechnicalSpecBtn').addEventListener('click', () => {
                const input = document.getElementById('newTechnicalSpecText');
                const text = input.value.trim();
                if (!text) {
                    showToast('Please enter a technical specification.', 'info');
                    return;
                }

                technicalRequirements.push({
                    id: 'tr_' + Date.now(),
                    text: text
                });

                input.value = '';
                input.focus();
                renderTechnicalSpecs();
                showToast('Technical specification added.', 'success');

                // Actualizar controles si están visibles
                if (document.getElementById('input-relationships').classList.contains('active')) {
                    updateRelationshipControls();
                }
                if (document.getElementById('input-correlations').classList.contains('active')) {
                    updateCorrelationControls();
                }
            });

            // Permitir agregar con Enter
            document.getElementById('newCustomerReqText').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    document.getElementById('addCustomerReqBtn').click();
                }
            });

            document.getElementById('newTechnicalSpecText').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    document.getElementById('addTechnicalSpecBtn').click();
                }
            });

            // Eliminar requisitos del cliente
            document.getElementById('customerReqList').addEventListener('click', (e) => {
                if (e.target.closest('.btn-remove')) {
                    const itemId = e.target.closest('.list-item').dataset.id;
                    customerRequirements = customerRequirements.filter(req => req.id !== itemId);
                    renderCustomerRequirements();
                    showToast('Customer requirement removed.', 'info');

                    // Actualizar controles de relación
                    updateRelationshipControls();
                }
            });

            // Eliminar especificaciones técnicas
            document.getElementById('technicalSpecList').addEventListener('click', (e) => {
                if (e.target.closest('.btn-remove')) {
                    const itemId = e.target.closest('.list-item').dataset.id;
                    technicalRequirements = technicalRequirements.filter(spec => spec.id !== itemId);
                    renderTechnicalSpecs();
                    showToast('Technical specification removed.', 'info');

                    // Actualizar controles
                    updateRelationshipControls();
                    updateCorrelationControls();
                }
            });

            // Cambios en relaciones
            document.getElementById('relationshipControls').addEventListener('change', e => {
                if (e.target.tagName === 'SELECT') {
                    const relationshipId = `${e.target.dataset.crId}_${e.target.dataset.trId}`;
                    if (e.target.value) {
                        relationships[relationshipId] = e.target.value;
                    } else {
                        delete relationships[relationshipId];
                    }
                }
            });

            // Cambios en correlaciones
            document.getElementById('correlationControls').addEventListener('change', e => {
                if (e.target.tagName === 'SELECT') {
                    const correlationId = `${e.target.dataset.tr1Id}_${e.target.dataset.tr2Id}`;
                    if (e.target.value) {
                        correlations[correlationId] = e.target.value;
                    } else {
                        delete correlations[correlationId];
                    }
                }
            });

            // Generar matriz QFD
            document.getElementById('generateQfdBtn').addEventListener('click', () => {
                if (customerRequirements.length === 0) {
                    showToast('Please add at least one customer requirement.', 'info');
                    switchInputTab('customer-needs');
                    return;
                }

                if (technicalRequirements.length === 0) {
                    showToast('Please add at least one technical specification.', 'info');
                    switchInputTab('technical-specs');
                    return;
                }

                generateQfdMatrix();
                calculatePriorities();
                document.getElementById('qfdMatrix').style.display = 'block';

                // Cambiar a la pestaña de resultados
                switchQfdTab('tab-results');

                showToast('House of Quality matrix generated successfully!', 'success');
            });

            // Botón para volver a input data
            document.getElementById('backToInputBtn').addEventListener('click', () => {
                switchQfdTab('tab-input');
            });

            // Botón de imprimir
            document.getElementById('printQfdBtn').addEventListener('click', () => {
                window.print();
            });

            // Cargar ejemplo
            document.getElementById('loadExampleBtn').addEventListener('click', loadExample);

            // Resetear todo
            document.getElementById('resetBtn').addEventListener('click', resetAll);

            // Exportar a Excel
            document.getElementById('exportQfdBtn').addEventListener('click', exportToExcel);
        });

        // Actualizar controles de relación
        function updateRelationshipControls() {
            const container = document.getElementById('relationshipControls');

            if (customerRequirements.length === 0 || technicalRequirements.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #777;">
                        <i class="fas fa-link" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>Add customer requirements and technical specifications first to see the relationship matrix.</p>
                    </div>
                `;
                return;
            }

            const table = document.createElement('table');
            table.className = 'qfd-table';

            let headerHtml = '<thead><tr><th>Customer Need</th><th>Importance</th>';
            technicalRequirements.forEach(tr => {
                headerHtml += `<th>${tr.text}</th>`;
            });
            headerHtml += '</tr></thead><tbody>';

            customerRequirements.forEach(cr => {
                headerHtml += `<tr><td class="customer-requirements">${cr.text}</td><td class="importance-cell">${cr.importance}</td>`;
                technicalRequirements.forEach(tr => {
                    const relId = `${cr.id}_${tr.id}`;
                    const currentVal = relationships[relId] || '';
                    headerHtml += `
                        <td>
                            <select data-cr-id="${cr.id}" data-tr-id="${tr.id}" style="min-width: 100px;">
                                <option value="" ${!currentVal ? 'selected' : ''}>None</option>
                                <option value="strong" ${currentVal === 'strong' ? 'selected' : ''}>Strong (9)</option>
                                <option value="medium" ${currentVal === 'medium' ? 'selected' : ''}>Medium (3)</option>
                                <option value="weak" ${currentVal === 'weak' ? 'selected' : ''}>Weak (1)</option>
                            </select>
                        </td>`;
                });
                headerHtml += '</tr>';
            });

            table.innerHTML = headerHtml + '</tbody>';
            container.innerHTML = '';
            container.appendChild(table);
        }

        // Actualizar controles de correlación
        function updateCorrelationControls() {
            const container = document.getElementById('correlationControls');

            if (technicalRequirements.length < 2) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #777;">
                        <i class="fas fa-project-diagram" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>Add at least 2 technical specifications to see the correlation matrix.</p>
                    </div>
                `;
                return;
            }

            const table = document.createElement('table');
            table.className = 'qfd-table';

            let tableHtml = '<thead><tr><th></th>';
            technicalRequirements.forEach(tr => {
                tableHtml += `<th>${tr.text}</th>`;
            });
            tableHtml += '</tr></thead><tbody>';

            technicalRequirements.forEach((tr1, i) => {
                tableHtml += `<tr><th class="technical-requirements">${tr1.text}</th>`;
                technicalRequirements.forEach((tr2, j) => {
                    if (i >= j) {
                        tableHtml += `<td style="background-color: #f5f5f5;"></td>`;
                    } else {
                        const corrId = `${tr1.id}_${tr2.id}`;
                        const currentVal = correlations[corrId] || '';
                        tableHtml += `
                            <td>
                                <select data-tr1-id="${tr1.id}" data-tr2-id="${tr2.id}" style="min-width: 100px;">
                                    <option value="" ${!currentVal ? 'selected' : ''}>None</option>
                                    <option value="positive-strong" ${currentVal === 'positive-strong' ? 'selected' : ''}>++ Strong Positive</option>
                                    <option value="positive-weak" ${currentVal === 'positive-weak' ? 'selected' : ''}>+ Positive</option>
                                    <option value="negative-weak" ${currentVal === 'negative-weak' ? 'selected' : ''}>- Negative</option>
                                    <option value="negative-strong" ${currentVal === 'negative-strong' ? 'selected' : ''}>-- Strong Negative</option>
                                </select>
                            </td>`;
                    }
                });
                tableHtml += '</tr>';
            });

            table.innerHTML = tableHtml + '</tbody>';
            container.innerHTML = '';
            container.appendChild(table);
        }

        // Generar matriz QFD
        function generateQfdMatrix() {
            const container = document.getElementById('qfdMatrixContainer');
            const table = document.createElement('table');
            table.className = 'qfd-table';
            table.id = 'qfdFinalTable';

            // Crear techo de la casa (correlaciones)
            const thead = table.createTHead();
            for (let i = 0; i < technicalRequirements.length; i++) {
                const row = thead.insertRow();

                if (i === 0) {
                    const cell = document.createElement('th');
                    cell.rowSpan = technicalRequirements.length;
                    cell.colSpan = 2;
                    cell.style.backgroundColor = "#f5f5f5";
                    cell.style.border = "none";
                    cell.innerHTML = "<strong>Correlations (Roof)</strong>";
                    row.appendChild(cell);
                }

                for (let j = 0; j < i; j++) {
                    row.insertCell().style.border = 'none';
                }

                const th = document.createElement('th');
                th.className = "technical-requirements";
                th.innerHTML = technicalRequirements[i].text;
                row.appendChild(th);

                for (let j = i + 1; j < technicalRequirements.length; j++) {
                    const cell = row.insertCell();
                    const corr = correlations[`${technicalRequirements[i].id}_${technicalRequirements[j].id}`] || '';

                    if (corr.includes('positive')) {
                        cell.textContent = corr.includes('weak') ? '+' : '++';
                        cell.className = `correlation-${corr}`;
                    } else if (corr.includes('negative')) {
                        cell.textContent = corr.includes('weak') ? '-' : '--';
                        cell.className = `correlation-${corr}`;
                    }
                }
            }

            // Crear cuerpo principal (relaciones)
            const tbody = table.createTBody();
            customerRequirements.forEach(cr => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td class="customer-requirements">${cr.text}</td>
                    <td class="importance-cell">${cr.importance}</td>
                `;

                technicalRequirements.forEach(tr => {
                    const cell = row.insertCell();
                    const rel = relationships[`${cr.id}_${tr.id}`] || '';

                    if (rel === 'strong') {
                        cell.textContent = '●';
                        cell.className = 'relationship-strong';
                        cell.title = 'Strong relationship (9)';
                    } else if (rel === 'medium') {
                        cell.textContent = '○';
                        cell.className = 'relationship-medium';
                        cell.title = 'Medium relationship (3)';
                    } else if (rel === 'weak') {
                        cell.textContent = '▲';
                        cell.className = 'relationship-weak';
                        cell.title = 'Weak relationship (1)';
                    }
                });
            });

            // Crear pie de página (prioridades y rankings)
            const tfoot = table.createTFoot();
            const priorityRow = tfoot.insertRow();
            priorityRow.innerHTML = `<th class="technical-requirements" colspan="2">Technical Priority Score</th>`;

            technicalRequirements.forEach(tr => {
                const cell = priorityRow.insertCell();
                cell.id = `priority_${tr.id}`;
                cell.style.fontWeight = 'bold';
            });

            const rankRow = tfoot.insertRow();
            rankRow.innerHTML = `<th class="technical-requirements" colspan="2">Rank</th>`;

            technicalRequirements.forEach(tr => {
                const cell = rankRow.insertCell();
                cell.id = `rank_${tr.id}`;
                cell.style.fontWeight = 'bold';
            });

            container.innerHTML = '';
            container.appendChild(table);
        }

        // Calcular prioridades
        function calculatePriorities() {
            const priorityTableBody = document.querySelector('#priorityTable tbody');
            const techScores = calculatePrioritiesForExport();

            if (techScores.length === 0) {
                priorityTableBody.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 2rem; color: #777;">
                            <i class="fas fa-chart-bar" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <p>Priority rankings will appear here after generating the House of Quality matrix.</p>
                        </td>
                    </tr>
                `;
                return;
            }

            const maxScore = Math.max(...techScores.map(t => t.score), 1);

            priorityTableBody.innerHTML = techScores.map(tech => `
                <tr>
                    <td>${tech.text}</td>
                    <td><strong>${tech.score}</strong></td>
                    <td>
                        <div class="priority-bar-container">
                            <div class="priority-bar" style="width: ${(tech.score / maxScore) * 100}%;"></div>
                        </div>
                    </td>
                    <td><span style="background-color: ${getRankColor(tech.rank)}; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-weight: bold;">${tech.rank}</span></td>
                </tr>
            `).join('');

            // Actualizar celdas en la matriz
            techScores.forEach(tech => {
                const priorityCell = document.getElementById(`priority_${tech.id}`);
                const rankCell = document.getElementById(`rank_${tech.id}`);

                if (priorityCell) priorityCell.textContent = tech.score;
                if (rankCell) rankCell.textContent = tech.rank;
            });
        }

        // Función auxiliar para obtener color según ranking
        function getRankColor(rank) {
            const colors = [
                '#e74c3c', // Rojo para rank 1
                '#f39c12', // Naranja para rank 2
                '#3498db', // Azul para rank 3
                '#2ecc71', // Verde para rank 4
                '#9b59b6', // Púrpura para rank 5
            ];
            return colors[Math.min(rank - 1, colors.length - 1)] || '#7f8c8d';
        }

        // Resetear todo
        function resetAll() {
            if (confirm("Are you sure you want to reset all data? This will delete all customer requirements, technical specifications, relationships, and correlations.")) {
                customerRequirements = [];
                technicalRequirements = [];
                relationships = {};
                correlations = {};

                renderCustomerRequirements();
                renderTechnicalSpecs();
                updateRelationshipControls();
                updateCorrelationControls();

                document.getElementById('qfdMatrix').style.display = 'none';
                document.querySelector('#priorityTable tbody').innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 2rem; color: #777;">
                            <i class="fas fa-chart-bar" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <p>Priority rankings will appear here after generating the House of Quality matrix.</p>
                        </td>
                    </tr>
                `;

                showToast('All data has been reset.', 'info');
            }
        }

        // Cargar ejemplo
        function loadExample() {
            customerRequirements = [
                { id: 'cr_1', text: "Easy to use", importance: 5 },
                { id: 'cr_2', text: "Durable and long-lasting", importance: 4 },
                { id: 'cr_3', text: "Lightweight and portable", importance: 3 },
                { id: 'cr_4', text: "Affordable price", importance: 4 },
                { id: 'cr_5', text: "Fast performance", importance: 5 },
                { id: 'cr_6', text: "Aesthetically pleasing design", importance: 3 }
            ];

            technicalRequirements = [
                { id: 'tr_1', text: "Weight (grams)" },
                { id: 'tr_2', text: "Material thickness (mm)" },
                { id: 'tr_3', text: "Number of components" },
                { id: 'tr_4', text: "Manufacturing cost ($)" },
                { id: 'tr_5', text: "Processing speed (GHz)" },
                { id: 'tr_6', text: "Surface finish quality" }
            ];

            relationships = {
                "cr_1_tr_3": "strong",
                "cr_1_tr_5": "medium",
                "cr_2_tr_2": "strong",
                "cr_2_tr_6": "medium",
                "cr_3_tr_1": "strong",
                "cr_3_tr_3": "medium",
                "cr_4_tr_4": "strong",
                "cr_4_tr_3": "weak",
                "cr_5_tr_5": "strong",
                "cr_5_tr_3": "weak",
                "cr_6_tr_6": "strong",
                "cr_6_tr_1": "weak"
            };

            correlations = {
                "tr_1_tr_4": "positive-strong",
                "tr_2_tr_4": "positive-weak",
                "tr_1_tr_3": "negative-strong",
                "tr_5_tr_4": "positive-strong",
                "tr_6_tr_4": "positive-weak"
            };

            renderCustomerRequirements();
            renderTechnicalSpecs();
            updateRelationshipControls();
            updateCorrelationControls();

            showToast('Example data loaded successfully! You can now generate the House of Quality matrix.', 'success');
            switchInputTab('customer-needs');
        }

        // Exportar a Excel
        function exportToExcel() {
            const finalTable = document.getElementById('qfdFinalTable');
            if (!finalTable) {
                showToast('Please generate the House of Quality matrix first.', 'info');
                switchQfdTab('tab-input');
                return;
            }

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.table_to_sheet(finalTable);
            ws['!cols'] = [{ wch: 30 }, { wch: 10 }].concat(technicalRequirements.map(() => ({ wch: 15 })));
            XLSX.utils.book_append_sheet(wb, ws, 'QFD Matrix');

            const priorityData = [["Technical Requirement", "Priority Score", "Rank"]];
            const techScores = calculatePrioritiesForExport();
            techScores.forEach(t => priorityData.push([t.text, t.score, t.rank]));

            const ws_priority = XLSX.utils.aoa_to_sheet(priorityData);
            ws_priority['!cols'] = [{ wch: 30 }, { wch: 15 }, { wch: 10 }];
            XLSX.utils.book_append_sheet(wb, ws_priority, 'Priorities');

            XLSX.writeFile(wb, `QFD_Analysis_${new Date().toISOString().slice(0, 10)}.xlsx`);
            showToast('Excel file exported successfully!', 'success');
        }

        // Calcular prioridades para exportación
        function calculatePrioritiesForExport() {
            const relValues = { strong: 9, medium: 3, weak: 1 };

            const techScores = technicalRequirements.map(tr => {
                const score = customerRequirements.reduce((sum, cr) => {
                    const relValue = relValues[relationships[`${cr.id}_${tr.id}`]] || 0;
                    return sum + (cr.importance * relValue);
                }, 0);

                return {
                    id: tr.id,
                    text: tr.text,
                    score: score
                };
            }).sort((a, b) => b.score - a.score);

            let rank = 0;
            let lastScore = -1;
            techScores.forEach((tech, i) => {
                if (tech.score !== lastScore) {
                    rank = i + 1;
                    lastScore = tech.score;
                }
                tech.rank = rank;
            });

            return techScores;
        }

        // Mostrar notificación toast
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast-notification');
            toast.textContent = message;
            toast.className = 'show ' + type;

            setTimeout(() => {
                toast.className = toast.className.replace('show', '');
            }, 3000);
        }
    </script>

    <script defer>
        document.addEventListener('DOMContentLoaded', () => {
            // --- CÓDIGO DEL SONIDO DE HOVER ---
            const hoverSound = new Audio('data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABgAZGF0YQQAAAAAAAC/AAABAAAA//8AAnIseAABAHwAAU5/AABXfgAAS34AAEd+AABJfgAATX4AAFV+AABXfgAAVH4AAFN+AABTfgAAS34AAE9+AABVfgAAUX4AAEN+AABAfQAAP30AAD59AAA/fQAAQ30AAEd9AABLfQAAUn0AAGB9AABsfQAAe30AAH59AACAfQAAf30AAHx9AAB1fQAAcX0AAHN9AAB1fQAAdX0AAHJ9AABxPQAAeD4AAHc/AAB2PwAAcj8AAHI/AABxPwAAcT8AAHE/AABwPwAAcD8AAHA/AABvPwAAcD8AAHA/AABvPwAAaz0AAG4/AABsPwAAZj8AAGQ/AABiPwAAZD8AAGI/AABhPwAAYT8AAGI/AABiPwAAYT8AAGM/AABlPwAAaD8AAGs/AABuPwAAbj8AAG0/AABsPwAAbD8AAGs/AABoPwAAZD8AAGM/AABkPwAAZz8AAGg/AABrPwAAbT8AAHA/AABzPwAAcz8AAHM/AABzPwAAcT8AAHE/AABxPwAAcD8AAHA/AABwPwAAbj8AAGs/AABpPwAAaD8AAGc/AABhPwAAYD8AAF8/AABePwAAXT8AAFw/AABbPwAAWj8AAFk/AABYPwAAWj8AAFk/AABZPwAAWT8AAFk/AABYPwAAVT8AAFI/AABPPwAATD8AAEk/AABGPwAAQz8AAEA/AAA+PwAAO/8AADf8AAA1/AAANfwAADX8AAA1/AAANfwAADX8AAA2/AAAN/wAADf8AAA3/AAAN/wAADf8AAA3/AAAN/wAADf8AAA4/AAAOPwAADj8AAA4/AAAOPwAADj8AAA4/AAAN/wAADf8AAA3/AAAN/wAADf8AAA3/AAAN/wAADf8AAA3/AAAN/wAADf8AAA3/AAAN/wAADf8AAA3/AA');
            hoverSound.preload = 'auto';
            let audioUnlocked = false;

            function unlockAudio() {
                if (audioUnlocked) return;
                hoverSound.volume = 0;
                hoverSound.play().then(() => {
                    hoverSound.pause();
                    hoverSound.currentTime = 0;
                    hoverSound.volume = 1;
                    audioUnlocked = true;
                    document.removeEventListener('click', unlockAudio);
                    document.removeEventListener('touchstart', unlockAudio);
                }).catch(e => { });
            }

            document.addEventListener('click', unlockAudio);
            document.addEventListener('touchstart', unlockAudio);

            const featureCards = document.querySelectorAll('.feature-card');
            featureCards.forEach(card => {
                card.addEventListener('mouseenter', () => {
                    if (audioUnlocked) {
                        hoverSound.currentTime = 0;
                        hoverSound.play().catch(e => { });
                    }
                });
            });
        });
    </script>
</body>

</html>