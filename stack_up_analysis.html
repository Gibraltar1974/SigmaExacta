<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Free online calculator for Tolerance Stack-Up Analysis for Mechancial Assemblies. Optimize mechanical designs with worst-case, Root Sum Square (RSS), and Monte Carlo simulation methods. No limitations in the number of dimensions.">
    <meta name="keywords"
        content="open source, free software, tolerance analysis, tolerance stack-up, stackup, dimension chain, worst-case method, RSS method, tolerance calculation, Monte Carlo simulation, GD&T, mechanical design, engineering, Sigma Exacta, statistical distributions, normal distribution, homogeneous distribution, weibull distribution, lognormal distribution, exponential distribution ">
    <title>Tolerance Stack-Up Analysis Calculator | Free Online Tool | Sigma Exacta</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="stack_up_analysis.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">
    <!-- Añadir esto en la sección head después de los otros enlaces -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
        integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
        integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8"
        crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
        integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>

    <style>
        /* ===== ESTILOS DEL SISTEMA DE PESTAÑAS (WIZARD) TIPO TRIZ ===== */
        /* Se usan nombres de clases específicos para no chocar con los estilos existentes */

        :root {
            --primary-color: #2c3e50;
            --secondary-color: #5856d6;
            --performance-color: #2ecc71;
            --danger-color: #c0392b;
            --attractive-color: #3498db;
            --must-be-color: #f1c40f;
            --reverse-color: #9b59b6;
            --indifferent-color: #95a5a6;
            --questionable-color: #e74c3c;
            --light-color: #ecf0f1;
        }

        /* ===== ESTILOS PARA ANCHO COMPLETO ===== */
        /* Asegurar que body y html ocupen el 100% del ancho */
        html,
        body {
            width: 100%;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            /* Prevenir scroll horizontal no deseado */
        }

        /* Modificar el contenedor principal para ocupar ancho completo */
        .main-content-wrapper {
            width: 100%;
            max-width: 100%;
            margin: 0;
            padding: 0;
        }

        /* Asegurar que los contenedores internos no limiten el ancho */
        .container,
        .calculator-section,
        .tabcontent,
        .input-controls,
        .visualization-container {
            max-width: 100%;
            width: 100%;
        }

        /* Ajustar el canvas de visualización para ancho completo */
        #vectorCanvas {
            width: 100% !important;
            max-width: 100% !important;
        }

        /* Ajustar los resultados para mejor visualización en pantalla completa */
        .results {
            width: 100%;
            box-sizing: border-box;
        }

        /* --- BOTONES PRINCIPALES SOBRE LAS TABS --- */
        .main-action-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1.5rem auto;
            flex-wrap: wrap;
            max-width: 800px;
        }

        .main-action-buttons button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        .main-action-buttons .btn-example {
            background-color: var(--performance-color);
            color: white;
        }

        .main-action-buttons .btn-example:hover {
            background-color: #27ad60;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        .main-action-buttons .btn-reset {
            background-color: var(--danger-color);
            color: white;
        }

        .main-action-buttons .btn-reset:hover {
            background-color: #a5281c;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        .tabs-nav {
            display: flex;
            background-color: #f1f5f9;
            border-radius: 8px 8px 0 0;
            overflow-x: auto;
            border-bottom: 2px solid var(--secondary-color);
            margin-bottom: 0;
            margin-top: 0.5rem;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .tabs-nav::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 1rem 1.5rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 700;
            color: #64748b;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
        }

        @media (min-width: 992px) {
            .tabs-nav {
                overflow-x: hidden;
            }

            .tab-btn {
                flex: 1;
                justify-content: center;
                padding: 1rem 0.5rem;
            }
        }

        .tab-btn:hover {
            background-color: #e2e8f0;
            color: var(--primary-color);
        }

        .tab-btn.active {
            background-color: #fff;
            color: var(--secondary-color);
            border-bottom-color: var(--secondary-color);
            border-radius: 8px 8px 0 0;
            margin-bottom: -2px;
            border-left: 1px solid #e1e5e9;
            border-right: 1px solid #e1e5e9;
            border-top: 1px solid #e1e5e9;
        }

        /* Usamos 'wizard-tab-content' para diferenciarlo de 'tabcontent' interno de la calculadora */
        .wizard-tab-content {
            display: none;
            padding: 2rem;
            background: #fff;
            border: 1px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 8px 8px;
            animation: fadeIn 0.3s ease;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .wizard-tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tab-nav-buttons {
            display: flex;
            justify-content: flex-end;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
        }

        .btn-next-tab {
            background-color: var(--secondary-color);
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn-next-tab:hover {
            background-color: #4341a7;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .wizard-tab-content {
                padding: 1rem;
            }

            .main-action-buttons {
                gap: 0.75rem;
                margin: 1rem auto;
            }

            .main-action-buttons button {
                padding: 0.7rem 1.2rem;
                font-size: 0.9rem;
            }

            /* Mejorar la visualización en móviles */
            .main-header {
                padding: 1rem;
            }

            .container {
                padding: 1rem;
                margin: 0;
                border-radius: 0;
            }

            .wizard-tab-content {
                padding: 1rem;
            }

            .tabcontent {
                padding: 1rem;
            }
        }

        @media (max-width: 480px) {
            .main-action-buttons {
                flex-direction: column;
                align-items: stretch;
                gap: 0.5rem;
            }

            .main-action-buttons button {
                width: 100%;
                justify-content: center;
            }
        }

        /* Ajuste para que los containers dentro de las pestañas no tengan márgenes excesivos */
        .wizard-tab-content .container {
            margin-top: 0;
            margin-bottom: 2rem;
            box-shadow: none;
            padding: 0;
            border: none;
        }

        /* CORRECCIÓN: Estilos para que las fórmulas se vean correctamente */
        .formula-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .formula-item {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            border-left: 4px solid var(--secondary-color);
        }

        .formula-item h3 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .formula-item div {
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .formula-item p {
            margin: 0.5rem 0;
            color: #666;
            font-size: 0.9rem;
        }

        .triangular-formula div {
            font-size: 0.85rem;
            line-height: 1.4;
        }

        /* Estilos para KaTeX */
        .katex {
            font-size: 1.1em !important;
        }

        .katex-display {
            margin: 1em 0 !important;
            overflow: auto hidden;
        }

        .katex-display>.katex {
            max-width: 100%;
            overflow-x: auto;
            overflow-y: hidden;
        }

        .legend {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .legend h3 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 1rem;
        }

        .legend ul {
            margin: 0;
            padding-left: 1.25rem;
            color: #555;
        }

        .legend li {
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }

        code {
            background-color: #e9ecef;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
    </style>
</head>

<body>
    <!-- Header container donde se cargará dinámicamente el header -->
    <div id="header-container"></div>

    <noscript>
        <nav>
            <a href="/">Home</a> |
            <a href="/8d">8D Tool</a> |
            <a href="/taguchi_doe">Taguchi DOE</a> |
            <a href="/swot">SWOT Analysis</a> |
            <a href="/balancedcard">Balanced Scorecard</a> |
            <a href="/qfd">QFD</a> |
            <a href="/apqp-ppap">APQP/PPAP</a> |
            <a href="/ishikawa">Ishikawa</a> |
            <a href="/fmea">FMEA</a> |
            <a href="/vave">VAVE</a> |
            <a href="/eisenhower">Eisenhower Matrix</a> |
            <a href="/triz">TRIZ</a> |
            <a href="/weibull">Weibull</a> |
            <a href="/stack_up_analysis">Tolerance Stack-Up</a> |
            <a href="/pdca">PDCA</a> |
            <a href="/design_thinking">Design Thinking</a> |
            <a href="/pugh">Pugh Matrix</a> |
            <a href="/cpk_calculator">CpK Calculator</a> |
            <a href="/control-plan">Control Plan</a>
        </nav>
    </noscript>

    <main class="main-content-wrapper" style="width: 100%; max-width: 100%; padding: 0; margin: 0;">
        <header class="main-header">
            <h1><span
                    style="display: inline-flex; justify-content: center; align-items: center; width: 42px; height: 42px; background-color: #5856d6; border-radius: 8px; margin-right: 12px; vertical-align: middle;"><i
                        class="fas fa-ruler-combined" style="color: white; font-size: 22px;"></i></span> Free Online
                Tolerance Stack-Up Analysis Calculator</h1>
            <p>Perform tolerance stack-up analysis using arithmetic, probabilistic, and Monte Carlo methods.</p>

            <!-- BOTONES PRINCIPALES -->
            <div class="main-action-buttons">
                <button id="globalLoadExampleBtn" class="btn-example">
                    <i class="fas fa-vial"></i> Load Example
                </button>
                <button id="globalResetBtn" class="btn-reset">
                    <i class="fas fa-sync-alt"></i> Reset All
                </button>
            </div>
        </header>

        <!-- NAVEGACIÓN DE PESTAÑAS (WIZARD) -->
        <nav class="tabs-nav">
            <button class="tab-btn active" onclick="switchWizardTab('tab-theory')"><i class="fas fa-book"></i> Theory &
                Info</button>
            <button class="tab-btn" onclick="switchWizardTab('tab-tool')"><i class="fas fa-calculator"></i> Calculator
                Tool</button>
            <button class="tab-btn" onclick="switchWizardTab('tab-results')"><i class="fas fa-chart-bar"></i>
                Results</button>
            <button class="tab-btn" onclick="switchWizardTab('tab-formulas')"><i class="fas fa-square-root-alt"></i>
                Formulas</button>
        </nav>

        <!-- PESTAÑA 1: TEORÍA -->
        <div id="tab-theory" class="wizard-tab-content active">
            <section class="container" style="width: 100%; max-width: 100%; margin: 0; border-radius: 0;">
                <h2><i class="fas fa-question-circle"></i> What is Tolerance Stack-Up Analysis?</h2>
                <p>Tolerance stack-up analysis is a fundamental process in mechanical design used to study the
                    accumulation
                    of variation in an assembly. Each component of a product has dimensional tolerances (a permitted
                    variation in its size). This analysis calculates the combined effect of these tolerances to predict
                    the
                    final dimensional variation of the assembly, ensuring that parts fit together correctly and the
                    product
                    functions as intended. A tolerance stack-up analysis allows to assess the effect of geometrical
                    errors
                    before manufacturing. Consequently, any defects can be easily fixed at a very low cost and in a
                    short
                    time.</p>
            </section>

            <section class="container" style="width: 100%; max-width: 100%; margin: 0; border-radius: 0;">
                <h2><i class="fas fa-history"></i> Brief History</h2>
                <p>The concept of interchangeable parts dates back to the Industrial Revolution, but the systematic
                    analysis
                    of their accumulation gained momentum in the 20th century, especially with the rise of mass
                    production.
                    The need to predict and control variation became critical. Walter A. Shewhart's work in the 1920s on
                    <strong>Statistical Process Control (SPC)</strong> laid the groundwork for probabilistic methods.
                    Later,
                    the development and standardization of <strong>Geometric Dimensioning and Tolerancing
                        (GD&T)</strong>
                    provided a precise language for defining tolerances, making analyses more robust and reliable.
                </p>
            </section>

            <section class="container" style="width: 100%; max-width: 100%; margin: 0; border-radius: 0;">
                <h2><i class="fas fa-cogs"></i> How This Tool Works (Methods)</h2>
                <p>This tool performs tolerance stack-up analysis using two primary methodologies: Arithmetic and
                    Statistical. The Statistical method is dynamically chosen between the classic Root Sum Square (RSS)
                    method or a Monte Carlo simulation based on the distribution types you select for the components.
                </p>

                <h4><strong>1. Arithmetic Method (Worst-Case)</strong></h4>
                <p>This is the simplest and most conservative method, assuming a <strong>uniform distribution</strong>
                    for
                    all components. It calculates the absolute maximum and minimum possible assembly dimensions by
                    summing
                    all component tolerances at their most unfavorable condition. The worst-case method requires
                    inspection
                    of each part. It is suitable for low volume very high value products, such as jet engines.</p>
                <ul>
                    <li><strong>Advantage:</strong> Guarantees that 100% of assemblies will meet specifications.</li>
                    <li><strong>Disadvantage:</strong> Leads to the tightest, most expensive component tolerances, as
                        the
                        "worst-case" is statistically unlikely.</li>
                </ul>

                <h4><strong>2. Statistical Method (RSS or Monte Carlo Simulation)</strong></h4>
                <p>This method uses component distribution types to predict a more realistic variation range for the
                    assembly. This method assumes that the machine or process is working in their specifications limit
                    (the
                    machine work according to its manufacturer specifications, no shift or abnormal conditions when
                    making
                    parts). The calculation method is chosen as follows:</p>
                <ul>
                    <li>If <strong>all components</strong> are set to a <strong>Normal</strong> distribution, the method
                        defaults to the highly efficient <strong>Root Sum of Squares (RSS)</strong>. RSS statistically
                        sums
                        tolerances, assuming deviations in one direction are offset by deviations in the other.</li>
                    <li>If <strong>any component</strong> is set to a <strong>non-Normal</strong> distribution (Weibull,
                        Triangular, Homogeneous, Lognormal, Beta, or Exponential), the tool automatically switches to a
                        <strong>Monte Carlo Simulation</strong>. This uses computational power to simulate the assembly
                        thousands of times, generating a complete statistical distribution of the possible assembly
                        outcomes.
                    </li>
                    <li>This tool calculates the standard deviation (σ) based on your input (Tolerance, σ value, or
                        C<sub>pk</sub>) to define the process spread for each component.</li>
                </ul>

                <h4><strong>3. Component Distributions & Manufacturing Relevance</strong></h4>
                <p>Selecting the correct distribution is crucial for accurate analysis, as it models how a process
                    actually
                    performs:</p>

                <div class="dist-info-grid">
                    <div class="dist-info-card">
                        <h5><strong>Normal (Gaussian)</strong></h5>
                        <p>The standard model for most <strong>well-controlled processes</strong> (e.g., CNC machining,
                            turning). It assumes variation is the sum of many small, independent errors, resulting in a
                            symmetrical, bell-shaped curve centered on the nominal mean. <strong>Relevance:</strong>
                            Used
                            when the manufacturing process is stable and capable (in statistical control).</p>
                    </div>
                    <div class="dist-info-card">
                        <h5><strong>Homogeneous (Uniform)</strong></h5>
                        <p>Assumes that every value within the tolerance range has an <strong>equal probability</strong>
                            of
                            occurring. <strong>Relevance:</strong> Highly conservative. Often used to model purchased
                            components that are checked only at the boundary limits (Go/No-Go gauging), or where process
                            data is unavailable, leading to a worst-case risk assessment.</p>
                    </div>
                    <div class="dist-info-card">
                        <h5><strong>Triangular</strong></h5>
                        <p>Assumes that the <strong>nominal target (mode) is the most probable</strong> value, with
                            probability decreasing linearly towards the minimum (A) and maximum (B) limits.
                            <strong>Relevance:</strong> Common when operators try to manually center the process, or
                            when
                            stacking two independent uniform distributions (e.g., a short assembly chain).
                        </p>
                    </div>
                    <div class="dist-info-card">
                        <h5><strong>Weibull</strong></h5>
                        <p>A flexible distribution defined by shape (β), scale (η), and often a location (γ) parameter.
                            While commonly used for reliability/life analysis, it models dimensional distributions that
                            are
                            <strong>skewed</strong> or non-symmetrical, often near a process boundary or for materials
                            with
                            inherent non-linear variation. <strong>Relevance:</strong> Useful for modeling wear,
                            grinding
                            processes, or thin film deposition where variation might be heavily skewed.
                        </p>
                    </div>
                    <div class="dist-info-card">
                        <h5><strong>Lognormal</strong></h5>
                        <p>A distribution where the logarithm of the variable follows a normal distribution, resulting
                            in a
                            <strong>right-skewed</strong> shape. Values cannot be negative, making it ideal for strictly
                            positive dimensions when shifted with a location parameter. <strong>Relevance:</strong>
                            Common
                            in processes with <strong>multiplicative errors</strong> such as coating thickness, particle
                            size in powder metallurgy, electroplating depth, or chemical vapor deposition. Also models
                            fatigue life and material strength properties.
                        </p>
                    </div>
                    <div class="dist-info-card">
                        <h5><strong>Beta</strong></h5>
                        <p>A highly flexible distribution bounded between a minimum and maximum, defined by shape
                            parameters
                            (α, β). Can model symmetric, left-skewed, right-skewed, or U-shaped distributions.
                            <strong>Relevance:</strong> Useful for <strong>bounded processes</strong> with known
                            physical
                            limits, such as percentage-based measurements (e.g., material composition, hardness
                            indices),
                            surface finish within specification limits, or when expert judgment suggests variation is
                            not
                            normally distributed but constrained.
                        </p>
                    </div>
                    <div class="dist-info-card">
                        <h5><strong>Exponential</strong></h5>
                        <p>Models the time or distance between independent events occurring at a constant average rate,
                            characterized by a <strong>memoryless property</strong> and strong right skew. Needs a
                            location
                            parameter for dimensional analysis. <strong>Relevance:</strong> Primarily used in
                            reliability
                            engineering for modeling <strong>failure rates</strong> or time-to-failure for components
                            with
                            constant hazard rates. In dimensional analysis, it can represent the distribution of defect
                            spacing, inter-arrival times in production lines, or processes where most values cluster
                            near a
                            minimum value with a long tail.</p>
                    </div>
                </div>
            </section>

            <div class="tab-nav-buttons">
                <button class="btn-next-tab" onclick="switchWizardTab('tab-tool')">Go to Calculator <i
                        class="fas fa-arrow-right"></i></button>
            </div>
        </div>

        <!-- PESTAÑA 2: HERRAMIENTA CALCULADORA -->
        <div id="tab-tool" class="wizard-tab-content">
            <div class="calculator-section" style="box-shadow: none; margin: 0; width: 100%; max-width: 100%;">
                <div class="tab">
                    <button class="tablinks active" onclick="openTab(event, 'input')"><i class="fas fa-edit"></i> Input
                        Data</button>
                    <button class="tablinks" onclick="openTab(event, 'analysis-results')" id="resultsTab"><i
                            class="fas fa-chart-line"></i> Analysis Results</button>
                    <button class="tablinks" onclick="openTab(event, 'visualization')"><i
                            class="fas fa-project-diagram"></i> Stack-up Visualization</button>
                </div>

                <div id="input" class="tabcontent" style="display: block;">
                    <div class="input-controls">
                        <h3><i class="fas fa-ruler-combined"></i> Dimensions</h3>
                        <div id="dimensions-container">
                            <div class="empty-state">
                                <i class="fas fa-inbox"></i>
                                <p>No dimensions added yet</p>
                                <p style="font-size: 0.9rem;">Click "Add Dimension" below to start building your
                                    tolerance
                                    stack-up analysis</p>
                            </div>
                        </div>
                        <div class="add-remove-btns">
                            <button onclick="addDimension()"><i class="fas fa-plus"></i> Add Dimension</button>
                        </div>
                        <div class="montecarlo-input">
                            <label for="sampleSize"><i class="fas fa-chart-pie"></i> Monte Carlo sample size:</label>
                            <input type="number" id="sampleSize" value="10000" min="1000" max="1000000">
                        </div>
                        <button onclick="calculate()"><i class="fas fa-calculator"></i> Calculate</button>
                    </div>
                </div>

                <div id="analysis-results" class="tabcontent">
                    <h3><i class="fas fa-chart-line"></i> Analysis Results</h3>
                    <div class="results">
                        <div class="result-method">
                            <h4><i class="fas fa-calculator"></i> Arithmetic Method (Worst-Case)</h4>
                            <p>Nominal value: <span id="arithmetic-nominal" class="badge badge-primary">-</span></p>
                            <p>Tolerance: <span id="arithmetic-tolerance" class="badge badge-primary">-</span></p>
                            <p>Maximum: <span id="arithmetic-max" class="badge badge-primary">-</span></p>
                            <p>Minimum: <span id="arithmetic-min" class="badge badge-primary">-</span></p>
                        </div>
                        <div class="result-method" id="rss-results">
                            <h4><i class="fas fa-chart-bar"></i> Probabilistic Method (RSS)</h4>
                            <p>Nominal value: <span id="probabilistic-nominal" class="badge badge-primary">-</span></p>
                            <p>Standard deviation: <span id="probabilistic-stddev" class="badge badge-primary">-</span>
                            </p>
                            <p>Tolerance: <span id="probabilistic-tolerance" class="badge badge-primary">-</span></p>
                            <p>Maximum: <span id="probabilistic-max" class="badge badge-primary">-</span></p>
                            <p>Minimum: <span id="probabilistic-min" class="badge badge-primary">-</span></p>
                        </div>
                        <div id="montecarlo-results" class="result-method">
                            <div class="montecarlo-data">
                                <h4><i class="fas fa-random"></i> Monte Carlo Results</h4>
                                <p>Nominal value: <span id="montecarlo-nominal" class="badge badge-primary">-</span></p>
                                <p>Standard deviation: <span id="montecarlo-stddev" class="badge badge-primary">-</span>
                                </p>
                                <p>Tolerance: <span id="montecarlo-tolerance" class="badge badge-primary">-</span></p>
                                <p>Maximum: <span id="montecarlo-max" class="badge badge-primary">-</span></p>
                                <p>Minimum: <span id="montecarlo-min" class="badge badge-primary">-</span></p>
                            </div>
                            <div class="montecarlo-chart-container">
                                <canvas id="distributionChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="visualization" class="tabcontent">
                    <h3><i class="fas fa-project-diagram"></i> Stack-up Visualization</h3>
                    <div class="visualization-container">
                        <div class="vis-controls">
                            <label>Orientation:</label>
                            <button id="vis-horizontal-btn" class="vis-toggle active"
                                onclick="setVectorOrientation('horizontal')">Horizontal</button>
                            <button id="vis-vertical-btn" class="vis-toggle"
                                onclick="setVectorOrientation('vertical')">Vertical</button>
                        </div>
                        <canvas id="vectorCanvas"></canvas>
                    </div>
                </div>
            </div>

            <div class="tab-nav-buttons">
                <button class="btn-next-tab" onclick="switchWizardTab('tab-results')">View Detailed Results <i
                        class="fas fa-arrow-right"></i></button>
            </div>
        </div>

        <!-- NUEVA PESTAÑA 3: RESULTS -->
        <div id="tab-results" class="wizard-tab-content">
            <section class="container" style="width: 100%; max-width: 100%; margin: 0; border-radius: 0;">
                <h2><i class="fas fa-chart-bar"></i> Detailed Results</h2>
                <p>View and export detailed calculation results and history.</p>

                <div class="export-section" style="margin: 2rem 0;">
                    <button onclick="listResults()"><i class="fas fa-list"></i> List Results</button>
                    <button onclick="exportToExcel()"><i class="fas fa-file-excel"></i> Export to Excel</button>
                </div>

                <div id="results-history" style="display: none; margin-top: 2rem;"></div>
            </section>
        </div>

        <!-- PESTAÑA 4: FÓRMULAS -->
        <div id="tab-formulas" class="wizard-tab-content">
            <section class="container" style="width: 100%; max-width: 100%; margin: 0; border-radius: 0;">
                <h2><i class="fas fa-calculator"></i> Mathematical Formulas</h2>
                <div class="formula-grid">
                    <div class="formula-item">
                        <h3>Normal Distribution</h3>
                        <div>$$ Z = \sqrt{-2 \ln U} \cdot \cos(2\pi V) $$</div>
                        <div>$$ X = \mu + \sigma \cdot Z $$</div>
                    </div>
                    <div class="formula-item">
                        <h3>Uniform Distribution</h3>
                        <div>$$ X = A + (B - A) \cdot U $$</div>
                        <p>where \( U \sim \text{Uniform}(0,1) \)</p>
                    </div>
                    <!-- Reemplazar el item triangular existente con esta versión mejorada -->
                    <div class="formula-item triangular-formula">
                        <h3>Triangular Distribution</h3>
                        <div>$$ F_c = \frac{C - A}{B - A} $$</div>
                        <div style="font-size: 0.9em;">
                            $$ X = \begin{cases}
                            A + \sqrt{U \cdot (B - A) \cdot (C - A)} & \text{if } U < F_c \\ B - \sqrt{(1 - U) \cdot (B
                                - A) \cdot (B - C)} & \text{if } U \geq F_c \end{cases} $$ </div>
                        </div>
                        <div class="formula-item">
                            <h3>Weibull Distribution</h3>
                            <div>$$ X = \gamma + \eta \cdot \left[-\ln(1 - U)\right]^{1/\beta} $$</div>
                        </div>
                        <div class="formula-item">
                            <h3>Lognormal Distribution</h3>
                            <div>$$ X = \gamma + \exp(\mu + \sigma \cdot Z) $$</div>
                            <p>where \( Z \sim N(0,1) \)</p>
                        </div>
                        <div class="formula-item">
                            <h3>Beta Distribution</h3>
                            <div>$$ X = A + (B - A) \cdot Y $$</div>
                            <p>where \( Y \sim \text{Beta}(\alpha,\beta) \)</p>
                        </div>
                        <div class="formula-item">
                            <h3>Exponential Distribution</h3>
                            <div>$$ X = \gamma - \frac{\ln(1 - U)}{\lambda} $$</div>
                        </div>
                        <div class="formula-item">
                            <h3>Arithmetic Method (Worst-Case)</h3>
                            <div>$$ \text{Nominal} = \sum_{i=1}^{n} \text{sign}_i \cdot \text{nominal}_i $$</div>
                            <div>$$ T_{\text{total}}^{+} = \sum_{i=1}^{n} T_i^{+} $$</div>
                            <div>$$ T_{\text{total}}^{-} = \sum_{i=1}^{n} T_i^{-} $$</div>
                        </div>
                        <div class="formula-item">
                            <h3>Probabilistic Method (RSS)</h3>
                            <div>$$ \sigma_{\text{total}} = \sqrt{\sum_{i=1}^{n} \sigma_i^2} $$</div>
                            <div>$$ T_{\text{total}} = 3 \cdot \sigma_{\text{total}} $$</div>
                        </div>
                        <div class="formula-item">
                            <h3>Monte Carlo Method</h3>
                            <div>$$ S_j = \sum_{i=1}^{n} \text{sign}_i \cdot x_{ij} $$</div>
                            <div>$$ \mu_{\text{MC}} = \frac{1}{N} \sum_{j=1}^{N} S_j $$</div>
                            <div>$$ \sigma_{\text{MC}} = \sqrt{\frac{1}{N-1} \sum_{j=1}^{N} (S_j - \mu_{\text{MC}})^2}
                                $$</div>
                        </div>
                    </div>
                    <div class="legend">
                        <h3>Symbol Legend</h3>
                        <ul>
                            <li><code>U, V</code>: Uniform(0,1) random variables</li>
                            <li><code>Z</code>: Standard normal random variable</li>
                            <li><code>X</code>: Random variable for dimension</li>
                            <li><code>μ, σ</code>: Mean and standard deviation</li>
                            <li><code>A, B, C</code>: Parameters for distributions (min, max, mode)</li>
                            <li><code>β, η, γ</code>: Weibull parameters (shape, scale, location)</li>
                            <li><code>α, β</code>: Beta distribution shape parameters</li>
                            <li><code>λ</code>: Exponential distribution rate parameter</li>
                            <li><code>T<sub>i</sub><sup>+</sup>, T<sub>i</sub><sup>-</sup></code>: Plus and minus
                                tolerances for
                                dimension i</li>
                            <li><code>σ<sub>i</sub></code>: Standard deviation for dimension i</li>
                            <li><code>N</code>: Number of Monte Carlo samples</li>
                            <li><code>S<sub>j</sub></code>: j-th Monte Carlo sample of the stack</li>
                        </ul>
                    </div>
            </section>
        </div>
    </main>

    <footer style="width: 100%; margin: 0; padding: 0;">
        <div class="disclaimer-note">
            <p><strong>Disclaimer:</strong> The tools and information provided on Sigma Exacta are for informational and
                educational purposes only. This tool is based on established engineering methodologies for tolerance
                analysis (e.g., Worst-Case, Root Sum Square, and Monte Carlo simulation). The tools on this site are
                independent implementations for educational use. While we strive for accuracy, we make no warranty or
                guarantee regarding the results. All calculations, engineering decisions, and designs based on the
                output of this tool are the sole responsibility of the user. Sigma Exacta and its creators are not
                liable for any damages, losses, or product failures resulting from the use of this website.</p>
        </div>
    </footer>

    <!-- Script para cargar el header dinámicamente -->
    <script>
        // Cargar el header dinámicamente
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-container').innerHTML = data;
                // Inicializar el menú después de cargar el header
                initializeMenu();
            })
            .catch(error => console.error('Error loading header:', error));

        // Función para inicializar el menú desplegable
        function initializeMenu() {
            const navToggle = document.getElementById('nav-toggle');
            const navMenu = document.getElementById('nav-menu');
            const toolsDropdownToggle = document.getElementById('tools-dropdown-toggle');
            const toolsDropdownMenu = document.getElementById('tools-dropdown-menu');
            const toolsDropdownContainer = document.getElementById('tools-dropdown-container');

            if (navToggle && navMenu) {
                navToggle.addEventListener('click', () => {
                    navMenu.classList.toggle('show-menu');
                    const icon = navToggle.querySelector('i');
                    icon.classList.toggle('fa-bars');
                    icon.classList.toggle('fa-times');

                    if (!navMenu.classList.contains('show-menu')) {
                        toolsDropdownMenu.classList.remove('show-submenu');
                        toolsDropdownContainer.classList.remove('active');
                    }
                });
            }

            if (toolsDropdownToggle && toolsDropdownMenu) {
                toolsDropdownToggle.addEventListener('click', (event) => {
                    if (window.innerWidth <= 992) {
                        event.preventDefault();
                        toolsDropdownMenu.classList.toggle('show-submenu');
                        toolsDropdownContainer.classList.toggle('active');
                    }
                });
            }
        }

        // ===== LÓGICA DE PESTAÑAS WIZARD =====
        function switchWizardTab(tabId) {
            // Quitar clase active de todos los botones y contenidos de wizard
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.wizard-tab-content').forEach(content => content.classList.remove('active'));

            // Activar el contenido seleccionado
            document.getElementById(tabId).classList.add('active');

            // Activar botón correspondiente
            const activeBtn = document.querySelector(`button[onclick="switchWizardTab('${tabId}')"]`);
            if (activeBtn) activeBtn.classList.add('active');

            // Scroll al top suavemente
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Event listeners para los botones globales
        document.addEventListener('DOMContentLoaded', function () {
            // Botón global de Load Example
            document.getElementById('globalLoadExampleBtn').addEventListener('click', function () {
                loadExampleData();
                // Cambiar a la pestaña del calculator tool
                switchWizardTab('tab-tool');
            });

            // Botón global de Reset All
            document.getElementById('globalResetBtn').addEventListener('click', function () {
                if (confirm("Are you sure you want to reset all data? This will remove all dimensions.")) {
                    resetData();
                }
            });
        });

        // Función para sub-tabs dentro de Calculator Tool
        function openTab(evt, tabName) {
            // Ocultar todos los tabcontent
            document.querySelectorAll(".tabcontent").forEach(el => el.style.display = "none");
            // Remover clase active de todos los tablinks
            document.querySelectorAll(".tablinks").forEach(el => el.classList.remove("active"));
            // Mostrar el tab actual y agregar clase active al botón
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.classList.add("active");

            // Si es la pestaña de input, actualizar visualización
            if (tabName === 'input' || tabName === 'visualization') {
                updateVisualization();
            }
        }
    </script>

    <script src="stack_up_analysis.js"></script>

    <script src="dexie.min.js"></script>
    <script src="db-sigma.js"></script>

</body>

</html>