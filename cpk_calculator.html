<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Capability Index Calculator | Sigma Exacta</title>
    <meta name="description"
        content="Calculate Cp, Cpk, Pp & Ppk with our free Capability Index tool. This advanced calculator includes normality tests, distribution plots, and I-Charts for robust analysis.">
    <meta name="keywords"
        content="Open source, Free software, SigmaExacta, capability index calculator, cpk calculator, process capability, normality check, cp, cpk, cpm, pp, ppk, six sigma, spc tool, control chart, i-chart, lsl, usl, normal distribution plot, normality tests, Shapiro-Wilk, Anderson-Darling, Kolmogorov-Smirnov">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
        integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="sigma-exacta-icon.jpg" type="image/jpeg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">
    <link rel="canonical" href="https://sigmaexacta.com/cpk_calculator">

    <style>
        /* Estilos de la Página de la Calculadora */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            font-size: 16px;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f4f7f9;
            color: #333;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            width: 100vw;
            max-width: 100vw;
        }

        .main-content-wrapper {
            max-width: 100%;
            margin: 0 auto;
            padding: 1.25rem;
            width: 100%;
            box-sizing: border-box;
        }

        .main-header {
            text-align: center;
            padding: 1rem 0;
            margin-bottom: 1rem;
            border-bottom: 1px solid #ddd;
        }

        .main-header h1 {
            color: var(--primary-color);
            font-size: clamp(1.5rem, 4vw, 1.8rem);
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 800;
        }

        .main-header p {
            color: #7f8c8d;
            font-weight: 400;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
        }

        /* ===== BOTONES DE ACCIÓN GLOBAL ===== */
        .global-actions {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1.5rem 0 2rem 0;
            flex-wrap: wrap;
        }

        .global-btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        .global-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        }

        /* ESTILOS COMO EN KANO.HTML */
        .global-btn.secondary {
            background-color: #2ecc71;
            color: white;
        }

        .global-btn.secondary:hover {
            background-color: #27ad60;
        }

        .global-btn.danger {
            background-color: #c0392b;
            color: white;
        }

        .global-btn.danger:hover {
            background-color: #a5281c;
        }

        /* ===== ESTILOS DEL SISTEMA DE PESTAÑAS (WIZARD) ===== */
        .tabs-nav {
            display: flex;
            background-color: #f1f5f9;
            border-radius: 8px 8px 0 0;
            overflow-x: auto;
            border-bottom: 2px solid var(--secondary-color);
            margin-bottom: 0;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .tabs-nav::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 1rem 1.5rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 700;
            color: #64748b;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
        }

        @media (min-width: 992px) {
            .tabs-nav {
                overflow-x: hidden;
            }

            .tab-btn {
                flex: 1;
                justify-content: center;
                padding: 1rem 0.5rem;
            }
        }

        .tab-btn:hover {
            background-color: #e2e8f0;
            color: var(--primary-color);
        }

        .tab-btn.active {
            background-color: #fff;
            color: var(--secondary-color);
            border-bottom-color: var(--secondary-color);
            border-radius: 8px 8px 0 0;
            margin-bottom: -2px;
            border-left: 1px solid #e1e5e9;
            border-right: 1px solid #e1e5e9;
            border-top: 1px solid #e1e5e9;
        }

        /* CONTENEDOR PRINCIPAL DE TABS - FONDO BLANCO */
        .tabs-container {
            background: #fff;
            border: 1px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
            position: relative;
            margin-bottom: 2rem;
        }

        /* PESTAÑAS - Todas con el mismo ancho */
        .wizard-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        .wizard-tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* CONTENIDO DE TODAS LAS TABS - Mismo padding */
        .tab-content-wrapper {
            padding: 2rem;
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        /* Ajuste para pantallas móviles */
        @media (max-width: 768px) {
            .main-content-wrapper {
                padding: 0.75rem;
            }

            .tabs-container {
                margin: 0 -0.75rem;
                width: calc(100% + 1.5rem);
                border-radius: 0;
                border-left: none;
                border-right: none;
            }

            .tab-content-wrapper {
                padding: 1rem;
            }

            .global-actions {
                flex-direction: column;
                align-items: stretch;
            }

            .global-btn {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .main-content-wrapper {
                padding: 0.5rem;
            }

            .tabs-container {
                margin: 0 -0.5rem;
                width: calc(100% + 1rem);
            }

            .tab-content-wrapper {
                padding: 0.75rem;
            }
        }

        .tab-nav-buttons {
            display: flex;
            justify-content: flex-end;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
            width: 100%;
        }

        .btn-next-tab {
            background-color: var(--secondary-color);
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn-next-tab:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        /* ===== ESTILOS ORIGINALES MODIFICADOS ===== */

        .container {
            background-color: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        .container:first-child {
            margin-top: 0;
        }

        .container h2 {
            color: var(--primary-color);
            margin-top: 0;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.6rem;
            font-weight: 800;
        }

        .container p,
        .container ol,
        .container ul,
        .legend {
            line-height: 1.8;
        }

        .container ol,
        .container ul {
            padding-left: 1.25rem;
        }

        .formula-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            text-align: center;
            margin-top: 1.5rem;
        }

        .formula-item {
            padding: 1.5rem 1rem;
            border: 1px solid #eee;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 120px;
            font-size: 1.1em;
            width: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }

        .formula-item>div {
            width: 100%;
            overflow-x: auto;
            text-align: center;
            padding: 0.5rem 0;
        }

        .formula-item h3 {
            margin-top: 0;
            margin-bottom: 1rem;
            color: var(--primary-color);
            width: 100%;
            text-align: center;
        }

        .legend {
            margin-top: 2rem;
            padding: 1rem;
            border: 1px solid #eee;
            border-radius: 8px;
            background-color: #fdfdfd;
        }

        .legend h3 {
            margin-top: 0;
            color: var(--primary-color);
        }

        .legend ul {
            list-style: none;
            padding: 0;
        }

        .legend li {
            margin-bottom: 0.5rem;
        }

        .legend code {
            background-color: #eee;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        .calculator-section {
            margin-top: 0;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        .calculation-block {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.25rem;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            width: 100%;
            box-sizing: border-box;
            max-width: 100%;
        }

        @media (max-width: 768px) {

            .container,
            .calculation-block {
                border-radius: 0;
                margin-top: 1rem;
                box-shadow: none;
                border-left: none;
                border-right: none;
            }
        }

        .calculation-title {
            font-weight: 800;
            font-size: 1.2em;
            margin-bottom: 1rem;
            color: var(--primary-color);
            border-bottom: 1px solid #eee;
            padding-bottom: 0.6rem;
        }

        label {
            display: block;
            margin-bottom: 0.6rem;
            color: var(--primary-color);
            font-weight: 600;
        }

        input[type="text"],
        textarea,
        select {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            margin-bottom: 1rem;
            box-sizing: border-box;
            transition: border 0.3s, box-shadow 0.3s;
            font-family: 'Nunito', sans-serif;
            max-width: 100%;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        select {
            cursor: pointer;
            background-color: white;
        }

        select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        button {
            background-color: var(--secondary-color);
            color: white;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 1rem;
            transition: background-color 0.3s, box-shadow 0.3s;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
        }

        .button-yellow {
            background-color: #f39c12;
        }

        .button-yellow:hover {
            background-color: #e67e22;
        }

        .button-green {
            background-color: #27ae60;
        }

        .button-green:hover {
            background-color: #229954;
        }

        .reset-btn {
            background-color: #e74c3c;
        }

        .reset-btn:hover {
            background-color: #c0392b;
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-left: -5px;
            margin-top: 10px;
        }

        /* ESTILOS PARA MOSTRAR RESULTADOS DE DIFERENTES DATASETS */
        .results-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1.25rem;
            align-items: stretch;
            margin-top: 1.25rem;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        .dataset-results-wrapper {
            display: none;
            width: 100%;
            flex-wrap: wrap;
            gap: 1.25rem;
            max-width: 100%;
        }

        .dataset-results-wrapper.active {
            display: flex;
        }

        .charts-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 1.25rem;
            min-width: 300px;
            max-width: 100%;
            width: 100%;
            box-sizing: border-box;
        }

        .charts-wrapper>div {
            height: 480px;
            width: 100%;
            position: relative;
        }

        .chart-canvas {
            max-width: 100% !important;
            width: 100% !important;
            height: auto !important;
        }

        .cpk-chart-container,
        .overall-chart-container,
        .control-chart-container,
        .overall-control-chart-container,
        .qq-chart-container {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
            min-width: 300px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* MARCA DE AGUA EN CADA GRÁFICO - CORREGIDO */
        .chart-watermark {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 60px;
            height: auto;
            filter: invert(1);
            opacity: 0.15;
            pointer-events: none;
            z-index: 10;
        }

        .results-box {
            background: white;
            padding: 1.25rem;
            border-radius: 8px;
            border: 1px solid #ddd;
            width: 350px;
            min-width: 300px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
        }

        .results-content {
            flex-grow: 1;
        }

        .results-box p {
            margin: 0.5rem 0;
            color: var(--primary-color);
        }

        .result-value {
            font-weight: bold;
            color: var(--dark-color);
        }

        .normality-results {
            border-top: 1px solid #eee;
            margin-top: 1rem;
            padding-top: 0.5rem;
        }

        .normality-results p {
            font-size: 0.9em;
        }

        .pass {
            color: #27ae60;
            font-weight: bold;
        }

        .fail {
            color: #e74c3c;
            font-weight: bold;
        }

        .dataset-container {
            margin-bottom: 1rem;
            position: relative;
        }

        .dataset-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .dataset-title {
            font-weight: 600;
            color: var(--primary-color);
        }

        .remove-dataset-btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 0.3rem 0.6rem;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }

        .remove-dataset-btn:hover {
            background-color: #c0392b;
        }

        .datasets-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 1rem;
        }

        /* PESTAÑAS DE DATASETS Y OVERALL - MODIFICADO */
        .dataset-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 1rem;
            margin-top: 1rem;
            width: 100%;
        }

        .dataset-tab {
            padding: 0.5rem 1rem;
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            white-space: nowrap;
            color: #333;
        }

        .dataset-tab:hover {
            background-color: #e2e8f0;
        }

        .dataset-tab.active {
            background-color: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
        }

        /* BOTÓN OVERALL - GRIS POR DEFECTO, VERDE AL ACTIVAR */
        .dataset-tab.overall-tab {
            background-color: #f0f0f0;
            /* Gris por defecto */
            color: #333;
            border-color: #ddd;
        }

        .dataset-tab.overall-tab:hover {
            background-color: #e2e8f0;
        }

        .dataset-tab.overall-tab.active {
            background-color: #27ae60;
            /* Verde cuando está activo */
            color: white;
            border-color: #27ae60;
        }

        .dataset-tab.overall-tab.active:hover {
            background-color: #229954;
        }

        .anderson-formula {
            font-size: 1rem !important;
            overflow-x: auto;
            white-space: nowrap;
            padding: 1rem;
            padding-bottom: 0.5rem;
            max-width: 100%;
            box-sizing: border-box;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
        }

        .chart-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
            padding: 10px 0 0 0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.85rem;
        }

        .legend-color {
            width: 20px;
            height: 3px;
            margin-right: 5px;
        }

        .disclaimer-note {
            margin-top: 2rem;
            padding: 0 1rem;
            font-size: .8rem;
            color: #777;
            max-width: 100%;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        .overall-results-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1.25rem;
            align-items: stretch;
            margin-top: 1.25rem;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        /* CONTENEDOR PARA RESULTADOS OVERALL */
        #overall-results-wrapper {
            display: none;
            width: 100%;
            flex-wrap: wrap;
            gap: 1.25rem;
        }

        #overall-results-wrapper.active {
            display: flex;
        }

        /* Estilos para fórmulas KaTeX */
        .katex {
            font-size: 1.1em !important;
        }

        .katex-display {
            margin: 0.5em 0 !important;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 0.5em 0;
        }

        .formula-item .katex-display {
            margin: 0 !important;
        }

        /* Nuevos estilos para mejorar histogramas */
        .histogram-bar {
            border-radius: 2px;
        }

        .normal-curve-line {
            fill: none;
            stroke-width: 2;
        }

        /* Estilos para intervalos de confianza */
        .confidence-interval {
            font-size: 0.9em;
            color: #666;
            margin-top: 0.25rem;
            margin-left: 1.5rem;
        }

        .confidence-interval-label {
            font-weight: 600;
            color: #555;
        }

        .confidence-interval-value {
            font-weight: 600;
            color: #2c3e50;
        }

        /* Estilos para gráficas de normalidad */
        .qq-chart-container {
            height: 480px;
        }

        /* Subsecciones en resultados overall */
        .results-subsection {
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
        }

        .results-subsection-title {
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.75rem;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sigma-method-info {
            background-color: #f8f9fa;
            border-left: 4px solid var(--secondary-color);
            padding: 0.75rem 1rem;
            margin: 1rem 0;
            font-size: 0.9rem;
            border-radius: 0 4px 4px 0;
        }

        .sigma-method-info strong {
            color: var(--primary-color);
        }

        @media (max-width: 768px) {

            .results-container,
            .overall-results-container,
            .dataset-results-wrapper {
                flex-direction: column;
            }

            .results-box {
                width: 100%;
                min-width: unset;
            }

            .charts-wrapper>div {
                height: 400px;
            }

            .button-group {
                justify-content: center;
            }

            .formula-grid {
                grid-template-columns: 1fr;
                width: 100%;
                max-width: 100%;
                overflow-x: hidden;
            }

            .katex {
                font-size: 0.9rem !important;
            }

            .anderson-formula {
                font-size: 0.85rem !important;
            }

            .chart-legend {
                flex-direction: column;
                align-items: flex-start;
            }

            .formula-item {
                width: 100%;
                max-width: 100%;
                box-sizing: border-box;
                overflow-x: hidden;
            }

            .charts-wrapper {
                flex-direction: column;
            }

            .charts-wrapper>div {
                height: 400px;
            }

            .qq-chart-container {
                height: 400px;
            }
        }

        @media (max-width: 480px) {
            .button-group {
                flex-direction: column;
                align-items: stretch;
            }

            .button-group button {
                margin: 5px 0;
                width: 100%;
            }

            .charts-wrapper>div {
                height: 350px;
            }

            .container,
            .calculation-block {
                padding: 1rem;
            }

            .dataset-tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
            }

            .qq-chart-container {
                height: 350px;
            }
        }
    </style>
</head>

<body>

    <div id="header-container"></div>

    <noscript>
        <nav>
            <a href="/">Home</a> |
            <a href="/8d">8D Tool</a> |
            <a href="/taguchi_doe">Taguchi DOE</a> |
            <a href="/swot">SWOT Analysis</a> |
            <a href="/balancedcard">Balanced Scorecard</a> |
            <a href="/qfd">QFD</a> |
            <a href="/apqp-ppap">APQP/PPAP</a> |
            <a href="/ishikawa">Ishikawa</a> |
            <a href="/fmea">FMEA</a> |
            <a href="/vave">VAVE</a> |
            <a href="/eisenhower">Eisenhower Matrix</a> |
            <a href="/triz">TRIZ</a> |
            <a href="/weibull">Weibull</a> |
            <a href="/stack_up_analysis">Tolerance Stack-Up</a> |
            <a href="/pdca">PDCA</a> |
            <a href="/design_thinking">Design Thinking</a> |
            <a href="/pugh">Pugh Matrix</a> |
            <a href="/cpk_calculator">CpK Calculator</a> |
            <a href="/control-plan">Control Plan</a>
        </nav>
    </noscript>

    <main class="main-content-wrapper">
        <header class="main-header">
            <h1><span
                    style="display: inline-flex; justify-content: center; align-items: center; width: 42px; height: 42px; background-color: #5ac8fa; border-radius: 8px; margin-right: 12px; vertical-align: middle;"><i
                        class="fas fa-chart-line" style="color: white; font-size: 22px;"></i></span> Free Online
                Capability Index Calculator (Cp, Cpk, Cpm, Pp, Ppk)</h1>
            <p>Calculate short-term (Cp, Cpk, Cpm) and long-term (Pp, Ppk) capability indices. Includes normality tests,
                distribution plots, and I-Charts for robust analysis.</p>
        </header>

        <div class="global-actions">
            <button class="global-btn secondary" id="globalFillExampleBtn">
                <i class="fas fa-play-circle"></i> Load Example Data
            </button>
            <button class="global-btn danger" id="globalResetDataBtn">
                <i class="fas fa-sync-alt"></i> Reset All Data
            </button>
        </div>

        <div class="tabs-container">
            <nav class="tabs-nav">
                <button class="tab-btn active" data-tab="tab-theory"><i class="fas fa-book"></i>
                    Theory & Info</button>
                <button class="tab-btn" data-tab="tab-tool"><i class="fas fa-calculator"></i>
                    Calculator Tool</button>
                <button class="tab-btn" data-tab="tab-results"><i class="fas fa-chart-bar"></i>
                    Results</button>
                <button class="tab-btn" data-tab="tab-formulas"><i class="fas fa-square-root-alt"></i>
                    Formulas</button>
            </nav>

            <div id="tab-theory" class="wizard-tab-content active">
                <div class="tab-content-wrapper">
                    <div class="container">
                        <h2><i class="fas fa-question-circle"></i> What is Process Capability (Cp, Cpk)?</h2>
                        <p>Process Capability analysis is a fundamental tool in Statistical Process Control (SPC) used
                            to measure the ability of a process to produce output within specification limits (LSL and
                            USL). It helps determine if a process is <em>capable</em> of consistently meeting customer
                            requirements.</p>
                        <p>This analysis uses key indices:</p>
                        <ul>
                            <li><strong>Cp (Process Capability):</strong> Measures the <em>potential</em> capability of
                                the process. It compares the total specification width (USL - LSL) to the natural
                                process variation (6-sigma), but it <strong>does not account for centering</strong>. It
                                answers: "Is the process spread narrow enough?"</li>
                            <li><strong>Cpk (Process Capability Index):</strong> Measures the <em>actual</em> capability
                                of the process. It accounts for <strong>both spread and centering</strong> by comparing
                                the process mean to the nearest specification limit. It answers: "Is the process spread
                                narrow enough AND is it running near the target?"</li>
                        </ul>
                        <p>Generally, a Cpk value of 1.33 or higher is considered capable for many industries, though
                            this requirement can vary.</p>
                    </div>

                    <div class="container">
                        <h2><i class="fas fa-history"></i> Brief History of Statistical Process Control (SPC)</h2>
                        <p>The concept of process control is rooted in the work of <strong>Walter A. Shewhart</strong>
                            at Bell Labs in the 1920s. He developed control charts to distinguish between "common cause"
                            variation (the natural, inherent variability of a process) and "special cause" variation
                            (external, unpredictable events). This was the birth of Statistical Process Control (SPC).
                        </p>
                    </div>

                    <div class="container">
                        <h2><i class="fas fa-cogs"></i> How to Use This Tool</h2>
                        <ol>
                            <li><strong>Enter Process Data and Specifications:</strong> Add one or more datasets using
                                the "Add Dataset" button. Fill in measurements for each dataset, along with the common
                                Lower (LSL), Upper (USL), and Target values.</li>
                            <li><strong>Select Calculation Method:</strong> Choose the method for calculating σ within
                                (short-term standard deviation). For multiple datasets (subgroups), use <strong>R-bar
                                    (recommended)</strong> or <strong>S-bar</strong> to align with JASP and other
                                statistical software.</li>
                            <li><strong>Calculate Results:</strong> Press the <strong>Calculate</strong> button. The
                                tool will compute short-term indices (Cp, Cpk, Cpm) for each dataset, overall long-term
                                indices (Pp, Ppk) combining all datasets, perform normality tests, and display process
                                distribution plots and Individuals Control Charts.</li>
                            <li><strong>Review Results:</strong> Analyze both the individual dataset results and the
                                overall performance. Switch between datasets using the tabs to see detailed results for
                                each one.</li>
                            <li><strong>Add or Remove Datasets (Optional):</strong> Use the "Add Dataset" button to
                                include more data or the "Remove" button next to each dataset to delete it.</li>
                            <li><strong>Export Your Analysis:</strong> Click <strong>Export to Excel</strong> to
                                download a spreadsheet containing all individual calculations and the overall
                                performance summary.</li>
                        </ol>
                    </div>

                    <div class="tab-nav-buttons">
                        <button class="btn-next-tab" data-next="tab-tool">Go to Calculator <i
                                class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            </div>

            <div id="tab-tool" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <div class="calculator-section">
                        <div class="calculation-block">
                            <div class="calculation-title">Data Input</div>
                            <form id="cpkForm">
                                <div id="datasetsContainer">
                                    <div class="dataset-container" data-id="1">
                                        <div class="dataset-header">
                                            <span class="dataset-title">Measurements (Dataset #1)</span>
                                            <button type="button" class="remove-dataset-btn" style="display:none;"><i
                                                    class="fas fa-times"></i> Remove</button>
                                        </div>
                                        <textarea class="measurements-input" rows="1"
                                            placeholder="Enter values or click 'Load Example' above"
                                            required></textarea>
                                    </div>
                                </div>

                                <div class="datasets-controls">
                                    <button type="button" id="addDatasetBtn" class="button-yellow"><i
                                            class="fas fa-plus"></i> Add Dataset</button>
                                </div>

                                <label for="lsl"><i class="fas fa-arrow-down"></i> Lower Specification Limit
                                    (LSL):</label>
                                <input type="text" id="lsl" required />
                                <label for="usl"><i class="fas fa-arrow-up"></i> Upper Specification Limit
                                    (USL):</label>
                                <input type="text" id="usl" required />
                                <label for="target"><i class="fas fa-bullseye"></i> Target (T):</label>
                                <input type="text" id="target" required />

                                <div class="button-group" style="margin-top:0; margin-left:0;">
                                    <button type="submit"><i class="fas fa-calculator"></i> Calculate</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-results" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <!-- Pestañas para datasets y overall -->
                    <div id="datasetTabsContainer" class="dataset-tabs" style="display: none;"></div>

                    <!-- Contenedor para resultados del dataset activo -->
                    <div class="results-container">
                        <!-- Contenedor para resultados individuales de datasets -->
                        <div id="dataset-results-wrapper" class="dataset-results-wrapper">
                            <div class="results-box">
                                <div class="results-content">
                                    <div class="calculation-title">Short-Term Results</div>
                                    <p><i class="fas fa-chart-line"></i> Mean: <span id="mean"
                                            class="result-value">-</span>
                                    </p>
                                    <p><i class="fas fa-chart-bar"></i> Std Dev (short-term): <span id="deviation"
                                            class="result-value">-</span></p>
                                    <p><i class="fas fa-ruler-combined"></i> Cp: <span id="cp"
                                            class="result-value">-</span>
                                    <div class="confidence-interval" id="cp_ci">95% CI: -</div>
                                    </p>
                                    <p><i class="fas fa-tachometer-alt"></i> Cpk: <span id="cpk"
                                            class="result-value">-</span>
                                    <div class="confidence-interval" id="cpk_ci">95% CI: -</div>
                                    </p>
                                    <p><i class="fas fa-crosshairs"></i> Cpm: <span id="cpm"
                                            class="result-value">-</span>
                                    <div class="confidence-interval" id="cpm_ci">95% CI: -</div>
                                    </p>
                                    <p><i class="fas fa-exclamation-triangle"></i> Expected Failures: <span
                                            id="failures_ppm" class="result-value">-</span> ppm</p>
                                    <p><i class="fas fa-percentage"></i> Defective Parts: <span
                                            id="defective_percentage" class="result-value">-</span>%</p>

                                    <div class="normality-results">
                                        <div class="calculation-title"
                                            style="font-size: 1.1em; margin-top: 1rem; margin-bottom: 0.5rem;">Normality
                                            Tests</div>
                                        <p>Shapiro-Wilk: <span id="shapiro" class="result-value">-</span></p>
                                        <p>Kolmogorov-Smirnov: <span id="kolmogorov" class="result-value">-</span></p>
                                        <p>Anderson-Darling: <span id="anderson" class="result-value">-</span></p>
                                    </div>
                                </div>
                            </div>

                            <div class="charts-wrapper" id="short-term-charts-wrapper" style="display: none;">
                                <div id="cpkChart" class="cpk-chart-container">
                                    <img src="sigma-exacta-icon.jpg" alt="SigmaExacta Watermark"
                                        class="chart-watermark">
                                    <canvas id="cpkChartCanvas" class="chart-canvas"></canvas>
                                    <div class="chart-legend">
                                        <div class="legend-item">
                                            <div class="legend-color" style="background-color: #e74c3c;"></div> LSL/USL
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color"
                                                style="background-color: #333; border-top: 2px dashed #333;"></div> Mean
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color"
                                                style="background-color: #3498db; border-top: 2px solid #3498db;"></div>
                                            Process Limits (±3σ)
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color" style="background-color: #3498db;"></div>
                                            Histogram
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color" style="background-color: #2c3e50;"></div> Normal
                                            Curve
                                        </div>
                                    </div>
                                </div>
                                <div id="controlChartContainer" class="control-chart-container">
                                    <img src="sigma-exacta-icon.jpg" alt="SigmaExacta Watermark"
                                        class="chart-watermark">
                                    <canvas id="controlChartCanvas" class="chart-canvas"></canvas>
                                </div>
                                <div id="qqChartContainer" class="qq-chart-container" style="display: none;">
                                    <img src="sigma-exacta-icon.jpg" alt="SigmaExacta Watermark"
                                        class="chart-watermark">
                                    <canvas id="qqChartCanvas" class="chart-canvas"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Contenedor para resultados overall (long-term) - MODIFICADO -->
                        <div id="overall-results-wrapper" class="dataset-results-wrapper">
                            <div class="results-box">
                                <div class="results-content">
                                    <div class="calculation-title">Overall Performance</div>
                                    <p><i class="fas fa-database"></i> <b>Total Points:</b> <span id="overall_total"
                                            class="result-value">1</span></p>
                                    <p><i class="fas fa-chart-line"></i> <b>Overall Mean:</b> <span id="overall_mean"
                                            class="result-value">-</span></p>

                                    <!-- Solo Process Performance (Total - Long Term) -->
                                    <div class="results-subsection">
                                        <div class="results-subsection-title">
                                            <i class="fas fa-chart-line"></i> Process Performance (Total - Long Term)
                                        </div>
                                        <p><i class="fas fa-chart-bar"></i> <b>σ total (long-term):</b> <span
                                                id="overall_dev" class="result-value">-</span></p>
                                        <p><i class="fas fa-ruler-combined"></i> <b>Pp:</b> <span id="overall_pp"
                                                class="result-value">-</span>
                                        <div class="confidence-interval" id="overall_pp_ci">95% CI: -</div>
                                        </p>
                                        <p><i class="fas fa-tachometer-alt"></i> <b>Ppk:</b> <span id="overall_ppk"
                                                class="result-value">-</span>
                                        <div class="confidence-interval" id="overall_ppk_ci">95% CI: -</div>
                                        </p>
                                    </div>

                                    <div class="results-subsection">
                                        <p><i class="fas fa-exclamation-triangle"></i> <b>Expected Failures:</b> <span
                                                id="overall_failures" class="result-value">-</span> ppm</p>
                                        <p><i class="fas fa-percentage"></i> <b>Defective Parts:</b> <span
                                                id="overall_defective" class="result-value">-</span>%</p>
                                    </div>

                                    <div class="normality-results">
                                        <div class="calculation-title"
                                            style="font-size:1.1em;margin-top:1rem;margin-bottom:.5rem">Overall
                                            Normality</div>
                                        <p>Shapiro-Wilk: <span id="overall_shapiro" class="result_value">-</span></p>
                                        <p>Kolmogorov-Smirnov: <span id="overall_kolmogorov"
                                                class="result_value">-</span></p>
                                        <p>Anderson-Darling: <span id="overall_anderson" class="result_value">-</span>
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <div class="charts-wrapper" id="long-term-charts-wrapper" style="display: none;">
                                <div id="overallChartContainer" class="overall-chart-container">
                                    <img src="sigma-exacta-icon.jpg" alt="SigmaExacta Watermark"
                                        class="chart-watermark">
                                    <canvas id="overallChartCanvas" class="chart-canvas"></canvas>
                                    <div class="chart-legend">
                                        <div class="legend-item">
                                            <div class="legend-color" style="background-color: #e74c3c;"></div> LSL/USL
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color"
                                                style="background-color: #333; border-top: 2px dashed #333;"></div> Mean
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color"
                                                style="background-color: #3498db; border-top: 2px solid #3498db;"></div>
                                            Process Limits (±3σ)
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color" style="background-color: #3498db;"></div>
                                            Histogram
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color" style="background-color: #2c3e50;"></div> Normal
                                            Curve
                                        </div>
                                    </div>
                                </div>
                                <div id="overallControlChartContainer" class="overall-control-chart-container">
                                    <img src="sigma-exacta-icon.jpg" alt="SigmaExacta Watermark"
                                        class="chart-watermark">
                                    <canvas id="overallControlChartCanvas" class="chart-canvas"></canvas>
                                </div>
                                <div id="overallQQChartContainer" class="qq-chart-container" style="display: none;">
                                    <img src="sigma-exacta-icon.jpg" alt="SigmaExacta Watermark"
                                        class="chart-watermark">
                                    <canvas id="overallQQChartCanvas" class="chart-canvas"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Botón de exportar (común para todos los datasets) -->
                    <div class="button-group" style="margin-top: 20px; justify-content: flex-start;">
                        <button type="button" id="exportBtn" class="button-green" disabled><i
                                class="fas fa-file-excel"></i> Export to Excel</button>
                    </div>
                </div>
            </div>

            <div id="tab-formulas" class="wizard-tab-content">
                <div class="tab-content-wrapper">
                    <div class="container">
                        <h2><i class="fas fa-calculator"></i> Mathematical Formulas</h2>
                        <div class="formula-grid">
                            <div class="formula-item">
                                <h3>Sigma Within (R-bar method)</h3>
                                <div class="katex-content">$$ \sigma_{\text{within}} = \frac{\overline{R}}{d_2} $$
                                </div>
                                <p>Where $d_2$ depends on subgroup size $n$</p>
                            </div>
                            <div class="formula-item">
                                <h3>Sigma Within (Moving Range)</h3>
                                <div class="katex-content">$$ \sigma_{\text{within}} = \frac{\overline{MR}}{d_2} $$
                                </div>
                                <p>Where $d_2 = 1.128$ for $n=2$</p>
                            </div>
                            <div class="formula-item">
                                <h3>Cp (Capability)</h3>
                                <div class="katex-content">$$ C_p = \frac{USL - LSL}{6\sigma_{\text{within}}} $$</div>
                            </div>
                            <div class="formula-item">
                                <h3>Cpk (Centering)</h3>
                                <div class="katex-content">$$ C_{pk} = \min\left( \frac{USL -
                                    \mu}{3\sigma_{\text{within}}}, \frac{\mu - LSL}{3\sigma_{\text{within}}} \right)
                                    $$</div>
                            </div>
                            <div class="formula-item">
                                <h3>Cpm (Targeting)</h3>
                                <div class="katex-content">$$ C_{pm} = \frac{USL -
                                    LSL}{6\sqrt{\sigma_{\text{within}}^2 + (\mu - T)^2}} $$</div>
                            </div>
                            <div class="formula-item">
                                <h3>Pp (Performance)</h3>
                                <div class="katex-content">$$ P_p = \frac{USL - LSL}{6\sigma_{\text{total}}} $$</div>
                            </div>
                            <div class="formula-item">
                                <h3>Ppk (Centering)</h3>
                                <div class="katex-content">$$ P_{pk} = \min\left( \frac{USL -
                                    \mu}{3\sigma_{\text{total}}}, \frac{\mu - LSL}{3\sigma_{\text{total}}} \right)
                                    $$</div>
                            </div>
                            <div class="formula-item">
                                <h3>Confidence Interval for Cp (Chi-square)</h3>
                                <div class="katex-content">$$ CI_{Cp} = C_p \sqrt{\frac{\chi^2_{\alpha/2, n-1}}{n-1}},
                                    C_p \sqrt{\frac{\chi^2_{1-\alpha/2, n-1}}{n-1}} $$</div>
                            </div>
                            <div class="formula-item">
                                <h3>Confidence Interval for Cpk (Improved)</h3>
                                <div class="katex-content">$$ CI_{Cpk} = C_{pk} \pm Z_{\alpha/2} \sqrt{\frac{1}{9n} +
                                    \frac{C_{pk}^2}{2(n-1)}} $$</div>
                            </div>
                        </div>
                        <div class="legend">
                            <h3>Capability Legend</h3>
                            <ul>
                                <li><code>Cp, Cpk, Cpm</code>: Process Capability indices (short-term, within-subgroup
                                    variation)</li>
                                <li><code>Pp, Ppk</code>: Process Performance indices (long-term, total variation)</li>
                                <li><code>LSL, USL</code>: Lower and Upper Specification Limits</li>
                                <li><code>T</code>: Target value</li>
                                <li><code>μ</code>: Process mean</li>
                                <li><code>σ<sub>within</sub></code>: Short-term standard deviation (within-subgroup
                                    variation)</li>
                                <li><code>σ<sub>total</sub></code>: Long-term standard deviation (overall/total
                                    variation)</li>
                                <li><code>CI</code>: Confidence Interval (95% by default)</li>
                            </ul>
                            <h3>Automatic Method Selection (Aligned with JASP & Minitab)</h3>
                            <ul>
                                <li><strong>For individual datasets</strong>: Uses Moving Range (MR/d₂) with length 2
                                </li>
                                <li><strong>For multiple datasets (subgroups)</strong>: Automatically selects:<br>
                                    &nbsp;&nbsp;&nbsp;- R-bar (R̄/d₂) if all subgroups have equal size ≤ 10<br>
                                    &nbsp;&nbsp;&nbsp;- Pooled SD with c₄ correction otherwise</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="disclaimer-note">
            <p><strong>Disclaimer:</strong> The tools and information provided on Sigma Exacta are for informational and
                educational purposes only. This tool is based on established methodologies in Statistical Process
                Control (SPC) and Six Sigma. Normality tests like Shapiro-Wilk and Anderson-Darling are complex and the
                versions implemented here are approximations suitable for educational guidance; for critical
                applications, consult specialized statistical software. All calculations, quality control decisions, and
                process adjustments based on the output of this tool are the sole responsibility of the user. Sigma
                Exacta and its creators are not liable for any damages or losses resulting from the use of this website.
            </p>
        </div>
    </footer>

    <!-- Scripts al final del body para mejor rendimiento -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
        integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
        integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05"
        crossorigin="anonymous"></script>

    <script>
        // Variable para controlar si KaTeX ya se ha renderizado
        let katexRendered = false;

        // Función para cambiar entre pestañas del wizard
        function switchWizardTab(tabId) {
            // Quitar clase active de todos los botones y contenidos de wizard
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.wizard-tab-content').forEach(content => content.classList.remove('active'));

            // Activar el contenido seleccionado
            const activeTab = document.getElementById(tabId);
            activeTab.classList.add('active');

            // Activar botón correspondiente
            const activeBtn = document.querySelector(`.tab-btn[data-tab="${tabId}"]`);
            if (activeBtn) activeBtn.classList.add('active');

            // Scroll al top suavemente
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Renderizar KaTeX cuando se active la pestaña de fórmulas
            if (tabId === 'tab-formulas' && !katexRendered) {
                setTimeout(renderKaTeX, 100);
            }
        }

        // Función para renderizar KaTeX
        function renderKaTeX() {
            if (window.renderMathInElement && !katexRendered) {
                // Renderizar solo en el contenedor de fórmulas
                const mathElements = document.getElementById('tab-formulas');
                if (mathElements) {
                    renderMathInElement(mathElements, {
                        delimiters: [
                            { left: '$$', right: '$$', display: true },
                            { left: '$', right: '$', display: false },
                            { left: '\\(', right: '\\)', display: false },
                            { left: '\\[', right: '\\]', display: true }
                        ],
                        throwOnError: false,
                        strict: false
                    });
                    katexRendered = true;
                    console.log('KaTeX renderizado correctamente');
                }
            }
        }

        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', function () {
            // Configurar event listeners para las pestañas
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const tabId = this.getAttribute('data-tab');
                    switchWizardTab(tabId);
                });
            });

            // Configurar botones de navegación
            document.querySelectorAll('.btn-next-tab').forEach(btn => {
                btn.addEventListener('click', function () {
                    const nextTab = this.getAttribute('data-next');
                    switchWizardTab(nextTab);
                });
            });

            // Renderizar KaTeX inicialmente si la pestaña de fórmulas está activa
            if (document.getElementById('tab-formulas').classList.contains('active')) {
                setTimeout(renderKaTeX, 300);
            }

            // Configurar botones globales
            const globalFillBtn = document.getElementById('globalFillExampleBtn');
            const globalResetBtn = document.getElementById('globalResetDataBtn');
            const form = document.getElementById('cpkForm');

            // Crear botones ocultos para que el script original funcione
            const fillExampleBtn = document.createElement('button');
            fillExampleBtn.id = 'fillExampleBtn';
            fillExampleBtn.style.display = 'none';

            const resetDataBtn = document.createElement('button');
            resetDataBtn.id = 'resetDataBtn';
            resetDataBtn.style.display = 'none';

            // Añadir botones ocultos al body
            document.body.appendChild(fillExampleBtn);
            document.body.appendChild(resetDataBtn);

            if (globalFillBtn && fillExampleBtn) {
                globalFillBtn.addEventListener('click', function () {
                    // Cambiar a la pestaña de calculadora
                    switchWizardTab('tab-tool');

                    // Disparar el clic en el botón de ejemplo original
                    setTimeout(function () {
                        fillExampleBtn.click();

                        // Scroll a la sección de entrada de datos
                        setTimeout(function () {
                            const calculatorSection = document.querySelector('#tab-tool .calculator-section');
                            if (calculatorSection) {
                                calculatorSection.scrollIntoView({ behavior: 'smooth' });
                            }
                        }, 100);
                    }, 100);
                });
            }

            if (globalResetBtn && resetDataBtn) {
                globalResetBtn.addEventListener('click', function () {
                    // Disparar el clic en el botón de reset original
                    resetDataBtn.click();

                    // Cambiar a la pestaña de calculadora
                    switchWizardTab('tab-tool');
                });
            }

            // Modificar el formulario para que al calcular cambie a la pestaña de resultados
            if (form) {
                form.addEventListener('submit', function (e) {
                    // Esperar un momento para que el cálculo se complete
                    setTimeout(function () {
                        // Cambiar a la pestaña de resultados
                        switchWizardTab('tab-results');

                        // Scroll a la sección de resultados
                        setTimeout(function () {
                            const resultsTab = document.getElementById('tab-results');
                            if (resultsTab) {
                                resultsTab.scrollIntoView({ behavior: 'smooth' });
                            }
                        }, 100);
                    }, 300);
                });
            }

            // Asegurar que los gráficos tengan la marca de agua correctamente posicionada
            setTimeout(function () {
                document.querySelectorAll('.charts-wrapper > div').forEach(container => {
                    if (!container.querySelector('.chart-watermark')) {
                        const watermark = document.createElement('img');
                        watermark.src = 'sigma-exacta-icon.jpg';
                        watermark.alt = 'SigmaExacta Watermark';
                        watermark.className = 'chart-watermark';
                        container.appendChild(watermark);
                    }
                });
            }, 1000);
        });

        // También intentar renderizar KaTeX cuando la página esté completamente cargada
        window.addEventListener('load', function () {
            if (document.getElementById('tab-formulas').classList.contains('active') && !katexRendered) {
                setTimeout(renderKaTeX, 500);
            }
        });
    </script>

    <!-- Script de la calculadora CpK - EXTERNO -->
    <script src="cpk_calculator.js"></script>

    <script src="dexie.min.js"></script>
    <script src="db-sigma.js"></script>
    
</body>

</html>