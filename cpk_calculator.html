<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capability Index Calculator | Sigma Exacta</title>
    <meta name="description"
        content="Calculate Cp, Cpk, Pp & Ppk with our free Capability Index tool. This advanced calculator includes normality tests, distribution plots, and I-Charts for robust analysis.">
    <meta name="keywords"
        content="Open source, Free software, SigmaExacta, capability index calculator, cpk calculator, process capability, normality check, cp, cpk, cpm, pp, ppk, six sigma, spc tool, control chart, i-chart, lsl, usl, normal distribution plot, normality tests, Shapiro-Wilk, Anderson-Darling, Kolmogorov-Smirnov">

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- KaTeX for Math Formulas -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
        integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
        integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8"
        crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
        integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>

    <!-- Fonts and Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="sigma-exacta-icon.jpg" type="image/jpeg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">
    <link rel="canonical" href="httpsa://sigmaexacta.com/cpk_calculator">

    <style>
        /* Estilos de la Página de la Calculadora */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            font-size: 16px;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f4f7f9;
            color: #333;
            margin: 0;
            padding: 0;
        }

        .main-content-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.25rem;
        }

        .main-header {
            text-align: center;
            padding: 1rem 0;
            margin-bottom: 1.25rem;
            border-bottom: 1px solid #ddd;
        }

        .main-header h1 {
            color: var(--primary-color);
            font-size: clamp(1.5rem, 4vw, 1.8rem);
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 800;
        }

        .main-header p {
            color: #7f8c8d;
            font-weight: 400;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
        }

        /* ===== ESTILOS DEL SISTEMA DE PESTAÑAS (WIZARD) ===== */
        .tabs-nav {
            display: flex;
            background-color: #f1f5f9;
            border-radius: 8px 8px 0 0;
            overflow-x: auto;
            border-bottom: 2px solid var(--secondary-color);
            margin-bottom: 0;
            margin-top: 1.5rem;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .tabs-nav::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 1rem 1.5rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 700;
            color: #64748b;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
        }

        @media (min-width: 992px) {
            .tabs-nav {
                overflow-x: hidden;
            }

            .tab-btn {
                flex: 1;
                justify-content: center;
                padding: 1rem 0.5rem;
            }
        }

        .tab-btn:hover {
            background-color: #e2e8f0;
            color: var(--primary-color);
        }

        .tab-btn.active {
            background-color: #fff;
            color: var(--secondary-color);
            border-bottom-color: var(--secondary-color);
            border-radius: 8px 8px 0 0;
            margin-bottom: -2px;
            border-left: 1px solid #e1e5e9;
            border-right: 1px solid #e1e5e9;
            border-top: 1px solid #e1e5e9;
        }

        .wizard-tab-content {
            display: none;
            padding: 2rem;
            background: #fff;
            border: 1px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 8px 8px;
            animation: fadeIn 0.3s ease;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .wizard-tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tab-nav-buttons {
            display: flex;
            justify-content: flex-end;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
        }

        .btn-next-tab {
            background-color: var(--secondary-color);
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn-next-tab:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        /* Ajustes para contenedores dentro de pestañas */
        .wizard-tab-content .container {
            margin-top: 1.5rem;
            box-shadow: none;
            border: 1px solid #eee;
            padding: 1.5rem;
        }

        .wizard-tab-content .container:first-child {
            margin-top: 0;
        }

        /* ===== ESTILOS ORIGINALES ===== */

        .container {
            background-color: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .container h2 {
            color: var(--primary-color);
            margin-top: 0;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.6rem;
            font-weight: 800;
        }

        .container p,
        .container ol,
        .container ul,
        .legend {
            line-height: 1.8;
        }

        .container ol,
        .container ul {
            padding-left: 1.25rem;
        }

        .formula-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            text-align: center;
            margin-top: 1.5rem;
        }

        .formula-item {
            padding: 1.5rem 1rem;
            border: 1px solid #eee;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 120px;
            font-size: 1.1em;
        }

        .formula-item h3 {
            margin-top: 0;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .legend {
            margin-top: 2rem;
            padding: 1rem;
            border: 1px solid #eee;
            border-radius: 8px;
            background-color: #fdfdfd;
        }

        .legend h3 {
            margin-top: 0;
            color: var(--primary-color);
        }

        .legend ul {
            list-style: none;
            padding: 0;
        }

        .legend li {
            margin-bottom: 0.5rem;
        }

        .legend code {
            background-color: #eee;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        .calculator-section {
            margin-top: 0;
            /* Ajustado para tabs */
        }

        .calculation-block {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.25rem;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .calculation-title {
            font-weight: 800;
            font-size: 1.2em;
            margin-bottom: 1rem;
            color: var(--primary-color);
            border-bottom: 1px solid #eee;
            padding-bottom: 0.6rem;
        }

        label {
            display: block;
            margin-bottom: 0.6rem;
            color: var(--primary-color);
            font-weight: 600;
        }

        input[type="text"],
        textarea {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            margin-bottom: 1rem;
            box-sizing: border-box;
            transition: border 0.3s, box-shadow 0.3s;
            font-family: 'Nunito', sans-serif;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        button {
            background-color: var(--secondary-color);
            color: white;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 1rem;
            transition: background-color 0.3s, box-shadow 0.3s;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
        }

        .button-yellow {
            background-color: #f39c12;
        }

        .button-green {
            background-color: #27ae60;
        }

        .reset-btn {
            background-color: #e74c3c;
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-left: -5px;
            margin-top: 10px;
        }

        .results-container,
        .overall-results-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1.25rem;
            align-items: stretch;
            margin-top: 1.25rem;
        }

        .charts-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 1.25rem;
            min-width: 300px;
        }

        .charts-wrapper>div {
            height: 480px;
        }

        #cpkChartCanvas,
        #overallChartCanvas,
        #controlChartCanvas,
        #overallControlChartCanvas {
            max-width: 100%;
            max-height: calc(100% - 30px);
        }

        #cpkChart,
        #overallChartContainer,
        #controlChartContainer,
        #overallControlChartContainer {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
            min-width: 300px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .chart-watermark {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 60px;
            height: auto;
            filter: invert(1);
            opacity: 0.6;
            pointer-events: none;
        }

        #results,
        #overallResults {
            background: white;
            padding: 1.25rem;
            border-radius: 8px;
            border: 1px solid #ddd;
            width: 350px;
            min-width: 300px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
        }

        .results-content {
            flex-grow: 1;
        }

        #results p,
        #overallResults p {
            margin: 0.5rem 0;
            color: var(--primary-color);
        }

        .result-value {
            font-weight: bold;
            color: var(--dark-color);
        }

        .normality-results {
            border-top: 1px solid #eee;
            margin-top: 1rem;
            padding-top: 0.5rem;
        }

        .normality-results p {
            font-size: 0.9em;
        }

        .pass {
            color: #27ae60;
            font-weight: bold;
        }

        .fail {
            color: #e74c3c;
            font-weight: bold;
        }

        .dataset-container {
            margin-bottom: 1rem;
            position: relative;
        }

        .dataset-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .dataset-title {
            font-weight: 600;
            color: var(--primary-color);
        }

        .remove-dataset-btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 0.3rem 0.6rem;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .datasets-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 1rem;
        }

        .dataset-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 1rem;
        }

        .dataset-tab {
            padding: 0.5rem 1rem;
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }

        .dataset-tab.active {
            background-color: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
        }

        .anderson-formula {
            font-size: 1rem !important;
            overflow-x: auto;
            white-space: nowrap;
            padding: 1rem;
            padding-bottom: 0.5rem;
            max-width: 100%;
            box-sizing: border-box;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
        }

        .chart-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
            padding: 10px 0 0 0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.85rem;
        }

        .legend-color {
            width: 20px;
            height: 3px;
            margin-right: 5px;
        }

        .disclaimer-note {
            margin-top: 2rem;
            padding: 0 1rem;
            font-size: .8rem;
            color: #777;
            max-width: 100%;
            margin-left: auto;
            margin-right: auto;
        }

        @media (max-width: 768px) {

            .results-container,
            .overall-results-container {
                flex-direction: column;
            }

            #results,
            #overallResults {
                width: 100%;
                min-width: unset;
            }

            .charts-wrapper>div {
                height: 400px;
            }

            .button-group {
                justify-content: center;
            }

            .formula-grid {
                grid-template-columns: 1fr;
            }

            .katex {
                font-size: 0.9rem !important;
            }

            .anderson-formula {
                font-size: 0.85rem !important;
            }

            .chart-legend {
                flex-direction: column;
                align-items: flex-start;
            }

            .wizard-tab-content {
                padding: 1rem;
            }
        }
    </style>

</head>

<body>

    <div id="header-container"></div>
    <div id="header-container"></div>

    <noscript>
        <nav>
            <a href="/">Home</a> |
            <a href="/8d">8D Tool</a> |
            <a href="/taguchi_doe">Taguchi DOE</a> |
            <a href="/swot">SWOT Analysis</a> |
            <a href="/balancedcard">Balanced Scorecard</a> |
            <a href="/qfd">QFD</a> |
            <a href="/apqp-ppap">APQP/PPAP</a> |
            <a href="/ishikawa">Ishikawa</a> |
            <a href="/fmea">FMEA</a> |
            <a href="/vave">VAVE</a> |
            <a href="/eisenhower">Eisenhower Matrix</a> |
            <a href="/triz">TRIZ</a> |
            <a href="/weibull">Weibull</a> |
            <a href="/stack_up_analysis">Tolerance Stack-Up</a> |
            <a href="/pdca">PDCA</a> |
            <a href="/design_thinking">Design Thinking</a> |
            <a href="/pugh">Pugh Matrix</a> |
            <a href="/cpk_calculator">CpK Calculator</a> |
            <a href="/control-plan">Control Plan</a>
        </nav>
    </noscript>

    <main class="main-content-wrapper">
        <header class="main-header">
            <h1><span
                    style="display: inline-flex; justify-content: center; align-items: center; width: 42px; height: 42px; background-color: #5ac8fa; border-radius: 8px; margin-right: 12px; vertical-align: middle;"><i
                        class="fas fa-chart-line" style="color: white; font-size: 22px;"></i></span> Free Online
                Capability Index Calculator (Cp, Cpk, Cpm, Pp, Ppk)</h1>
            <p>Calculate short-term (Cp, Cpk, Cpm) and long-term (Pp, Ppk) capability indices. Includes normality tests,
                distribution plots, and I-Charts for robust analysis.</p>
        </header>

        <!-- NAVEGACIÓN DE PESTAÑAS (WIZARD) -->
        <nav class="tabs-nav">
            <button class="tab-btn active" onclick="switchWizardTab('tab-theory')"><i class="fas fa-book"></i> Theory &
                Info</button>
            <button class="tab-btn" onclick="switchWizardTab('tab-tool')"><i class="fas fa-calculator"></i> Calculator
                Tool</button>
            <button class="tab-btn" onclick="switchWizardTab('tab-formulas')"><i class="fas fa-square-root-alt"></i>
                Formulas</button>
        </nav>

        <!-- PESTAÑA 1: TEORÍA -->
        <div id="tab-theory" class="wizard-tab-content active">
            <div class="container">
                <h2><i class="fas fa-question-circle"></i> What is Process Capability (Cp, Cpk)?</h2>
                <p>Process Capability analysis is a fundamental tool in Statistical Process Control (SPC) used to
                    measure
                    the ability of a process to produce output within specification limits (LSL and USL). It helps
                    determine
                    if a process is <em>capable</em> of consistently meeting customer requirements.</p>
                <p>This analysis uses key indices:</p>
                <ul>
                    <li><strong>Cp (Process Capability):</strong> Measures the <em>potential</em> capability of the
                        process.
                        It compares the total specification width (USL - LSL) to the natural process variation
                        (6-sigma),
                        but it <strong>does not account for centering</strong>. It answers: "Is the process spread
                        narrow
                        enough?"</li>
                    <li><strong>Cpk (Process Capability Index):</strong> Measures the <em>actual</em> capability of the
                        process. It accounts for <strong>both spread and centering</strong> by comparing the process
                        mean to
                        the nearest specification limit. It answers: "Is the process spread narrow enough AND is it
                        running
                        near the target?"</li>
                </ul>
                <p>Generally, a Cpk value of 1.33 or higher is considered capable for many industries, though this
                    requirement can vary.</p>
            </div>

            <div class="container">
                <h2><i class="fas fa-history"></i> Brief History of Statistical Process Control (SPC)</h2>
                <p>The concept of process control is rooted in the work of <strong>Walter A. Shewhart</strong> at Bell
                    Labs
                    in the 1920s. He developed control charts to distinguish between "common cause" variation (the
                    natural,
                    inherent variability of a process) and "special cause" variation (external, unpredictable events).
                    This
                    was the birth of Statistical Process Control (SPC).</p>
            </div>

            <div class="container">
                <h2><i class="fas fa-cogs"></i> How to Use This Tool</h2>
                <ol>
                    <li><strong>Enter Process Data and Specifications:</strong> Add one or more datasets using the "Add
                        Dataset" button. Fill in measurements for each dataset, along with the common Lower (LSL), Upper
                        (USL), and Target values.</li>
                    <li><strong>Calculate Results:</strong> Press the <strong>Calculate</strong> button. The tool will
                        compute short-term indices (Cp, Cpk, Cpm) for each dataset, overall long-term indices (Pp, Ppk)
                        combining all datasets, perform normality tests, and display process distribution plots and
                        Individuals Control Charts.</li>
                    <li><strong>Review Results:</strong> Analyze both the individual dataset results and the overall
                        performance. Switch between datasets using the tabs to see detailed results for each one.</li>
                    <li><strong>Add or Remove Datasets (Optional):</strong> Use the "Add Dataset" button to include more
                        data or the "Remove" button next to each dataset to delete it.</li>
                    <li><strong>Export Your Analysis:</strong> Click <strong>Export to Excel</strong> to download a
                        spreadsheet containing all individual calculations and the overall performance summary.</li>
                </ol>
            </div>

            <div class="tab-nav-buttons">
                <button class="btn-next-tab" onclick="switchWizardTab('tab-tool')">Go to Calculator <i
                        class="fas fa-arrow-right"></i></button>
            </div>
        </div>

        <!-- PESTAÑA 2: HERRAMIENTA CALCULADORA -->
        <div id="tab-tool" class="wizard-tab-content">
            <div class="calculator-section">
                <div class="calculation-block">
                    <div class="calculation-title">Data Input</div>
                    <form id="cpkForm">
                        <div id="datasetsContainer">
                            <div class="dataset-container" data-id="1">
                                <div class="dataset-header">
                                    <span class="dataset-title">Measurements (Dataset #1)</span>
                                    <button type="button" class="remove-dataset-btn" style="display:none;"><i
                                            class="fas fa-times"></i> Remove</button>
                                </div>
                                <textarea class="measurements-input" rows="1"
                                    placeholder="Enter values or click 'Fill Example'" required></textarea>
                            </div>
                        </div>

                        <div class="datasets-controls">
                            <button type="button" id="addDatasetBtn" class="button-yellow"><i class="fas fa-plus"></i>
                                Add
                                Dataset</button>
                        </div>

                        <label for="lsl"><i class="fas fa-arrow-down"></i> Lower Specification Limit (LSL):</label>
                        <input type="text" id="lsl" required />
                        <label for="usl"><i class="fas fa-arrow-up"></i> Upper Specification Limit (USL):</label>
                        <input type="text" id="usl" required />
                        <label for="target"><i class="fas fa-bullseye"></i> Target (T):</label>
                        <input type="text" id="target" required />

                        <div class="button-group" style="margin-top:0; margin-left:0;">
                            <button type="submit"><i class="fas fa-calculator"></i> Calculate</button>
                            <button type="button" id="fillExampleBtn" class="button-yellow"><i
                                    class="fas fa-lightbulb"></i>
                                Fill Example</button>
                            <button type="button" id="resetDataBtn" class="reset-btn"><i class="fas fa-undo"></i> Reset
                                Data</button>
                        </div>
                    </form>
                </div>

                <div id="datasetTabsContainer" class="dataset-tabs" style="display: none;"></div>

                <div class="results-container">
                    <div id="results" style="display:none;">
                        <div class="results-content">
                            <div class="calculation-title">Short-Term Results</div>
                            <p><i class="fas fa-chart-line"></i> Mean: <span id="mean" class="result-value">-</span></p>
                            <p><i class="fas fa-chart-bar"></i> Std Dev (Within): <span id="deviation"
                                    class="result-value">-</span></p>
                            <p><i class="fas fa-ruler-combined"></i> Cp: <span id="cp" class="result-value">-</span></p>
                            <p><i class="fas fa-tachometer-alt"></i> Cpk: <span id="cpk" class="result-value">-</span>
                            </p>
                            <p><i class="fas fa-crosshairs"></i> Cpm: <span id="cpm" class="result-value">-</span></p>
                            <p><i class="fas fa-exclamation-triangle"></i> Expected Failures: <span id="failures_ppm"
                                    class="result-value">-</span> ppm</p>
                            <p><i class="fas fa-percentage"></i> Defective Parts: <span id="defective_percentage"
                                    class="result-value">-</span>%</p>

                            <div class="normality-results">
                                <div class="calculation-title"
                                    style="font-size: 1.1em; margin-top: 1rem; margin-bottom: 0.5rem;">Normality Tests
                                </div>
                                <p>Shapiro-Wilk: <span id="shapiro" class="result-value">-</span></p>
                                <p>Kolmogorov-Smirnov: <span id="kolmogorov" class="result-value">-</span></p>
                                <p>Anderson-Darling: <span id="anderson" class="result-value">-</span></p>
                            </div>
                        </div>
                    </div>

                    <div class="charts-wrapper" id="short-term-charts-wrapper" style="display: none;">
                        <div id="cpkChart">
                            <img src="sigma-exacta-icon.jpg" alt="SigmaExacta Watermark" class="chart-watermark">
                            <canvas id="cpkChartCanvas"></canvas>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #e74c3c;"></div> LSL/USL
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color"
                                        style="background-color: #333; border-top: 2px dashed #333;">
                                    </div> Mean
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color"
                                        style="background-color: #3498db; border-top: 2px solid #3498db;"></div> Process
                                    Limits (±3σ)
                                </div>
                            </div>
                        </div>
                        <div id="controlChartContainer">
                            <img src="sigma-exacta-icon.jpg" alt="SigmaExacta Watermark" class="chart-watermark">
                            <canvas id="controlChartCanvas"></canvas>
                        </div>
                    </div>
                </div>

                <div class="calculation-block">
                    <div class="calculation-title">Overall Performance (Long-Term Analysis)</div>

                    <div class="overall-results-container">
                        <div id="overallResults" style="display:none;">
                            <div class="results-content">
                                <div class="calculation-title">Overall Performance (Pp, Ppk)</div>
                                <p><i class="fas fa-database"></i> <b>Total Points:</b> <span id="overall_total"
                                        class="result-value">-</span></p>
                                <p><i class="fas fa-chart-line"></i> <b>Overall Mean:</b> <span id="overall_mean"
                                        class="result-value">-</span></p>
                                <p><i class="fas fa-chart-bar"></i> <b>Overall Std Dev:</b> <span id="overall_dev"
                                        class="result-value">-</span></p>
                                <p><i class="fas fa-ruler-combined"></i> <b>Pp:</b> <span id="overall_pp"
                                        class="result-value">-</span></p>
                                <p><i class="fas fa-tachometer-alt"></i> <b>Ppk:</b> <span id="overall_ppk"
                                        class="result-value">-</span></p>
                                <p><i class="fas fa-exclamation-triangle"></i> <b>Expected Failures:</b> <span
                                        id="overall_failures" class="result-value">-</span> ppm</p>
                                <p><i class="fas fa-percentage"></i> <b>Defective Parts:</b> <span
                                        id="overall_defective" class="result-value">-</span>%</p>
                                <div class="normality-results">
                                    <div class="calculation-title"
                                        style="font-size:1.1em;margin-top:1rem;margin-bottom:.5rem">Overall Normality
                                    </div>
                                    <p>Shapiro-Wilk: <span id="overall_shapiro" class="result-value">-</span></p>
                                    <p>Kolmogorov-Smirnov: <span id="overall_kolmogorov" class="result-value">-</span>
                                    </p>
                                    <p>Anderson-Darling: <span id="overall_anderson" class="result-value">-</span></p>
                                </div>
                            </div>
                        </div>

                        <div class="charts-wrapper" id="long-term-charts-wrapper" style="display: none;">
                            <div id="overallChartContainer">
                                <img src="sigma-exacta-icon.jpg" alt="SigmaExacta Watermark" class="chart-watermark">
                                <canvas id="overallChartCanvas"></canvas>
                                <div class="chart-legend">
                                    <div class="legend-item">
                                        <div class="legend-color" style="background-color: #e74c3c;"></div> LSL/USL
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color"
                                            style="background-color: #333; border-top: 2px dashed #333;"></div> Mean
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color"
                                            style="background-color: #3498db; border-top: 2px solid #3498db;"></div>
                                        Process
                                        Limits (±3σ)
                                    </div>
                                </div>
                            </div>
                            <div id="overallControlChartContainer">
                                <img src="sigma-exacta-icon.jpg" alt="SigmaExacta Watermark" class="chart-watermark">
                                <canvas id="overallControlChartCanvas"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="button-group" style="margin-top: 20px; justify-content: flex-start;">
                        <button type="button" id="exportBtn" class="button-green" disabled><i
                                class="fas fa-file-excel"></i>
                            Export to Excel</button>
                    </div>
                </div>
            </div>

            <div class="tab-nav-buttons">
                <button class="btn-next-tab" onclick="switchWizardTab('tab-formulas')">View Formulas <i
                        class="fas fa-arrow-right"></i></button>
            </div>
        </div>

        <!-- PESTAÑA 3: FÓRMULAS -->
        <div id="tab-formulas" class="wizard-tab-content">
            <div class="container">
                <h2><i class="fas fa-calculator"></i> Mathematical Formulas</h2>
                <div class="formula-grid">
                    <div class="formula-item">
                        <h3>Sigma Within (Short-Term)</h3>
                        <div style="font-size: 1rem;">$$ \sigma_{\text{within}} = \frac{\overline{MR}}{d_2} $$</div>
                        <p>Where $d_2 = 1.128$ for $n=2$</p>
                    </div>
                    <div class="formula-item">
                        <h3>Cp (Capability)</h3>
                        <div style="font-size: 1rem;">$$ C_p = \frac{USL - LSL}{6\sigma_{\text{within}}} $$</div>
                    </div>
                    <div class="formula-item">
                        <h3>Cpk (Centering)</h3>
                        <div style="font-size: 1rem;">$$ C_{pk} = \min\left( \frac{USL - \mu}{3\sigma_{\text{within}}},
                            \frac{\mu - LSL}{3\sigma_{\text{within}}} \right) $$</div>
                    </div>
                    <div class="formula-item">
                        <h3>Cpm (Targeting)</h3>
                        <div style="font-size: 1rem;">$$ C_{pm} = \frac{USL - LSL}{6\sqrt{\sigma_{\text{within}}^2 +
                            (\mu - T)^2}} $$</div>
                    </div>
                    <div class="formula-item">
                        <h3>Pp (Performance)</h3>
                        <div style="font-size: 1rem;">$$ P_p = \frac{USL - LSL}{6\sigma_{\text{overall}}} $$</div>
                    </div>
                    <div class="formula-item">
                        <h3>Ppk (Centering)</h3>
                        <div style="font-size: 1.1rem;">$$ P_{pk} = \min\left( \frac{USL -
                            \mu}{3\sigma_{\text{overall}}}, \frac{\mu - LSL}{3\sigma_{\text{overall}}} \right) $$</div>
                    </div>
                </div>
                <div class="legend">
                    <h3>Capability Legend</h3>
                    <ul>
                        <li><code>Cp, Pp</code>: Process Capability/Performance - measures potential capability if
                            process is centered</li>
                        <li><code>Cpk, Ppk</code>: Process Capability/Performance Index - accounts for process centering
                        </li>
                        <li><code>Cpm</code>: Process Capability Index considering target value</li>
                        <li><code>LSL, USL</code>: Lower and Upper Specification Limits</li>
                        <li><code>T</code>: Target value</li>
                        <li><code>μ</code>: Process mean</li>
                        <li><code>σ<sub>within</sub></code>: Short-term standard deviation (within-subgroup variation)
                        </li>
                        <li><code>σ<sub>overall</sub></code>: Long-term standard deviation (overall variation)</li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="disclaimer-note">
            <p><strong>Disclaimer:</strong> The tools and information provided on Sigma Exacta are for informational and
                educational purposes only. This tool is based on established methodologies in Statistical Process
                Control (SPC) and Six Sigma. Normality tests like Shapiro-Wilk and Anderson-Darling are complex and the
                versions implemented here are approximations suitable for educational guidance; for critical
                applications, consult specialized statistical software. All calculations, quality control decisions, and
                process adjustments based on the output of this tool are the sole responsibility of the user. Sigma
                Exacta and its creators are not liable for any damages or losses resulting from the use of this website.
            </p>
        </div>
    </footer>

    <!-- Script para funcionalidad de Tabs Wizard -->
    <script>
        function switchWizardTab(tabId) {
            // Quitar clase active de todos los botones y contenidos de wizard
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.wizard-tab-content').forEach(content => content.classList.remove('active'));

            // Activar el contenido seleccionado
            document.getElementById(tabId).classList.add('active');

            // Activar botón correspondiente
            const activeBtn = document.querySelector(`button[onclick="switchWizardTab('${tabId}')"]`);
            if (activeBtn) activeBtn.classList.add('active');

            // Scroll al top suavemente
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>

    <!-- Main Calculation and Logic Script -->
    <script src="cpk_calculator.js"></script>

</body>

</html>